                PROGRAM RAM
C***********************************************************************RAM00005
C                                                                       RAM00006
C                            RAM (DATED 89213)                          RAM00010
C                                                                       RAM00060
C               *** SEE RAM MODEL CHANGE BULLETIN MCB#2 ***             RAM00061
C                                                                       RAM00080
C     ON THE SUPPORT CENTER FOR REGULATORY AIR MODELS BULLETIN BOARD    RAM00090
C                                                                       RAM00091
C                             919-541-5742                              RAM00092
C                                                                       RAM00093
C***********************************************************************RAM00094
C->->->-> OUTLINE OF PROGRAM SECTIONS                                   RAM00100
C                                                                       RAM00110
C        SECTION A - GENERAL REMARKS                                    RAM00120
C        SECTION B - DATA INPUT LISTS.                                  RAM00130
C        SECTION C - INPUT FILE DESCRIPTIONS                            RAM00140
C        SECTION D - OUTPUT PUNCHED CARD DESCRIPTION                    RAM00150
C        SECTION E - OUTPUT FILE DESCRIPTIONS                           RAM00160
C        SECTION F - TEMPORARY FILE DESCRIPTION                         RAM00170
C        SECTION G - COMMON, DIMENSION, AND DATA STATEMENTS  .          RAM00180
C        SECTION H - FLOW DIAGRAM.                                      RAM00190
C        SECTION I - RUN SET-UP AND READ FIRST 6 INPUT CARDS.           RAM00200
C        SECTION J - INPUT AND PROCESS EMISSION INFORMATION.            RAM00210
C        SECTION K - EXECUTE FOR INPUT OF SIGNIFICANT SOURCE NUMBERS.   RAM00220
C        SECTION L - CHECK MET. DATA IF FROM FILE OF ONE YEARS'S DATA.  RAM00230
C        SECTION M - GENERATE POLAR COORDINATE RECEPTORS.               RAM00240
C        SECTION N - READ AND PROCESS RECEPTOR INFORMATION.             RAM00250
C        SECTION O - POSITION FILES AS REQUIRED.                        RAM00260
C        SECTION P - START LOOPS FOR DAY AND AVERAGING TIME; READ       RAM00270
C                       MET. DATA.                                      RAM00280
C        SECTION Q - CALCULATE AND WRITE MET. SUMMARY INFORMATION.      RAM00290
C        SECTION R - DETERMINE ADDITIONAL RECEPTORS FOR THIS AVG-PER    RAM00300
C                     (OPTIONAL)                                        RAM00310
C        SECTION S - INITIALIZE FOR HOURLY LOOP.                        RAM00320
C        SECTION T - BEGIN HOURLY LOOP.                                 RAM00330
C        SECTION U - CALCULATE AND STORE FOR HIGH-FIVE TABLE.           RAM00340
C        SECTION V - END HOURLY, AVERAGING TIME, AND DAILY LOOPS.       RAM00350
C        SECTION W - WRITE AVERAGE CONC. AND HIGH-FIVE TABLES.          RAM00360
C        SECTION X - CLOSE OUT FILES.                                   RAM00370
C        SECTION Y - FORMAT STATEMENTS.                                 RAM00380
C                                                                       RAM00390
C->->->-> SECTION A -  GENERAL REMARKS.                                 RAM00400
C                                                                       RAM00410
C***********************************************************************RAM00420
C       NOTE: THE CARD INPUT FOR RAM (85364) DIFFERS FROM               RAM00430
C              PREVIOUS VERSIONS.                                       RAM00440
C             THIS VERSION OF  RAM IS COMPILED WITH THE IBM             IBM00450
C             FORTRAN COMPILER. THIS VERSION OF THE MODEL               IBM00460
C             DIFFERS SLIGHTLY FROM EARLIER VERSIONS IN THE AREAS       RAM00470
C             OF FORMAT STATEMENTS AND CONDITION STATEMENTS.            RAM00480
C***********************************************************************RAM00490
C                                                                       RAM00500
C        RAM  PROGRAM ABSTRACT.                                         RAM00510
C   RAM IS AN EFFICIENT GAUSSIAN-PLUME MULTIPLE-SOURCE                  RAM00520
C   AIR QUALITY ALGORITHM. RAM IS DESCRIBED IN: NOVAK,J.H., AND         RAM00530
C   TURNER,D.B., 1976: AIR POLLUTION CONTROL ASSOC. J., VOL. 26, NO. 6, RAM00540
C   PAGES 570-575(JUNE 1976). RAM'S PRINCIPAL USE IS TO DETERMINE       RAM00550
C   SHORT TERM (ONE-HOUR TO ONE-DAY) CONCENTRATIONS FROM POINT AND      RAM00560
C   AREA SOURCES IN URBAN AREAS.                                        RAM00570
C                                                                       RAM00580
C             EXECUTION OF  RAM  IS LIMITED TO A MAXIMUM OF 250 POINT   RAM00590
C        SOURCES,100 AREA SOURCES ,AND 180 RECEPTORS.  SIMULATION       RAM00600
C        IS DONE HOUR-BY-HOUR AND HOURLY METEOROLOGICAL DATA            RAM00610
C        ARE REQUIRED AS INPUT.  LENGTH OF SIMULATED TIME CAN           RAM00620
C        VARY FROM 1 HOUR TO 1 YEAR.                                    RAM00630
C                                                                       RAM00640
C       RAM  AUTHORS:                                                   RAM00650
C        D. BRUCE TURNER* AND JOAN HRENKO NOVAK*                        RAM00660
C        METEOROLOGY AND ASSESSMENT DISISION, ESRL                      RAM00670
C        ENVIRONMENTAL PROTECTION AGENCY                                RAM00680
C                                                                       RAM00690
C        * ON ASSIGNMENT FROM NATIONAL OCEANIC AND ATMOSPHERIC ADMIN.,  RAM00700
C          DEPARTMENT OF COMMERCE.                                      RAM00710
C                                                                       RAM00720
C***   MODIFIED FOR DEFAULT OPTION BY:                                  RAM00730
C        JEROME B. MERSCH                                               RAM00740
C        SOURCE RECEPTOR ANALYSIS BRANCH                                RAM00750
C        MONITORING AND DATA ANALYSIS DIVISION                          RAM00760
C        ENVIRONMENTAL PROTECTION AGENCY                                RAM00770
C                                                                       RAM00780
C       RAM  SUPPORTED BY:                                              RAM00800
C        ENVIRONMENTAL OPERATIONS BRANCH                                RAM00810
C        MAIL DROP 80, EPA                                              RAM00820
C        RESRCH TRI PK, NC 27711                                        RAM00830
C                                                                       RAM00840
C        PHONE: (919) 541-4564,  FTS 629-4564.                          RAM00850
C                                                                       RAM00860
C       BACKGROUND--                                                    RAM00870
C        1. THE ORIGINAL RAM BY JOAN HRENKO NOVAK AND D.BRUCE TURNER    RAM00880
C           WAS MADE AVAILABLE IN FOUR VERSIONS:                        RAM00890
C               RAM   SHORT TERM URBAN                                  RAM00900
C               RAMR  SHORT TERM RURAL                                  RAM00910
C               RAMF  LONG TERM  URBAN                                  RAM00920
C               RAMFR LONG TERM RURAL                                   RAM00930
C           ON UNAMAP(VERSION 3) IN MARCH 1978.                         RAM00940
C                                                                       RAM00950
C        2. USING THE POINT SOURCE PORTIONS OF RAMR AS A BASIS,         RAM00960
C             THOMAS E. PIERCE AND D.BRUCE TURNER DEVELOPED THE MODEL   RAM00970
C             MPTER.THIS MODEL CONTAINS MANY OPTIONS SO THAT IT IS      RAM00980
C             QUITE VERSATILE PRIMARILY DUE TO ITS MANY USER SELECTED   RAM00990
C             OPTIONS.                                                  RAM01000
C                                                                       RAM01010
C        3. IN BEGINNING THE TASK OF REVISING RAM FOR GUIDELINE         RAM01020
C            MODEL CONSISTENCY, IT WAS FELT THAT ADDITIONAL OPTIONS     RAM01030
C            COULD BE EMPLOYED, SIMILAR TO MPTER, IN ORDER TO MAKE      RAM01040
C            THE MODEL MORE VERSATILE. THE APPROACH USED HERE WAS       RAM01050
C            TO BEGIN WITH MPTER, REMOVE ITS OPTIONAL TERRAIN           RAM01060
C            FEATURES AND ADD BACK IN THE AREA SOURCE COMPUTATIONS      RAM01070
C            AND RECEPTOR LOCATION FEATURES.                            RAM01080
C                                                                       RAM01090
C      CURRENT MODEL - USERS WILL FIND THAT THERE ARE NO LONGER FOUR    RAM01100
C        VERSIONS OF RAM BUT ONLY ONE. USE OF URBAN OR RURAL            RAM01110
C        DISPERSION PARAMETERS ARE CONTROLLED BY THE INPUT              RAM01120
C        VALUE FOR THE VARIABLE MUOR ( "1" FOR URBAN,"2" FOR            RAM01130
C        RURAL). THE LENGTH OF THE MODEL RUN IS DETERMINED BY           RAM01140
C        THE NUMBER OF AVERAGING PERIODS, NPER, TO BE RUN AND           RAM01150
C        THE LENGTH OF THE AVERAGING PERIOD,NAVG. FOR LONG-             RAM01160
C        TERM RUNS (SUCH AS USING A YEAR'S DATA), THE OPTION TO         RAM01170
C        CALCULATE AND PRINT THE HI-FIVE TABLE IS NORMALLY EMPLOYED     RAM01180
C        SO THAT THE HIGHEST AND SECOND HIGHEST CONCENTRATION FOR       RAM01190
C        EACH AVERAGING-TIME CAN BE EASILY DETERMINED.                  RAM01200
C                                                                       RAM01210
C        THIS VERSION OF RAM WAS ASSEMBLED BY CURTIS A. SMITH           RAM01220
C        (JUN -AUG 1980)AND ALFREIDA D. RANKINS (AUG 1980 -PRESENT)     RAM01230
C        UNDER THE GUIDANCE OF D. BRUCE TURNER.                         RAM01240
C                                                                       RAM01250
C      NOTE TO USERS:                                                   RAM01260
C        ALTHOUGH THE ORIGINAL VERSION OF RAM CONTAINED                 RAM01270
C        SUBROUTINES TO LOCATE RECEPTORS DOWNWIND FROM SIGNIFICANT      RAM01280
C        SOURCES FOR EACH AVERAGING PERIOD, THIS OPTION WAS DELETED     RAM01290
C        FROM THE LONG-TERM VERSION (THE VERY SITUATION WHERE IT        RAM01300
C        WOULD HAVE BEEN MOST USEFUL). THIS ACTION WAS TAKEN            RAM01310
C        BECAUSE IT WAS FELT IT WOULD CREATE CONFUSION FOR THE          RAM01320
C        USER TO GENERATE RECEPTORS WITH GIVEN RECEPTOR NUMBERS         RAM01330
C        WHOSE LOCATIONS SHIFT WITH EACH NEW AVERAGING PERIOD.          RAM01340
C                                                                       RAM01350
C        DETERMINATION OF MAXIMUM CONCENTRATIONS FROM                   RAM01360
C        MULTIPLE SOURCES IS A DIFFICUT AND TIME CONSUMING TASK.        RAM01370
C        WITH THIS VERSION OF RAM THE FOLLOWING PROCEDURES CAN BE       RAM01380
C        APPLIED TO ASSIST LOCATING MAXIMUM CONCENTRATIONS THAT         RAM01390
C        CAN BE COMPARED WITH AIR QUALITY STANDARDS:                    RAM01400
C                                                                       RAM01410
C        1.    EXECUTE FOR A LONG PERIOD OF RECORD (FOR EXAMPLE,A YEAR) RAM01420
C              FOR EXISTING MONITOR LOCATIONS AND EMPLOYING THE OPTION  RAM01430
C              TO GENERATE RECEPTORS DOWNWIND OF SIGNIFICANT SOURCES    RAM01440
C              (DIFFERENT RECEPTOR LOCATIONS ARE GENERATED FOR EACH     RAM01450
C              AVERAGING PERIOD). YOU MAY WANT TO ADD SPECIFIED OR      RAM01460
C              GENERATED RECEPTORS TO GET REASONABLE AREA COVERAGE.     RAM01470
C              (MOST OUTPUT WOULD BE SUPPRESSED BY USE OF OPTIONS       RAM01480
C              TO AVOID EXCESS PRINTED OUTPUT.) THE HI-FIVE TABLE       RAM01490
C              WOULD BE NEEDED HOWEVER.                                 RAM01500
C                                                                       RAM01510
C        2.    USING THE HI -FIVE TABLE SELECT DATES AND TIMES          RAM01520
C             (AND NOTE RECEPTOR NUMBERS) PRODUCING HIGH                RAM01530
C             VALUES ( HIGHEST, SECOND HIGHEST, AND POSSIBLY ,          RAM01540
C             THIRD HIGHEST).                                           RAM01550
C                                                                       RAM01560
C        3.    MAKE SHORT-TERM RUNS FOR THE ABOVE IDENTIFIED PERIODS    RAM01570
C             USING THE SAME RECEPTORS, RECEPTOR OPTIONS AND AVERAGING  RAM01580
C             PERIOD AS IN THE INITIAL RUN. BE SURE TO GET PRINTOUT     RAM01590
C             FOR THE AVERAGING PERIOD. THIS ALLOWS DETERMINATION OF THERAM01600
C             COORDINATES OF EACH RECEPTOR IDENTIFIED IN STEP 2 ABOVE.  RAM01610
C                                                                       RAM01620
C        4.   MAKE A LONG TERM RUN USING INPUT RECEPTORS ONLY (SO GIVEN RAM01630
C             SOURCE NUMBER WILL BE AT SAME LOCATION THROUGHOUT RUN).   RAM01640
C             ALL RECEPTORS IDENTIFIED AS PRODUCING HIGH CONCENTRATIONS RAM01650
C             IN STEPS 2 AND 3 SHOULD BE USED.  THIS RUN IS PROBABLY    RAM01660
C             FOR A ONE-YEAR PERIOD AND THE ONLY OUTPUT NEEDED IS THE   RAM01670
C             HIGH-FIVE TABLE FOR DETERMINATION OF ANNUAL CONCENTRATIONSRAM01680
C             AND HIGHEST AND SECOND HIGHEST CONCENTRATIONS FOR EACH    RAM01690
C             AVERAGING TIME.(THESE WILL BE AVAILABLE FOR EACH RECEPTOR)RAM01700
C                                                                       RAM01710
C        ALTHOUGH THIS METHOD WILL STILL BE RELATIVELY EXPENSIVE        RAM01720
C        (ESPECIALLY IF MANY RECEPTORS ARE USED), IT PROVIDES A         RAM01730
C         SYSTEMATIC METHODOLOGY FOR LOOKING FOR MAXIMUM CONCENTRATIONS.RAM01740
C                                                                       RAM01750
C                                                                       RAM01760
C      *************************************************************    RAM01770
C      *                                                           *    RAM01780
C      *               DEFAULT OPTION DESCRIPTION                  *    RAM01790
C      *                                                           *    RAM01800
C      *       SELECTION OF THE DEFAULT OPTION CAUSES THE          *    RAM01810
C      *   FOLLOWING FEATURES TO BE SET:                           *    RAM01820
C      *                                                           *    RAM01830
C      *            - FINAL PLUME RISE IS USED; GRADUAL            *    RAM01840
C      *              (TRANSITIONAL) RISE IS NOT PERMITTED.        *    RAM01850
C      *            - MOMENTUM PLUME RISE IS ALWAYS ACCOUNTED      *    RAM01860
C      *              FOR.                                         *    RAM01870
C      *            - BUOYANCY INDUCED DISPERSION IS USED          *    RAM01880
C      *            - THE POWER LAW WIND PROFILE EXPONENTS         *    RAM01890
C      *              HAVE BEEN PRESET TO .15, .15, .20, .25       *    RAM01900
C      *              .30 AND .30 FOR THE URBAN OPTION FOR         *    RAM01910
C      *              STABILITY A THROUGH F RESPECTIVELY;          *    RAM01920
C      *              MUOR HAS BEEN PRESET TO 1 , URBAN            *    RAM01930
C      *              OPTION.                                      *    RAM01940
C      *            - STACK TIP DOWNWASH WILL ALWAYS BE            *    RAM01950
C      *              CALCULATED WHEN APPROPRIATE. BRIGGS          *    RAM01960
C      *              STACK TIP DOWNWASH IS USED.                  *    RAM01970
C      *            - EXPONENTIAL DECAY (HALF-LIFE) IS             *    RAM01980
C      *              SET TO 4 HOURS FOR URBAN SO2 APPLICATIONS,   *    RAM01990
C      *              OTHER SITUATIONS USE NO DECAY. THIS IS       *    RAM02000
C      *              CONSISTENT WITH REGULATORY GUIDANCE.         *    RAM02010
C      *            - CONCENTRATIONS FOR CALM HOURS ARE SET TO 0.  *    RAM02020
C      *            - FOR MULTI-HOUR AVERAGING PERIODS THE         *    RAM02030
C      *              THE CONCENTRATIONS RESULTING FROM THE        *    RAM02040
C      *              CONSIDERATION OF CALM WIND CONDITIONS        *    RAM02050
C      *              ARE TREATED AS DESCRIBED IN SECTION U        *    RAM02060
C      *              OF THIS PROGRAM.                             *    RAM02070
C      *            - IN ORDER TO FACILITATE THE HANDLING OF       *    RAM02080
C      *              CALM WIND CONDITIONS, THE START HOUR         *    RAM02090
C      *              AND THE AVERAGING PERIOD HAVE BEEN           *    RAM02100
C      *              PRESET. THIS WILL AVOID CONFLICT             *    RAM02110
C      *              WITH THE CALMS PROCESSING PROCEDURE.         *    RAM02120
C      *            - IF ONSITE OR OTHER THAN RAMMET METE-         *    RAM02130
C      *              OROLOGICAL DATA ARE TO BE USED IT MUST       *    RAM02140
C      *              CORRESPOND TO THE FORMAT OF THE RAMMET       *    RAM02150
C      *              FILE AND BE READ INTO THE PROGRAM ON         *    RAM02160
C      *              DEVICE (11).                                 *    RAM02170
C      *            - OUTPUT OPTIONS 23 THROUGH 35 ARE SET TO 1    *    RAM02180
C      *              AND OPTIONS 7,8,11,12,15,16 AND 39           *    RAM02190
C      *              THROUGH 43 ARE SET TO 0.                     *    RAM02200
C      *                                                           *    RAM02210
C      *************************************************************    RAM02220
C                                                                       RAM02230
C                                                                       RAM02240
C   THREE SYSTEMS OF LENGTH AND COORDINATES ARE USED IN RAM:            RAM02250
C                                                                       RAM02260
C    THE FIRST SYSTEM, USER UNITS, IS SELECTED BY THE USER AND          RAM02270
C     NORMALLY USE THE COORDINATE SYSTEM OF THE EMISSION INVENTORY.     RAM02280
C     ALL LOCATIONS INPUT BY THE USER( SUCH AS SOURCES AND RECEPTORS)   RAM02290
C     ARE IN THIS SYSTEM. ALSO AS A CONVENIENCE TO THE USER ALL         RAM02300
C     LOCATIONS ON OUTPUT ARE ALSO IN THIS SYSTEM.                      RAM02310
C                                                                       RAM02320
C    THE SECOND SYSTEM, INTERNAL UNITS, IS USED INTERNALLY IN RAM       RAM02330
C     FOR COORDINATE LOCATIONS AND DISTANCES. ONE INTERNAL UNIT IS THE  RAM02340
C     SIDE LENGTH OF THE SMALLEST AREA SOURCE SQUARE. THIS LENGTH MUST  RAM02350
C     BE IDENTIFIED AND SPECIFIED BY THE USER. THE PURPOSE OF USING     RAM02360
C     INTERNAL UNITS IS TO HAVE A CORRESPONDENCE BETWEEN LOCATION(GRID  RAM02370
C     COORDINATES) AND PARTICULAR AREA SOURCE POSITIONS. THIS IS        RAM02380
C     ACCOMPLISHED THROUGH THE USE OF THE AREA SOURCE MAP ARRAY (IA     RAM02390
C     ARRAY). THIS ALLOWS DETERMINATION AS TO WITHIN WHICH AREA SOURCE  RAM02400
C     ANY COORDINATE POINT RESIDES.                                     RAM02410
C                                                                       RAM02420
C    THE THIRD SYSTEM, X, Y, IS AN UPWIND, CROSSWIND COORDINATE SYSTEM  RAM02430
C     WITH REFERENCE TO EACH RECEPTOR. THE X-AXIS IS DIRECTED UPWIND    RAM02440
C     (SAME AS WIND DIRECTION FOR THE PERIOD). IN ORDER TO DETERMINE    RAM02450
C     DISPERSION PARAMETER VALUES AND EVALUATE EQUATIONS FOR            RAM02460
C     CONCENTRATIONS, DISTANCES IN THIS SYSTEM MUST BE IN KILOMETERS.   RAM02470
C                                                                       RAM02480
C->->->-> SECTION B -  DATA INPUT LISTS.                                RAM02490
C                                                                       RAM02500
C      CARD VARIABLES AND FORMAT.                                       RAM02510
C             THE REQUIRED AND OPTIONAL CARD TYPES USED AS INPUT TO     RAM02520
C         RAM  ARE DESCRIBED BELOW:                                     RAM02530
C                                                                       RAM02540
C      CARDS 1 - 3  ALPHANUMERIC DATA FOR TITLES. FORMAT(20A4)          RAM02550
C                                                                       RAM02560
C             (THESE THREE CARDS ARE REQUIRED)                          RAM02570
C        LINE1 - 80 ALPHANUMERIC CHARACTERS.                            RAM02580
C        LINE2 - 80 ALPHANUMERIC CHARACTERS.                            RAM02590
C        LINE3 - 80 ALPHANUMERIC CHARACTERS.                            RAM02600
C                                                                       RAM02610
C      CARD 4  CONTROL AND CONSTANTS.  FORMAT(FREE)                     RAM02620
C                                                                       RAM02630
C           (THIS CARD IS REQUIRED)                                     RAM02640
C        IDATE(1) -  2-DIGIT YEAR FOR THIS RUN.                         RAM02650
C        IDATE(2) -  STARTING JULIAN DAY FOR THIS RUN.                  RAM02660
C        IHSTRT   -  STARTING HOUR FOR THIS RUN.                        RAM02670
C        NPER     -  NUMBER OF AVERAGING PERIODS TO BE RUN.             RAM02680
C        NAVG     -  NUMBER OF HOURS IN AN AVERAGING PERIOD.            RAM02690
C        IPOL     -  POLLUTANT INDICATOR; IS 3 FOR SO2, 4 FOR SUSPENDED RAM02700
C                     PARTICULATE.                                      RAM02710
C        MUOR     -  MODEL INDICATOR;  IS 1 FOR URBAN, 2 FOR RURAL.     RAM02720
C        NSIGP    -  NUMBER OF POINT SOURCES FROM WHICH CONC. CONTRIB.  RAM02730
C                     ARE DESIRED (MAX = 25).                           RAM02740
C        NSIGA    -  NUMBER OF AREA SOURCES FROM WHICH CONC. CONTRIB.   RAM02750
C                     ARE DESIRED (MAX=10).                             RAM02760
C        NAV5     -  ADDITIONAL AVERAGING TIME FOR HIGH-FIVE TABLE;     RAM02770
C                     MOST LIKELY EQUAL TO 2, 4, 6, OR 12.              RAM02780
C        CONONE   -  MULTIPLIER TO CONVERT USER UNITS TO KILOMETERS.    RAM02790
C                       EXAMPLE MULTIPLIERS:                            RAM02800
C                         FEET TO KM    3.048E-04                       RAM02810
C                         MILES TO KM   1.609344                        RAM02820
C                         METERS TO KM  1.0E-03                         RAM02830
C        UNITS    -  NUMBER OF USER UNITS PER SMALLEST AREA SOURCE SIDE RAM02840
C                     LENGTH. (IF NOT USING AREA SOURCES, UNITS         RAM02850
C                           SHOULD EQUAL 1.)                            RAM02860
C        Z        -  RECEPTOR HEIGHT (METERS)                           RAM02870
C        HAFL     -  POLLUTANT HALF-LIFE, SECONDS. AN ENTRY OF ZERO WILLRAM02880
C                     CAUSE SKIPPING OF POLLUTANT LOSS CALCULATIONS.    RAM02890
C                                                                       RAM02900
C        ******************************************************         RAM02910
C        *    RAM  IS CAPABLE OF GENERATING A                 *         RAM02920
C        *  LARGE QUANTITY OF PRINTED INFORMATION UNLESS SOME *         RAM02930
C        *  OF THESE OPTIONS TO DELETE OUTPUT ARE USED        *         RAM02940
C        *  LIBERALLY.                                        *         RAM02950
C        ******************************************************         RAM02960
C                                                                       RAM02970
C                                                                       RAM02980
C      CARD 5.  OPTIONS.  FORMAT(50I1)                                  RAM02990
C                                                                       RAM03000
C            (THIS CARD IS REQUIRED)                                    RAM03010
C        1 = EMPLOY OPTION (OR YES);  0 = DON'T USE OPTION (OR NO).     RAM03020
C                                                                       RAM03030
C       TECHNICAL OPTIONS:                                              RAM03040
C        IOPT(1)  -  NO STACK DOWNWASH.                                 RAM03050
C        IOPT(2)  -  NO GRADUAL PLUME RISE.                             RAM03060
C        IOPT(3)  -  USE BUOYANCY INDUCED DISPERSION.                   RAM03070
C        IOPT(4)  -  NOT USED THIS VERSION.                             RAM03080
C                                                                       RAM03090
C       INPUT OPTIONS:                                                  RAM03100
C        IOPT(5)  -  WILL YOU INPUT POINT SOURCES?                      RAM03110
C        IOPT(6)  -  WILL YOU INPUT AREA SOURCES?                       RAM03120
C        IOPT(7)  -  WILL YOU USE EMISSIONS FROM PREVIOUS RUN? (UNIT 9) RAM03130
C        IOPT(8)  -  MET. DATA ON CARDS? (FROM UNIT 11 OTHERWISE)       RAM03140
C        IOPT(9)  -  READ HOURLY PT. SOURCE EMISSIONS. (UNIT 15)        RAM03150
C        IOPT(10) -  READ HOURLY AREA SOURCE EMISSIONS. (UNIT 16)       RAM03160
C        IOPT(11) -  SPECIFY SIGNIF. PT. SOURCES.                       RAM03170
C        IOPT(12) -  SPECIFY SIGNIF. AREA SOURCES.                      RAM03180
C        IOPT(13) -  NOT USED THIS VERSION.                             RAM03190
C                                                                       RAM03200
C       RECEPTOR OPTIONS                                                RAM03210
C        IOPT(14) -  WILL YOU ENTER RECEPTORS BY SPECIFYING COORDINATES?RAM03220
C        IOPT(15) -  DO YOU WANT RAM TO GENERATE RECEPTORS DOWNWIND OF  RAM03230
C                     SIGNIF. PT. SOURCES? (WILL DO SO BY AVG-PERIOD)   RAM03240
C        IOPT(16) -  DO YOU WANT RAM TO GENERATE RECEPTORS DOWNWIND OF  RAM03250
C                      SIGNIF. AREA SOURCES? (WILL DO SO BY AVG-PERIOD) RAM03260
C        IOPT(17) -  DO YOU WANT RAM TO GENERATE A HONEYCOMB ARRAY OF   RAM03270
C                     RECEPTORS TO COVER A SPECIFIC AREA?               RAM03280
C        IOPT(18) -  WILL YOU INPUT RADIAL DISTANCES (UP TO 5) TO       RAM03290
C                     GENERATE A POLAR COORDINATE RECEPTOR ARRAY        RAM03300
C                     (36 RECEPTORS FOR EACH DISTANCE)                  RAM03310
C        IOPT(19) -  NOT USED THIS VERSION                              RAM03320
C                                                                       RAM03330
C       PRINTED OUTPUT OPTIONS                                          RAM03340
C        IOPT(20) -  DELETE POINT SOURCE LIST                           RAM03350
C        IOPT(21) -  DELETE AREA SOURCE LIST AND MAP                    RAM03360
C        IOPT(22) -  DELETE EMISSIONS WITH HEIGHT TABLE                 RAM03370
C        IOPT(23) -  DELETE RESULTANT MET. DATA SUMMARY FOR             RAM03380
C                     AVERAGING PERIOD.                                 RAM03390
C        IOPT(24) -  DELETE ALL HOURLY OUTPUT (PT., AREA, & SUMMARIES)  RAM03400
C        IOPT(25) -  DELETE HOURLY POINT CONTRIBUTIONS                  RAM03410
C        IOPT(26) -  DELETE MET. DATA ON HR. PT. CONTRIB.               RAM03420
C        IOPT(27) -  DELETE PLUME HT. AND DIST. TO FINAL RISE ON        RAM03430
C                     HR. PT. CONTRIB.                                  RAM03440
C        IOPT(28) -  DELETE HOURLY AREA CONTRIBUTIONS                   RAM03450
C        IOPT(29) -  DELETE MET. DATA ON HR. AREA CONTRIB.              RAM03460
C        IOPT(30) -  DELETE HOURLY SUMMARY.                             RAM03470
C        IOPT(31) -  DELETE MET. DATA ON HOURLY SUMMARY.                RAM03480
C        IOPT(32) -  DELETE ALL AVG-PERIOD OUTPUT                       RAM03490
C        IOPT(33) -  DELETE POINT AVG-PERIOD CONTRIBUTIONS.             RAM03500
C        IOPT(34) -  DELETE AREA AVG-PERIOD CONTRIBUTIONS.              RAM03510
C        IOPT(35) -  DELETE AVG-PERIOD SUMMARY.                         RAM03520
C        IOPT(36) -  DELETE AVERAGE CONCENTRATIONS & HI-FIVE TABLE.     RAM03530
C        IOPT(37) -  NOT USED THIS VERSION.                             RAM03540
C                                                                       RAM03550
C       DEFAULT OPTION                                                  RAM03560
C        IOPT(38) - SET DEFAULT OPTION                                  RAM03570
C                                                                       RAM03580
C       OTHER CONTROL AND OUTPUT OPTIONS:                               RAM03590
C        IOPT(39) -  RUN IS PART OF A SEGMENTED RUN.                    RAM03600
C * * * * * SEE CAUTION BELOW * * * * *                                 RAM03610
C        IOPT(40) -  WRITE PARTIAL CONC. TO DISK OR TAPE.(UNIT 10)      RAM03620
C * * * * * SEE NOTE BELOW * * * * *                                    RAM03630
C        IOPT(41) -  WRITE HOURLY CONC. TO DISK OR TAPE.(UNIT 12)       RAM03640
C * * * * * SEE NOTE BELOW * * * * *                                    RAM03650
C        IOPT(42) -  WRITE AVG-PERIOD CONC. TO DISK OR TAPE.(UNIT 13)   RAM03660
C        IOPT(43) -  PUNCH AVG-PERIOD CONCENTRATIONS ON CARDS.(UNIT 1)  RAM03670
C        IOPT(44) -  NOT USED THIS VERSION.                             RAM03680
C        IOPT(45) -  NOT USED THIS VERSION.                             RAM03690
C        IOPT(46) -  NOT USED THIS VERSION.                             RAM03700
C        IOPT(47) -  NOT USED THIS VERSION.                             RAM03710
C        IOPT(48) -  NOT USED THIS VERSION.                             RAM03720
C        IOPT(49) -  NOT USED THIS VERSION.                             RAM03730
C        IOPT(50) -  NOT USED THIS VERSION.                             RAM03740
C                                                                       RAM03750
C* * * * * CAUTION ON USING OPTION 40. * * * * *                        RAM03760
C                                                                       RAM03770
C           A TREMENDOUS FILE OF MANY RECORDS CAN                       RAM03780
C           CAN BE GENERATED BY EMPLOYING OPTION 40.                    RAM03790
C           THE USER WILL NEED TO WRITE THE SOFTWARE                    RAM03800
C           TO PROCESS THIS FILE ALSO. BE SURE YOU                      RAM03810
C           PLAN AHEAD BEFORE USING THIS OPTION.                        RAM03820
C           ALTHOUGH THE AUTHORS FEEL IT IS  UNLIKELY                   RAM03830
C           TO EMPLOY OPTIONS 39 AND 40 ON THE SAME RUN,                RAM03840
C           IT IS POSSIBLE TO DO SO. HOWEVER, NOTE THAT                 RAM03850
C           THE SECOND AND SUBSEQUENT SEGMENTS WILL NOT                 RAM03860
C           SKIP OVER PREVIOUSLY GENERATED PARTIAL CONC.                RAM03870
C           FILES. THEREFORE UNLESS THE EXECUTIVE CONTROL               RAM03880
C           LANGAGE HAS BEEN CHANGED SO THAT UNIT 10                    RAM03890
C           ACCESSES A DIFFERENT FILE ON EACH SEGMENT,                  RAM03900
C           ANY PREVIOUSLY GENERATED PARTIAL CONCENTRATION              RAM03910
C           FILES WILL BE DESTROYED BY WRITING OVER THESE               RAM03920
C           FILES.                                                      RAM03930
C                                                                       RAM03940
C                                                                       RAM03950
C* * ** * NOTE ON OUTPUT FILES* * * * *                                 RAM03960
C                                                                       RAM03970
C           THE AUTHORS FEEL THAT THE OUTPUT FILES                      RAM03980
C           GENERATED BY OPTIONS 41 AND 42 ARE USEFUL                   RAM03990
C           ONLY WHEN THE RECEPTORS ARE SET FOR THE RUN                 RAM04000
C           AND NOT VARYING FROM ONE AVG-PER TO ANOTHER.                RAM04010
C           THEREFORE THESE OPTIONS CAN BE USED WITH OPTIONS            RAM04020
C           14 AND 18, BUT A PROGRAM TERMINATION WILL                   RAM04030
C           OCCUR IF TRYING TO USE OPTIONS 41 OR 42 IN                  RAM04040
C           COMBINATION WITH ANY OF OPTIONS 15, 16, OR 17.              RAM04050
C                                                                       RAM04060
C                                                                       RAM04070
C      CARD 6.  WIND.  FORMAT(FREE)                                     RAM04080
C            (THIS CARD IS REQUIRED)                                    RAM04090
C                                                                       RAM04100
C        HANE     -  ANEMOMETER HEIGHT (METERS)                         RAM04110
C        PL(I),I=1,6 -  WIND SPEED POWER LAW PROFILE EXPONENTS FOR EACH RAM04120
C                        STABILITY.                                     RAM04130
C                                                                       RAM04140
C       *****DEFAULT OPTION NOTE*****                                   RAM04150
C                                                                       RAM04160
C             SELECTION OF THE DEFAULT OPTION CAUSES PL                 RAM04170
C         TO BE SET TO THE VALUES DESCRIBED ABOVE UNDER                 RAM04180
C         DEFAULT OPTION DESCRIPTION. UNDER THIS OPTION,                RAM04190
C         CARD 6 IS STILL REQUIRED  TO INPUT HANE.                      RAM04200
C         ALL OTHER DATA ON THE CARD WILL BE IGNORED.                   RAM04210
C                                                                       RAM04220
C                                                                       RAM04230
C      CARD TYPE 7.  POINT SOURCE CARD.  FORMAT(3A4,8F8.2)              RAM04240
C                                                                       RAM04250
C           (USED IF OPTION 5 = 1 AND OPTION 7 = 0)                     RAM04260
C       (UP TO 250 POINT SOURCE CARDS ARE ALLOWED.)                     RAM04270
C                                                                       RAM04280
C        PNAME(I,NPT)I=1,3 -  12 CHARACTER POINT SOURCE IDENTIFICATION. RAM04290
C        SOURCE(1,NPT)  -  EAST COORDINATE OF POINT SOURCE (USER UNITS) RAM04300
C        SOURCE(2,NPT)  -  NORTH COORDINATE OF POINT SOURCE (USER UNITS)RAM04310
C        SOURCE(3,NPT)  -  SULFUR DIOXIDE EMISSION RATE (G/SEC).        RAM04320
C        SOURCE(4,NPT)  -  PARTICULATE EMISSION RATE (G/SEC).           RAM04330
C        SOURCE(5,NPT)  -  PHYSICAL STACK HEIGHT (METERS).              RAM04340
C        SOURCE(6,NPT)  -  STACK GAS TEMPERATURE (KELVIN).              RAM04350
C        SOURCE(7,NPT)  -  STACK INSIDE DIAMETER (METERS).              RAM04360
C        SOURCE(8,NPT)  -  STACK GAS EXIT VELOCITY (M/SEC).             RAM04370
C                                                                       RAM04380
C         CARD WITH 'ENDP' IN COLS 1-4 IS USED TO SIGNIFY THE           RAM04390
C          END OF THE POINT SOURCES.                                    RAM04400
C                                                                       RAM04410
C      CARD TYPE 8.  AREA SOURCE CARD. FORMAT(3A4,6F10.2)               RAM04420
C                                                                       RAM04430
C            (USED IF OPTION 6 = 1 AND OPTION 7 =0)                     RAM04440
C       (ONE CARD FOR EACH AREA SOURCE, UP TO                           RAM04450
C          100 AREA SOURCE CARDS ALLOWED.)                              RAM04460
C                                                                       RAM04470
C        ANAME(J,NAS),J=1,3 - 12 CHAR. AREA SOURCE INDENT.              RAM04480
C        ASORC(1,NAS) - EAST COORD. OF SW CORNER OF AREA SOURCE         RAM04490
C                        (USER UNITS).                                  RAM04500
C        ASORC(2,NAS) - NORTH COORD. OF SW CORNER OF AREA SOURCE        RAM04510
C                        (USER UNITS).                                  RAM04520
C        ASORC(5,NAS) - SIDE LENGTH OF AREA SOURCE (USER UNITS).        RAM04530
C        ASORC(3,NAS) - SULFUR DIOXIDE EMISSION RATE FOR ENTIRE         RAM04540
C                        AREA (G/SEC).                                  RAM04550
C        ASORC(4,NAS) - PARTICULATE EMISSION RATE FOR ENTIRE            RAM04560
C                        AREA (G/SEC).                                  RAM04570
C        ASORC(6,NAS) - AREA SOURCE HEIGHT (METERS).                    RAM04580
C                                                                       RAM04590
C       (NOTE THAT ASORC(5,NAS) - SIDE LENGTH IS READ OUT OF ORDER      RAM04600
C         TO CONFORM WITH THE EXISTING ORDER OF IPP EMISSIONS DATA.)    RAM04610
C                                                                       RAM04620
C         CARD WITH 'ENDA' IN COLS 1 -4 IS USED                         RAM04630
C            TO SIGNIFY THE END OF THE AREA SOURCES.                    RAM04640
C                                                                       RAM04650
C      CARD TYPE 9.  SPECIFIED SIGNIFICANT PT. SOURCES.  FORMAT(26I3)   RAM04660
C                                                                       RAM04670
C       (USED IF OPTION 11 = 1; NSIGP MUST BE NON-ZERO.)                RAM04680
C        INPT           -  NUMBER OF USER SPECIFIED SIGNIFICANT SOURCES.RAM04690
C        MPS(I),I=1,NPT -  POINT SOURCE NUMBERS USER WANTS CONSIDERED   RAM04700
C                           SIGNIFICANT.                                RAM04710
C                                                                       RAM04720
C      CARD TYPE 10. INFO. ASSOCIATED WITH AREA SOURCES. FORMAT(FREE)   RAM04730
C       (THIS CARD IS REQUIRED ONLY IF IOPT(6)=1)                       RAM04740
C                                                                       RAM04750
C        FH       - FRACTION OF AREA SOURCE HEIGHT WHICH IS PHYSICAL    RAM04760
C                    HEIGHT.                                            RAM04770
C        XLIM     - DISTANCE LIMIT ON INTEGRATION FOR AREA SOURCE (USER RAM04780
C                    UNITS). XLIM CANNOT EXCEED 116 KM.                 RAM04790
C        NHTS     - INTEGER NUMBER OF HEIGHTS TO BE USED FOR AREA       RAM04800
C                    SOURCES (MIN=1,MAX=3).                             RAM04810
C        HINT     - HEIGHT(S) (METERS) FOR AREA SOURCE INTEGRATIONS.    RAM04820
C                    THIS IS AN ARRAY OF FROM ONE TO THREE ELEMENTS.    RAM04830
C                                                                       RAM04840
C      CARD TYPE 11. BREAKPOINT HEIGHTS. FORMAT(FREE)                   RAM04850
C                                                                       RAM04860
C       (THIS CARD IS REQUIRED ONLY WHEN CARD TYPE 10 IS USED.)         RAM04870
C                                                                       RAM04880
C         BPH  -BREAKPOINT HEIGHTS (METERS) BETWEEN AREA SOURCE HEIGHTS.RAM04890
C                    THESE VALUES DEFINE THE BOUNDS OF HEIGHTS CLASSES. RAM04900
C                BPH IS AN ARRAY OF TWO ELEMENTS. ONE VALUE WILL BE READRAM04910
C                IF NHTS ON PREVIOUS CARD IS 1 OR 2. TWO VALUES READ FORRAM04920
C                NHTS=3. IF NHTS IS 1, THE VALUE OF BPH MUST BE LARGER  RAM04930
C                THAN ANY AREA HEIGHT IN THE DATA SET FOR THE RUN.      RAM04940
C                                                                       RAM04950
C      CARD TYPE 12. SPECIFY SIGNIF. AREA SOURCES. FORMAT(26I3)         RAM04960
C                                                                       RAM04970
C       (USED IF IOPT(12)=1; NSIGA MUST BE NON-ZERO.)                   RAM04980
C                                                                       RAM04990
C        INAS     - NUMBER OF USER SPECIFIED SIGNIFICANT AREA SOURCES   RAM05000
C                    (MAX=10).                                          RAM05010
C        MAS      - AREA SOURCE NUMBERS USER WANTS TO CONSIDER SIGNIF.  RAM05020
C                                                                       RAM05030
C      CARD TYPE 13. MET. DATA IDENTIFIERS.  FORMAT(FREE)               RAM05040
C                                                                       RAM05050
C       (USED IF OPTION 8 = 0)                                          RAM05060
C                                                                       RAM05070
C        ISFCD    -  SFC MET STATION IDENTIFIER    (5 DIGITS)           RAM05080
C        ISFCYR   -  YEAR OF SFC MET DATA          (2 DIGITS)           RAM05090
C        IMXD     -  UPPER-AIR STATION IDENTIFIER  (5 DIGITS)           RAM05100
C        IMXYR    -  YEAR OF MIXING HEIGHT DATA    (2 DIGITS)           RAM05110
C                                                                       RAM05120
C      CARD TYPE 14.  POLAR COORDINATE RECEPTORS.  FORMAT(FREE)         RAM05130
C                                                                       RAM05140
C       (USED IF OPTION 18 = 1)                                         RAM05150
C                                                                       RAM05160
C        RADIL(I),I= 1,5 -  ONE TO FIVE RADIAL DISTANCES (REST OF FIVE  RAM05170
C                            ARE ZEROS) EACH OF WHICH GENERATES 36      RAM05180
C                            RECEPTORS AROUND POINT CENTX, CENTY ON     RAM05190
C                            AZIMUTHS 10 TO 360 DEGREES. (USER UNITS)   RAM05200
C        CENTX    -  EAST COORDINATE ABOUT WHICH RADIALS ARE CENTERED.  RAM05210
C                      (USER UNITS)                                     RAM05220
C        CENTY    -  NORTH COORDINATE ABOUT WHICH RADIALS ARE CENTERED. RAM05230
C                          (USER UNITS)                                 RAM05240
C                                                                       RAM05250
C      CARD TYPE 15.  RECEPTOR.  FORMAT(2A4,2F10.3,F10.0)               RAM05260
C                                                                       RAM05270
C       (USED IF OPTION 14 = 1)                                         RAM05280
C       (REMEMBER, 180 IS TOTAL NUMBER OF RECEPTORS ALLOWED IN RAM)     RAM05290
C                                                                       RAM05300
C        RNAME(I),I=1,2 -  8 DIGIT ALPHANUMERIC STATION IDENTIFICATION. RAM05310
C        RREC     -  EAST COORDINATE OF RECEPTOR (USER UNITS)           RAM05320
C        SREC     -  NORTH COORDINATE OF RECEPTOR (USER UNITS)          RAM05330
C                                                                       RAM05340
C         CARD WITH 'ENDR' IN COLS 1-4 IS USED TO SIGNIFY THE END OF    RAM05350
C          THE RECEPTOR CARDS. (NEEDED ONLY IF IOPT(14)=1.)             RAM05360
C                                                                       RAM05370
C      CARD TYPE 16. HONEYCOMB BOUNDARIES. FORMAT(FREE)                 RAM05380
C            (USED IF OPTION 17 = 1)                                    RAM05390
C                                                                       RAM05400
C       (HONEYCOMB RECEPTORS WILL ONLY BE GENERATED FOR THE AREA        RAM05410
C        DEFINED BY THESE BOUNDS)                                       RAM05420
C                                                                       RAM05430
C        NOTE, IF BOUNDARY VARIABLES ARE INPUT AS ZERO, BOUNDARIES      RAM05440
C        WILL BE THE SAME AS THE AREA SOURCE REGION. HOWEVER, IF        RAM05450
C        NO AREA SOURCES ARE INPUT AND IF HONEYCOMB RECEPTORS ARE       RAM05460
C        TO BE GENERATED, THIS CARD MUST HAVE BOUNDARIES INCLUDED       RAM05470
C        TO PROVIDE THE BOUNDS FOR RECEPTOR GENERATION.                 RAM05480
C                                                                       RAM05490
C        GRIDSPACE - GRID SPACING (DISTANCE BETWEEN) FOR HONEYCOMB      RAM05500
C                     RECEPTORS (USER UNITS).                           RAM05510
C        HRMIN     - MINIMUM EAST COORDINATE (USER UNITS).              RAM05520
C        HRMAX     - MAXIMUM EAST COORDINATE (USER UNITS).              RAM05530
C        HSMIN     - MINIMUM NORTH COORDINATE (USER UNITS).             RAM05540
C        HSMAX     - MAXIMUM NORTH COORDINATE (USER UNITS).             RAM05550
C                                                                       RAM05560
C                                                                       RAM05570
C      CARD TYPE 17.  SEGMENTED RUN. FORMAT(FREE)                       RAM05580
C       (USED IF OPTION 39=1)                                           RAM05590
C                                                                       RAM05600
C        IDAY     -  NUMBER OF DAYS PREVIOUSLY PROCESSED.               RAM05610
C        LDRUN    -  LAST DAY TO BE PROCESSED IN THIS RUN.              RAM05620
C                                                                       RAM05630
C      CARD TYPE 18.  METEOROLOGY.  FORMAT(FREE)                        RAM05640
C                                                                       RAM05650
C          (USED IF OPTION 5 = 1)                                       RAM05660
C       (ONE CARD FOR EACH HOUR OF THE SIMULATION.)                     RAM05670
C        JYR      -  YEAR OF MET DATA. (2 DIGITS)                       RAM05680
C        DAY1     -  JULIAN DAY OF MET DATA.                            RAM05690
C        JHR      -  HOUR OF MET DATA.                                  RAM05700
C        IKST     -  STABILITY CLASS FOR THIS HOUR.                     RAM05710
C        QU       -  WIND SPEED FOR THIS HOUR (M/SEC).                  RAM05720
C        QTEMP    -  AMBIENT AIR TEMPERATURE FOR THIS HOUR (KELVIN).    RAM05730
C        QTHETA   -  WIND DIRECTION FOR THIS HOUR (DEGREES AZIMUTH FROM RAM05740
C                     WHICH THE WIND BLOWS).                            RAM05750
C        QHL      -  MIXING HEIGHT FOR THIS HOUR (METERS).              RAM05760
C                                                                       RAM05770
C->->->-> SECTION C -  INPUT  FILE DESCRIPTIONS.                        RAM05780
C                                                                       RAM05790
C     INPUT FILE (UNIT 11) METEOROLOGICAL DATA (USED IF IOPT(8)=0)      RAM05800
C                                                                       RAM05810
C      RECORD 1                                                         RAM05820
C                                                                       RAM05830
C        ID          SFC STATION IDENTIFIER, 5 DIGITS                   RAM05840
C        IYEAR       YEAR OF SURFACE DATA, 2 DIGITS                     RAM05850
C        IDM         MIX HT STATION IDENTIFIER, 5 DIGITS                RAM05860
C        IYR         YEAR OF MIX HT DATA, 2 DIGITS                      RAM05870
C                                                                       RAM05880
C      RECORD TYPE 2 (ONE FOR EACH DAY OF YEAR)                         RAM05890
C                                                                       RAM05900
C        JYR         YEAR                                               RAM05910
C        IMO         MONTH                                              RAM05920
C        DAY1        JULIAN DAY                                         RAM05930
C        IKST(24)    STABILITY CLASS                                    RAM05940
C        QU(24)      WIND SPEED, METERS PER SECOND                      RAM05950
C        QTEMP(24)   AMBIENT AIR TEMPERATURE, KELVIN                    RAM05960
C        DUMR(24)    FLOW VECTOR TO 10 DEG, DEGREES AZIMUTH             RAM05970
C        QTHETA(24)  RANDOMIZED FLOW VECTOR, DEGREES AZIMUTH            RAM05980
C        HLH(2,24)   MIXING HEIGHT, METERS                              RAM05990
C                                                                       RAM06000
C   INPUT FILE(UNIT 15)  POINT SOURCE HOURLY EMISSION DATA              RAM06010
C          (USED IF IOPT(9)=1)                                          RAM06020
C                                                                       RAM06030
C     RECORD TYPE 1 (ONE FOR EACH HOUR OF SIMULATION)                   RAM06040
C                                                                       RAM06050
C        IDATA       DATE-TIME INDICATOR CONSISTING OF YEAR,            RAM06060
C                     JULIAN DAY,AND HOUR: YYDDDHH.                     RAM06070
C        SOURCE(IPOL,I),I=1,NPT  EMISSION RATE FOR THE POLLUTANT IPOL   RAM06080
C                                 FOR EACH SOURCE, GRAMS PER SECOND.    RAM06090
C                                                                       RAM06100
C   INPUT FILE(UNIT 16) AREA SOURCE HOURLY EMISSION DATA                RAM06110
C          (USED IF IOPT(10) = 1)                                       RAM06120
C                                                                       RAM06130
C     RECORD TYPE 1 (ONE FOR EACH HOUR OF SIMULATION)                   RAM06140
C                                                                       RAM06150
C        IDATA        DATE-TIME INDICATOR CONSISTING OF YEAR,           RAM06160
C                      JULIAN DAY, AND HOURS YYDDDHH.                   RAM06170
C                                                                       RAM06180
C        ASORC(IPOL,I),I=1,NAS  EMISSION RATE FOR THE POLLUTANT IPOL    RAM06190
C                        FOR EACH SOURCE, GRAMS PER SECOND FOR EACH AREARAM06200
C                                                                       RAM06210
C->->->-> SECTION D - OUTPUT PUNCHED CARD DESCRIPTION                   RAM06220
C                                                                       RAM06230
C     OUTPUT PUNCHED CARDS (UNIT 1) AVERAGE CONCENTRATIONS              RAM06240
C                        (PUNCHED IF IOPT(43)=1)                        RAM06250
C                                                                       RAM06260
C      CARD TYPE 1 (ONE FOR EACH RECEPTOR FOR EACH AVERAGING TIME)      RAM06270
C                                                                       RAM06280
C        CC:1-4      WORD'CNTL' PUNCHED                                 RAM06290
C        CC:5        BLANK                                              RAM06300
C        CC:6-15     RREC  EAST COORDINATE OF RECEPTOR, USER UNITS      RAM06310
C        CC:16-25    SREC  NORTH COORDINATE OF RECEPTOR, USER UNITS     RAM06320
C        CC:26-35    GWU   CONCENTRATION FOR AVERAGING TIME, MICROG/M**3RAM06330
C        CC:36-45    ACHI(K) CONC. FROM  AREAS,MICROG/M**3              RAM06340
C        CC:46-55    PCHI(K) CONC. FROM POINTS,MICROG/M**3              RAM06350
C        CC:56-60    K     RECEPTOR NUMBER                              RAM06360
C        CC:61-65    IDATE(1)    YEAR                                   RAM06370
C        CC:66-70    IDATE(2)    JULIAN DAY                             RAM06380
C        CC:71-75    NE     ENDING HOUR FOR AVG-PER.                    RAM06390
C        CC:76-80    NAVG    NUMBER OF HOURS IN AVG-PER.                RAM06400
C                                                                       RAM06410
C->->->-> SECTION E - OUTPUT FILE DESCRIPTIONS                          RAM06420
C                                                                       RAM06430
C     OUTPUT FILE (UNIT 10) PARTIAL CONCENTRATIONS (USED IF IOPT(40)=1) RAM06440
C                                                                       RAM06450
C      RECORD TYPE 1                                                    RAM06460
C                                                                       RAM06470
C        NPER        NUMBER OF PERIODS                                  RAM06480
C        NAVG        NUMBER OF HOURS IN AVERAGING PERIOD.               RAM06490
C        LINE1(14)   80 ALPHANUMERIC CHARACTERS FOR TITLE.              RAM06500
C        LINE2(14)   80 ALPHANUMERIC CHARACTERS FOR TITLE.              RAM06510
C        LINE3(14)   80 ALPHANUMERIC CHARACTERS FOR TITLE.              RAM06520
C                                                                       RAM06530
C      RECORD TYPE 2 (FROM  RAM ) (ONE FOR EACH AVERAGING PERIOD)       RAM06540
C                                                                       RAM06550
C        NRECEP      NUMBER OF RECEPTORS                                RAM06560
C        NPT         NUMBER OF POINT SOURCES                            RAM06570
C        NAS          NUMBER OF AREA SOURCES                            RAM06580
C        RREC(I),I=1,NRECEP  EAST COORDINATE OF RECEPTOR, USER UNITS    RAM06590
C        SREC(I),I=1,NRECEP  NORTH COORDINATE OF RECEPTOR, USER UNITS   RAM06600
C                                                                       RAM06610
C          FOR EACH SIMULATION HOUR, NRECEP RECORDS OF TYPE 3           RAM06620
C          ARE GENERATED FOLLOWED BY NRECEP RECORDS OF TYPE 4.          RAM06630
C                                                                       RAM06640
C      RECORD TYPE 3 (ONE FOR EACH RECEPTOR FOR EACH SIMULATED HOUR,    RAM06650
C                      FROM PT )                                        RAM06660
C                                                                       RAM06670
C        IDATE       YEAR AND JULIAN DAY                                RAM06680
C        LH          HOUR                                               RAM06690
C        K           RECEPTOR NUMBER                                    RAM06700
C        PARTC(J),J=1,NPT  CONCENTRATION AT RECEPTOR K FROM POINT       RAM06710
C                           SOURCE J, G/M**3.                           RAM06720
C                                                                       RAM06730
C      RECORD TYPE 4 (ONE FOR EACH RECEPTOR FOR                         RAM06740
C                    EACH SIMULATED HOUR ,FROM JMHARE)                  RAM06750
C                                                                       RAM06760
C        IDATE       YEAR AND JULIAN DAY                                RAM06770
C        LH          HOUR                                               RAM06780
C        KREC        RECEPTOR NUMBER                                    RAM06790
C        PARTC(J),J=1,NAS  CONCENTRATION AT RECEPTOR KREC FROM AREA     RAM06800
C                          SOURCE J, G/M**3                             RAM06810
C                                                                       RAM06820
C     OUTPUT FILE (UNIT 12) HOURLY CONCENTRATIONS (USED IF IOPT(41)=1)  RAM06830
C                                                                       RAM06840
C      RECORD 1                                                         RAM06850
C                                                                       RAM06860
C        NPER        NUMBER OF PERIODS                                  RAM06870
C        NAVG        NUMBER OF HOURS IN AVERAGING PERIOD.               RAM06880
C        LINE1(14)   80 ALPHANUMERIC CHARACTERS FOR TITLE.              RAM06890
C        LINE2(14)   80 ALPHANUMERIC CHARACTERS FOR TITLE.              RAM06900
C        LINE3(14)   80 ALPHANUMERIC CHARACTERS FOR TITLE.              RAM06910
C                                                                       RAM06920
C      RECORD 2                                                         RAM06930
C                                                                       RAM06940
C        NRECEP      NUMBER OF RECEPTORS.                               RAM06950
C        RREC(I),I=1,NRECEP  EAST COORDINATE OF RECEPTOR, USER UNITS    RAM06960
C        SREC(I),I=1,NRECEP  NORTH COORDINATE OF RECEPTOR, USER UNITS   RAM06970
C                                                                       RAM06980
C      RECORD TYPE 3 (ONE FOR EACH SIMULATED HOUR)                      RAM06990
C                                                                       RAM07000
C        IDATE(2)    JULIAN DAY                                         RAM07010
C        LH          HOUR                                               RAM07020
C        PHCHI(I),I=1,NRECEP  HOURLY CONCENTRATION FOR EACH RECEPTOR,   RAM07030
C                              G/M**3.                                  RAM07040
C                                                                       RAM07050
C     OUTPUT FILE (UNIT 13) AVERAGING-PERIOD CONCENTRATIONS (USED IF    RAM07060
C                            IOPT(42)=1)                                RAM07070
C                                                                       RAM07080
C      RECORD 1                                                         RAM07090
C                                                                       RAM07100
C        NPER        NUMBER OF PERIODS                                  RAM07110
C        NAVG        NUMBER OF HOURS IN AVERAGING PERIOD.               RAM07120
C        LINE1(14)   80 ALPHANUMERIC CHARACTERS FOR TITLE.              RAM07130
C        LINE2(14)   80 ALPHANUMERIC CHARACTERS FOR TITLE.              RAM07140
C        LINE3(14)   80 ALPHANUMERIC CHARACTERS FOR TITLE.              RAM07150
C                                                                       RAM07160
C      RECORD 2                                                         RAM07170
C                                                                       RAM07180
C        NRECEP      NUMBER OF RECEPTORS.                               RAM07190
C        RREC(I),I=1,NRECEP  EAST COORDINATE OF RECEPTOR, USER UNITS    RAM07200
C        SREC(I),I=1,NRECEP  NORTH COORDINATE OF RECEPTOR, USER UNITS   RAM07210
C                                                                       RAM07220
C      RECORD TYPE 3 (ONE FOR EACH SIMULATED AVERAGING PERIOD)          RAM07230
C                                                                       RAM07240
C        IDATE(2)    JULIAN DAY                                         RAM07250
C        NE          ENDING HOUR OF PERIOD                              RAM07260
C        PCHI(K),K=1,NRECEP  AVERAGING PERIOD CONCENTRATION FOR EACH    RAM07270
C                             RECEPTOR, G/M**3.                         RAM07280
C                                                                       RAM07290
C->->->-> SECTION F - TEMPORARY FILE DESCRIPTIONS                       RAM07300
C                                                                       RAM07310
C     TEMPORARY FILE (UNIT 9) EMISSION DATA                             RAM07320
C                 (ALWAYS WRITTEN; READ IF IOPT (7)= 1)                 RAM07330
C                                                                       RAM07340
C      RECORD 1                                                         RAM07350
C                                                                       RAM07360
C        NPT        NUMBER OF POINT SOURCES                             RAM07370
C        NAS        NUMBER OF AREA  SOURCES                             RAM07380
C                                                                       RAM07390
C      RECORD 2                                                         RAM07400
C                                                                       RAM07410
C        IMPS(I), I=1,25       NUMBER OF POINT SOURCE SIGNIF.           RAM07420
C        SOURCE(I,J),          POINT SOURCE INFO.                       RAM07430
C         I=1,9                                                         RAM07440
C         J=1,NPT                                                       RAM07450
C                                                                       RAM07460
C      RECORD 3                                                         RAM07470
C                                                                       RAM07480
C        IMAS(I),I=1,10          ORDER OF AREA SOURCE SIGNIF.           RAM07490
C        RMIN                    WEST BOUNDARY OF AREA SOURCES          RAM07500
C        RMAX                    EAST BOUNDARY OF AREA SOURCES          RAM07510
C        SMIN                    SOUTH BOUNDARY OF AREA SOURCES         RAM07520
C        SMAX                    NORTH BOUNDARY OF AREA SOURCES         RAM07530
C        IRSIZE                  FIRST DIMENSION OF IA ARRAY            RAM07540
C        ISSIZE                  SECOND DIMENSION OF IA ARRAY           RAM07550
C        ASORC(I,J)              AREA SOURCE INFO.                      RAM07560
C         I=1,6                                                         RAM07570
C         J=1,NAS                                                       RAM07580
C        IA(I,J)                AREA SOURCE MAP ARRAY.                  RAM07590
C             I=1,IRSIZE                                                RAM07600
C             J=1,ISSIZE                                                RAM07610
C                                                                       RAM07620
C     TEMPORARY FILE (UNIT 14) VALUES FOR HIGH-FIVE TABLES (USED IF     RAM07630
C                                IOPT(39)=1)                            RAM07640
C                                                                       RAM07650
C      ONLY RECORD                                                      RAM07660
C                                                                       RAM07670
C        IDAY(ON WRITE)    NUMBER OF DAYS PROCESSED                     RAM07680
C        IDAYS(ON READ     NUMBER OF DAYS PREVIOUSLY PROCESSED          RAM07690
C        SUM(180)          CUMULATION OF LONG-TERM CONCENTRATION,(G/M**3RAM07700
C        NHR               NUMBER OF HOURS PROCESSED                    RAM07710
C        DAY1A             JULIAN DAY OF START OF LENGTH OF RECORD.     RAM07720
C        HR1               START HOUR OF LENGTH OF RECORD               RAM07730
C        HMAXA(3,5,180,5)  HIGHEST FIVE CONCENTRATIONS (G/M**3), AND    RAM07740
C                           ASSOCIATED DAY AND HOUR, FOR EACH RECEPTOR, RAM07750
C                           FOR FIVE DIFFERENT AVERAGING TIMES.         RAM07760
C                                                                       RAM07770
C->->->-> SECTION G -  COMMON, DIMENSION, AND DATA STATEMENTS.          RAM07780
C                                                                       RAM07790
      COMMON /AB/ DELM,DELN                                             RAM07800
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,RRAM07810
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                      RAM07820
      COMMON /AE/ HC1(10),PXUCOR(6,9),PXUEXR(6,9),PXCOR(6,9),PXEXR(6,9),RAM07830
     1PXUCOF(6,9),PXUEXP(6,9),PXCOF(6,9),PXEXP(6,9),AXCOR(6,9),AXEXR(6,9RAM07840
     2),AXCOF(6,9),AXEXP(6,9)                                           RAM07850
      COMMON /AEFM/ ICODE(180),UNITS,RREU(180),SREU(180)                XXX07860
      COMMON /AEFMC/ ITYPE(180)                                         XXX07865
      COMMON /AEFGKM/ NRECEP,RREC(180),SREC(180),IDATE(2),LH,NPT        RAM07870
      COMMON /AEG/ SOURCE(9,250)                                        RAM07880
      COMMON /AEGIKM/ IPOL,CONTWO,SINT,COST,U,HANE,PL(6)                RAM07890
      COMMON /AEK/ ASORC(6,100)                                         RAM07900
      COMMON /AEM/ NSIGP,MPS(25),NSIGA,MAS(10)                          RAM07910
      COMMON /AF/ GRIDSP,HRMIN,HRMAX,HSMIN,HSMAX                        RAM07920
      COMMON /AGK/ PARTC(250)                                           RAM07930
      COMMON /AGM/ PSAV(250),HSAV(250),DH(250),DSAV(250),UPH(250),HPR(25RAM07940
     10),FP(250),PCHI(180),PHCHI(180),PSIGS(180,26),PHSIGS(180,26),IPSIGRAM07950
     2S(250),GRANDT(180)                                                RAM07960
      COMMON /AIL/ CIN(3,200),XLIM                                      RAM07970
      COMMON /AIM/ HARE(3)                                              RAM07980
      COMMON /AK/ BPH(2),RMIN,SMIN,RMAX,SMAX,NAS,IRSIZE,ISSIZE,IA(25,25)RAM07990
     1,IWD,IASIGS(100),NBP                                              RAM08000
      COMMON /AKL/ IH,NS,KREC                                           RAM08010
      COMMON /AKM/ BPHM(2),ACHI(180),AHCHI(180),ASIGS(180,11),AHSIGS(180RAM08020
     1,11)                                                              RAM08030
      COMMON /AM/ LINE1(20),LINE2(20),LINE3(20),QTHETA(24),QU(24),      XXX08040
     1QHL(24),QTEMP(24),IKST(24),NAVG,NB                                XXX08050
      COMMON /AMC/ IPOLU,RNAME(2,180)                                   XXX08055
      COMMON /AN/ HMAXA(5,180,5),NDAY(5,180,5),IHR(5,180,5),CONC(180,5),RAM08060
     1JDAY                                                              RAM08070
C                                                                       RAM08080
      CHARACTER*5 CRADIL                                                IBM
      CHARACTER*4 RNAME,PNAME,ANAME,DNAME,BNK4,ENDP,ENDA,ENDR,DUM,BLNK, IBM
     1IRIN,IRPC,STR,STAR,C,CF,TITLE,MODEL,IPOLT,IPOLU,ITYPE,ICHAR,JCHAR
      DIMENSION MODEL(2,2), DEG(3)                                      RAM08090
      DIMENSION PNAME(3,250), ANAME(3,100), IFREQ(7), DUMR(24), HLH(2,24RAM08100
     1), IMPS(25), TITLE(2), TABLE(4,21), RADIL(5)                      RAM08110
      DIMENSION IDUMR(24)                                               RAM08120
      DIMENSION SUM(180), NTIME(5), ATIME(5), IPOLT(2), DNAME(36)       IBM08130
      DOUBLE PRECISION SUM                                              XXXIBM
      DIMENSION STAR(2,180), SIGNIF(250), IMAS(10)                      RAM08140
C                                                                       RAM08150
       DIMENSION PLL(6,2),CF(5)                                         RAM08160
C                                                                       RAM08170
      EQUIVALENCE (PNAME(1,1),RNAME(1,1),ANAME(1,1))                    RAM08180
      EQUIVALENCE (UPH(1),SIGNIF(1))                                    RAM08190
      EQUIVALENCE (DH(1),TABLE(1,1))                                    RAM08200
C                                                                       RAM08210
      DATA IN /5/                                                       IBM08220
      DATA DEG /90.,180.,270./                                          RAM08230
      DATA IFREQ /7*0/ ,BLNK /' '/ ,BNK4 /'    '/ ,IRIN /'I'/ ,IRPC /'C'RAM08240
     1/                                                                 RAM08250
      DATA TITLE /'S02 ','PART'/                                        IBM08260
      DATA IRDIM /25/ ,ISDIM /25/                                       RAM08270
      DATA MODEL /'URBA','N','RURA','L'/                                RAM08280
      DATA IPOLT /'SO2 ','PART'/                                        RAM08290
C     DATA RMIN /99999./ ,SMIN /99999./                                 IBM08300
      DATA ENDP /'ENDP'/ ,ENDA /'ENDA'/ ,ENDR /'ENDR'/                  RAM08310
      DATA MAXP /250/ ,MAXA /100/ ,STR /'*'/ ,STAR /360*' '/            RAM08320
C        MAXP EQUALS SECOND DIMENSION OF THE ARRAY NAMED: SOURCE.       RAM08330
C        MAXA EQUAL SECOND DIMENSION OF THE ARRAY NAMED : ASORC.        RAM08340
      DATA DNAME /' 10,',' 20,',' 30,',' 40,',' 50,',' 60,',' 70,',' 80,RAM08350
     1',' 90,','100,','110,','120,','130,','140,','150,','160,','170,','RAM08360
     2180,','190,','200,','210,','220,','230,','240,','250,','260,','270RAM08370
     3,','280,','290,','300,','310,','320,','330,','340,','350,','360,'/RAM08380
     4                                                                  RAM08390
      DATA NTIME /1,3,8,24,0/ ,ATIME /1.,3.,8.,24.,0./                  RAM08400
      DATA ITMIN1 /9999/,IDIV8 /0/, IDIV24 /0/, ICALM /0/               RAM08410
      DATA C/'C'/,ICFL3/0/,ICFL8/0/,ICFL24/0/,CF/5*' '/                 RAM08420
C                                                                       RAM08430
C                                                                       RAM08440
C      DEFAULT POWER LAW EXPONENTS.                                     RAM08450
C                                                                       RAM08460
      DATA PLL/.15,.15,.20,.25,.30,.30,.07,.07,.10,.15,.35,.55/         RAM08470
C                                                                       RAM08480
C->->->->SECTION H - FLOW DIAGRAM                                       RAM08490
C                                                                       RAM08500
C       RELATION OF SUBROUTINES IN  RAM                                 RAM08510
C                                                                       RAM08520
C                    RAM                                                RAM08530
C                     !                                                 RAM08540
C                     ! * BLOCK DATA                                    RAM08550
C                     !                                                 RAM08560
C                     ! * READ DATA FROM CARDS                          RAM08570
C                     ! * INITIALIZE SGZ                                RAM08580
C                     ! * INITIALIZE SYSZ                               RAM08590
C                     ! * INITIALIZE JMHREC                             RAM08600
C                     !                                                 RAM08610
C                     ! * READ EMISSION DATA FROM                       RAM08620
C                     !        CARDS OR DISK                            RAM08630
C                     !                                                 RAM08640
C                     ! * READ RECEPTOR DATA                            RAM08650
C                     !                                                 RAM08660
C                     !                                                 RAM08670
C             --------! - LOOP FOR CALENDAR DAYS                        RAM08680
C             !       !                                                 RAM08690
C             !  -----! - LOOP FOR AVERAGING TIME                       RAM08700
C             !  !    !                                                 RAM08710
C             !  !    ! * READ MET DATA                                 RAM08720
C             !  !    ! * ANGARC                                        RAM08730
C             !  !    !                                                 RAM08740
C             !  !    ! * GREC (ENTRY TO JMHREC)                        RAM08750
C             !  !    !                                                 RAM08760
C             !  !    ! * JMHHON                                        RAM08770
C             !  !    !                                                 RAM08780
C             !  !  --! - LOOP ON HOURS                                 RAM08790
C             !  !  ! !                                                 RAM08800
C             !  !  ! ! - (READ HOURLY EMISSIONS)                       RAM08810
C             !  !  ! !                                                 RAM08820
C             !  !  ! ! * * * * * PT                                    RAM08830
C             !  !  ! !            !                                    RAM08840
C             !  !  ! !       ------- - LOOP ON RECEPTORS               RAM08850
C             !  !  ! !       !    !                                    RAM08860
C             !  !  ! !       !  --- - LOOP ON SOURCES                  RAM08870
C             !  !  ! !       !  ! !                                    RAM08880
C             !  !  ! !       !  ! ! * * RCON                           RAM08890
C             !  !  ! !       !  ! !      !                             RAM08900
C             !  !  ! !       !  ! !      ** SYZ(ENTRY TO SYSZ)         RAM08910
C             !  !  ! !       !  ! !                                    RAM08920
C             !  !  ! !       !  --*                                    RAM08930
C             !  !  ! !       -----*                                    RAM08940
C             !  !  ! !                                                 RAM08950
C             !  !  ! ! * * * * * JMH54                                 RAM08960
C             !  !  ! !            !                                    RAM08970
C             !  !  ! !            !  * * JMHCZ                         RAM08980
C             !  !  ! !                     !                           RAM08990
C             !  !  ! !                     !  * * SIGZ(ENTRY TO SGZ)   RAM09000
C             !  !  ! !                                                 RAM09010
C             !  !  ! !                                                 RAM09020
C             !  !  ! !                                                 RAM09030
C             !  !  ! ! * * * * * JMHARE                                RAM09040
C             !  !  ! !            !                                    RAM09050
C             !  !  ! !       ----- LOOP ON RECEPTORS                   RAM09060
C             !  !  ! !       !    !                                    RAM09070
C             !  !  ! !       !    ! * * JMHPOL                         RAM09080
C             !  !  ! !       !    !                                    RAM09090
C             !  !  ! !       !    !                                    RAM09100
C             !  !  ! !       -----*                                    RAM09110
C             !  !  ! ! * RANK                                          RAM09120
C             !  !  ! !                                                 RAM09130
C             !  !  ! ! * OUTPT                                         RAM09140
C             !  !  ! !                                                 RAM09150
C             !  !  --*                                                 RAM09160
C             !  !    !                                                 RAM09170
C             !  !    ! * OUTAV  (ENTRY POINT IN OUTPT)                 RAM09180
C             !  !    !                                                 RAM09190
C             !  -----*                                                 RAM09200
C             !       !                                                 RAM09210
C             --------*                                                 RAM09220
C                     !                                                 RAM09230
C                    STOP                                               RAM09240
C                                                                       RAM09250
C->->->->SECTION I - RUN SET-UP AND READ FIRST 6 INPUT CARDS.           RAM09260
C                                                                       RAM09270
C     CALL WSTCLK
C
C        INITIALIZATIONS............                                    RAM09280
C        THE FOLLOWING 18 STATEMENTS MAY BE DELETED FOR USE ON          RAM09290
C        COMPUTERS THAT ZERO CORE LOCATIONS USED BY A PROBLEM           RAM09300
C        PRIOR TO EXECUTION.                                            RAM09310
      NP=0                                                              RAM09320
      NHR=0                                                             RAM09330
      NP3=0                                                             RAM09340
      NP8=0                                                             RAM09350
      NP24=0                                                            RAM09360
      NPX=0                                                             RAM09370
      RMAX=0.                                                           RAM09380
      SMAX=0.                                                           RAM09390
      DO 10 I=1,21                                                      RAM09400
      TABLE(1,I)=0.                                                     RAM09410
10    TABLE(2,I)=0.                                                     RAM09420
      DO 40 I=1,180                                                     RAM09430
      SUM(I)=0.                                                         RAM09440
      DO 30 J=1,5                                                       RAM09450
      CONC(I,J)=0.                                                      RAM09460
      DO 20 K=1,5                                                       RAM09470
20    HMAXA(J,I,K)=0.                                                   RAM09480
30    CONTINUE                                                          RAM09490
40    CONTINUE                                                          RAM09500
C        UNIT 11 - DISK INPUT OF MET DATA--USED WHEN IOPT(8)=0.         RAM09510
C        UNIT 10 - DISK OUTPUT OF PARTIAL CONCENTRATIONS                RAM09520
C         AT EACH RECEPTOR--USED WHEN IOPT(40) = 1.                     RAM09530
C        UNIT 12 TAPE/DISK OUTPUT OF HRLY CONCENTRATIONS-IF IOPT(41)=1. RAM09540
C        UNIT 13 TAPE/DISK OUTPUT OF CONCENTRATIONS FOR AVERAGING PERIODRAM09550
C           USED IF IOPT(42) = 1.                                       RAM09560
C        UNIT 14 TAPE/DISK STORAGE FOR SUMMARY INFO, USED IF IOPT(39)=1.RAM09570
C        UNIT 15 - TAPE/DISK INPUT OF HOURLY POINT SOURCE EMISSIONS     RAM09580
C         -- USED IF IOPT(9) = 1.                                       RAM09590
C        UNIT 16 - TAPE/DISK INPUT OF HOURLY AREA SOURCE EMISSIONS--    RAM09600
C         -- USED IF IOPT (10)=1.                                       RAM09610
C                                                                       RAM09620
C        READ CARDS 1-3  (SEE DESCRIPTION, SECTION B).                  RAM09630
C                                                                       RAM09640
      READ (IN,1790) LINE1,LINE2,LINE3                                  RAM09650
C                                                                       RAM09660
C        READ CARD TYPE 4  (SEE DESCRIPTION, SECTION B).                RAM09670
C                                                                       RAM09680
      READ (IN,*) IDATE(1),IDATE(2),IHSTRT,NPER,NAVG,IPOL,MUOR,NSIGP,NSIRAM09690
     1GA,NAV5,CONONE,UNITS,Z,HAFL                                       RAM09700
C        THE  FORMAT REFERRED TO BY AN * IS IBM'S FREE FIELD INPUT.     IBM09710
C        VARIABLES MUST BE SEPARATED BY COMMAS.                         RAM09720
C        THIS IS SIMILAR TO IBM'S LIST DIRECTED IO.                     RAM09730
      WRITE (IO,2100) (MODEL(K,MUOR),K=1,2)                             RAM09740
      WRITE (IO,2110) LINE1,LINE2,LINE3                                 RAM09750
      IPOLU=IPOLT(1)                                                    RAM09760
      IF (IPOL.EQ.4) IPOLU=IPOLT(2)                                     RAM09770
      IF (NSIGP.LE.25) GO TO 50                                         RAM09780
C        WRITE ERROR STATEMENT                                          RAM09790
      WRITE (IO,1860) NSIGP                                             RAM09800
C     CALL WAUDIT
      STOP                                                              RAM09810
50    IF (NSIGA.LE.10) GO TO 60                                         RAM09820
C        WRITE ERROR STATEMENT                                          RAM09830
      WRITE (IO,1870) NSIGA                                             RAM09840
C     CALL WAUDIT
      STOP                                                              RAM09850
60    IP=IPOL-2                                                         RAM09860
      CONTWO=CONONE*UNITS                                               RAM09870
C                                                                       RAM09880
C        READ CARD TYPE 5  (SEE DESCRIPTION, SECTION B).                RAM09890
C                                                                       RAM09900
      READ (IN,1800) (IOPT(I),I=1,50)                                   RAM09910
C                                                                       RAM09920
      IF(IOPT(38).NE.1) GO TO 55                                        RAM09930
C                                                                       RAM09940
C        DEFAULT SELECTION RESULTS IN THE FOLLOWING: USE STACK DOWNWASH RAM09950
C        (1); USE FINAL PLUME RISE (2); USE BUOYANCY-INDUCED DISPERSION RAM09960
C        (3); WRITE HIGH-5 TABLES (36) BUT DELETE ALL OTHER OUTPUT (23, RAM09970
C        24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, AND 35).           RAM09980
C                                                                       RAM09990
C        EMISSIONS FROM PREVIOUS RUN ARE NOT ALLOWED.                   RAM10000
C        MET DATA ON CARDS ARE NOT ALLOWED.                             RAM10010
C        SPECIFICATION OF SIGNIFICANT POINT AND AREA                    RAM10020
C        SOURCES IS NOT ALLOWED.                                        RAM10030
C                                                                       RAM10040
         IOPT(1)=0                                                      RAM10050
         IOPT(2)=1                                                      RAM10060
         IOPT(3)=1                                                      RAM10070
         IOPT(7)=0                                                      RAM10080
         IOPT(8)=0                                                      RAM10090
         IOPT(11)=0                                                     RAM10100
         IOPT(12)=0                                                     RAM10110
         IOPT(15)=0                                                     RAM10120
         IOPT(16)=0                                                     RAM10130
         IOPT(23)=1                                                     RAM10140
         IOPT(24)=1                                                     RAM10150
         IOPT(25)=1                                                     RAM10160
         IOPT(26)=1                                                     RAM10170
         IOPT(27)=1                                                     RAM10180
         IOPT(28)=1                                                     RAM10190
         IOPT(29)=1                                                     RAM10200
         IOPT(30)=1                                                     RAM10210
         IOPT(31)=1                                                     RAM10220
         IOPT(32)=1                                                     RAM10230
         IOPT(33)=1                                                     RAM10240
         IOPT(34)=1                                                     RAM10250
         IOPT(35)=1                                                     RAM10260
         IOPT(36)=0                                                     RAM10270
         IOPT(39)=0                                                     RAM10280
         IOPT(40)=0                                                     RAM10290
         IOPT(41)=0                                                     RAM10300
         IOPT(42)=0                                                     RAM10310
         IOPT(43)=0                                                     RAM10320
C                                                                       RAM10330
C        SET HALF-LIFE FOR DEFAULT OPTION                               RAM10340
C                                                                       RAM10350
         IF(IPOL.EQ.3)HAFL=14400.                                       RAM10360
         IF(IPOL.NE.3)HAFL=0.                                           RAM10370
C                                                                       RAM10380
C                                                                       RAM10390
C         SET POWER LAW WIND PROFILE EXPONENTS;                         RAM10400
C         SET START HOUR, AND AVERAGING PERIOD ;                        RAM10410
C         SET THE NUMBER OF SIGNIFICANT POINT AND                       RAM10420
C         AREA SOURCES.                                                 RAM10430
C                                                                       RAM10440
         MUOR=1                                                         RAM10450
         IHSTRT=1                                                       RAM10460
         NAVG=24                                                        RAM10470
         NSIGP=0                                                        RAM10480
         NSIGA=0                                                        RAM10490
55    CONTINUE                                                          RAM10500
C                                                                       RAM10510
C                                                                       RAM10520
C                                                                       RAM10530
C                                                                       RAM10540
C                                                                       RAM10550
C                                                                       RAM10560
C           WRITE GENERAL INPUT INFORMATION                             RAM10570
      WRITE (IO,2120) (MODEL(K,MUOR),K=1,2),TITLE(IP),NPER,NAVG,IHSTRT,IRAM10580
     1DATE(2),IDATE(1),UNITS,CONONE,CONTWO,Z                            RAM10590
      DAY1A=IDATE(2)                                                    RAM10600
      HR1=IHSTRT                                                        RAM10610
      IF (HAFL.GT.0.0) GO TO 70                                         RAM10620
      TLOS=0.                                                           RAM10630
      WRITE (IO,2130)                                                   RAM10640
      GO TO 80                                                          RAM10650
70    WRITE (IO,2140) HAFL                                              RAM10660
      TLOS=693./HAFL                                                    RAM10670
C         IF HI-5 TABLE,IOPT(36),SEE IF FIFTH AVG-TIME NECESSARY.       RAM10680
80    IF (IOPT(36).EQ.1) GO TO 90                                       RAM10690
      NAVT=5                                                            RAM10700
C                                                                       RAM10710
C        FOR DEFAULT OPTION                                             RAM10720
C        ADDITIONAL AVERAGING PERIOD SET TO ZERO.                       RAM10730
      IF(IOPT(38).EQ.1) NAV5=0                                          RAM10740
C                                                                       RAM10750
      IF (NAV5.EQ.1.OR.NAV5.EQ.3.OR.NAV5.EQ.8.OR.NAV5.EQ.24.OR.NAV5.EQ.0RAM10760
     1) NAVT=4                                                          RAM10770
      NTIME(5)=NAV5                                                     RAM10780
      ATIME(5)=NAV5                                                     RAM10790
      WRITE (IO,2150) NAVT                                              RAM10800
      IF (NAVT.EQ.5) WRITE (IO,2160) NAV5                               RAM10810
C        IF NO SIGNIF. SOURCES TO BE CONSIDERED,ELIMINATE CONTRIB OUTPUTRAM10820
90    IF (NSIGP.GT.0) GO TO 100                                         RAM10830
      IOPT(25)=1                                                        RAM10840
      IOPT(33)=1                                                        RAM10850
100   IF (NSIGA.GT.0) GO TO 110                                         RAM10860
      IOPT(28)=1                                                        RAM10870
      IOPT(34)=1                                                        RAM10880
110   WRITE (IO,2170) (I,IOPT(I),I=1,4)                                 RAM10890
      WRITE (IO,2180) (I,IOPT(I),I=5,13)                                RAM10900
      WRITE (IO,2190) (I,IOPT(I),I=14,19)                               RAM10910
      WRITE (IO,2200) (I,IOPT(I),I=20,31)                               RAM10920
      WRITE (IO,2210) (I,IOPT(I),I=32,38)                               RAM10930
      WRITE (IO,2220) (I,IOPT(I),I=39,50)                               RAM10940
      ASSIGN 230 TO KTRL                                                RAM10950
      MIX=2                                                             RAM10960
      IF (MUOR.EQ.1) GO TO 120                                          RAM10970
      ASSIGN 240 TO KTRL                                                RAM10980
      MIX=1                                                             RAM10990
C         EXECUTE ASSIGN STATEMENTS FOR URBAN-RURAL SELECTIONS IN       RAM11000
C          SUBROUTINES.                                                 RAM11010
120   CALL SGZ                                                          RAM11020
      CALL SYSZ                                                         RAM11030
      CALL JMHREC                                                       RAM11040
C                                                                       RAM11050
C                                                                       RAM11060
C        READ CARD TYPE 6 (SEE DESCRIPTION, SECTION B).                 RAM11070
C                                                                       RAM11080
C      SWITCH TO SELECT DEFAULT POWER LAW EXPONENTS,                    RAM11090
C      TERRAIN ADJUSTMENT FACTORS.                                      RAM11100
C                                                                       RAM11110
      IF(IOPT(38).NE.0)READ(IN,*)HANE                                   RAM11120
      IF(IOPT(38).EQ.0)READ(IN,*)HANE,PL                                RAM11130
      IF(IOPT(38).EQ.0) GO TO 105                                       RAM11140
      DO 104 I1=1,6                                                     RAM11150
      PL(I1)=PLL(I1,MUOR)                                               RAM11160
104   CONTINUE                                                          RAM11170
105   CONTINUE                                                          RAM11180
C                                                                       RAM11190
C        MUCH OF THE FOLLOWING PROGRAM SECTION IS BASED UPON            RAM11200
C        RAMQ IN THE PREV. RAM.  THIS SECTION IS RESPONSIBLE            RAM11210
C        FOR MAKING THE NECESSARY DATA CONVERSIONS ON THE RAW           RAM11220
C        EMISSIONS DATA IN ORDER TO ESTABLISH A STANDARD                RAM11230
C        DATA BANK WHICH WILL BE ACCEPTABLE. A CONVERSION FACTOR        RAM11240
C        FROM USER UNITS TO KILOMETERS IS APPLIED WHEN NECESSARY.       RAM11250
C                                                                       RAM11260
C->->->->SECTION J - INPUT AND PROCESS EMISSION INFORMATION.            RAM11270
C                                                                       RAM11280
C           IF NOT  READING EMISSIONS FROM PREVIOUS RUN, SKIP           RAM11290
C                                                                       RAM11300
      IF (IOPT(7).EQ.0) GO TO 140                                       RAM11310
      READ (9) NPT,NAS                                                  RAM11320
C                                                                       RAM11330
C       IF NOT USING POINT SOURCES, SKIP                                RAM11340
      IF (NPT.EQ.0) GO TO 130                                           RAM11350
C           READ RECORD OF POINT SOURCE INFORMATION                     RAM11360
      READ (9) (IMPS(I),I=1,25),((SOURCE(I,J),I=1,9),J=1,NPT)           RAM11370
C                                                                       RAM11380
C        IF NOT USING AREA SOURCES, SKIP                                RAM11390
130   IF (NAS.EQ.0) GO TO 630                                           RAM11400
C           READ RECORD OF AREA SOURCE INFORMATION                      RAM11410
      READ (9) (IMAS(I),I=1,10),RMIN,RMAX,SMIN,SMAX,IRSIZE,ISSIZE,((ASORRAM11420
     1C(I,J),I=1,6),J=1,NAS),((IA(I,J),I=1,IRSIZE),J=1,ISSIZE)          RAM11430
      GO TO 630                                                         RAM11440
C                                                                       RAM11450
C        ARE THERE POINT SOURCES? IF NOT, SKIP TO AREA SECTION.         RAM11460
140   IF (IOPT(5).EQ.0) GO TO 310                                       RAM11470
C                                                                       RAM11480
      IF (IOPT(20).EQ.1) GO TO 150                                      RAM11490
C          WRITE HEADING FOR POINT SOURCE INFO.                         RAM11500
      WRITE (IO,2240)                                                   RAM11510
150   NPT=0                                                             RAM11520
C                                                                       RAM11530
C        BEGIN LOOP TO READ THE POINT SOURCE INFORMATION                RAM11540
160   NPT=NPT+1                                                         RAM11550
      IF (NPT.LE.MAXP) GO TO 170                                        RAM11560
      READ (IN,1810) DUM                                                RAM11570
      IF (DUM.EQ.ENDP) GO TO 270                                        RAM11580
C       WRITE ERROR STATEMENT                                           RAM11590
      WRITE (IO,1880) MAXP                                              RAM11600
C     CALL WAUDIT
      STOP                                                              RAM11610
C                                                                       RAM11620
C        READ CARD TYPE 7  (SEE DESCRIPTION, SECTION B).                RAM11630
C                                                                       RAM11640
170   READ (IN,1820) (PNAME(I,NPT),I=1,3),(SOURCE(I,NPT),I=1,8)         RAM11650
C        CARD WITH     'ENDP'   IN COL 1-4 IS USED TO SIGNIFY END OF    RAM11660
C        POINT SOURCES.                                                 RAM11670
      IF (PNAME(1,NPT).EQ.ENDP) GO TO 270                               RAM11680
C        CALCULATE BUOYANCY FACTOR                                      RAM11690
      D=SOURCE(7,NPT)                                                   RAM11700
C         FOLLOWING VARIABLE IS BRIGGS' F WITHOUT TEMPERATURE FACTOR.   RAM11710
      SOURCE(9,NPT)=2.45153*SOURCE(8,NPT)*D*D                           RAM11720
C        2.45153 IS GRAVITY OVER FOUR.                                  RAM11730
      TS=SOURCE(6,NPT)                                                  RAM11740
      IF (TS.GT.293.) GO TO 180                                         RAM11750
      HF=SOURCE(5,NPT)                                                  RAM11760
      GO TO 200                                                         RAM11770
180   F=SOURCE(9,NPT)*(TS-293.)/TS                                      RAM11780
      IF (F.GE.55.) GO TO 190                                           RAM11790
C        ONLY BUOYANCY PLUME RISE IS CONSIDERED HERE.                   RAM11800
      HF=SOURCE(5,NPT)+21.425*F**0.75/3.                                RAM11810
      GO TO 200                                                         RAM11820
190   HF=SOURCE(5,NPT)+38.71*F**0.6/3.                                  RAM11830
C        HSAV, DSAV, AND PSAV ARE USED FOR TEMPORARY STORAGE            RAM11840
200   HSAV(NPT)=HF                                                      RAM11850
C        DETERMINE HEIGHT INDEX.                                        RAM11860
      DO 210 IH=2,9                                                     RAM11870
      IF (HF.LT.(HC1(IH)-.01)) GO TO 220                                RAM11880
210   CONTINUE                                                          RAM11890
      IH=10                                                             RAM11900
220   IS=IH-1                                                           RAM11910
      GO TO KTRL, (230,240)                                             RAM11920
230   A=PXUCOF(2,IS)                                                    RAM11930
      B=PXUEXP(2,IS)                                                    RAM11940
      GO TO 250                                                         RAM11950
240   A=PXUCOR(2,IS)                                                    RAM11960
      B=PXUEXR(2,IS)                                                    RAM11970
250   DSAV(NPT)=(A*HF**B)*SOURCE(IPOL,NPT)/3.                           RAM11980
C        AN ESTIMATE OF THE POTENTIAL IMPACT OF EACH SOURCE IS          RAM11990
C         DETERMINED AND STORED IN DSAV. MAX CONCENTRATION IS           RAM12000
C         DETERMINED BY CHI(MAX)=(A*H**B)*Q/U WHERE                     RAM12010
C         A IS THE COEFFICENT AND B IS THE EXPONENT, OF                 RAM12020
C         MAXIMUM CHI*U/Q VALUES PREDETERMINED FOR B STABILITY          RAM12030
C         AND A SPECIFIC EFFECTIVE HEIGHT RANGE. PLUME RISE             RAM12040
C         IS CALCULATED FOR B STABILITY AND 3 M/SEC WIND SPEED.         RAM12050
C                                                                       RAM12060
      IPSIGS(NPT)=0                                                     RAM12070
      IF (IOPT(20).EQ.1) GO TO 260                                      RAM12080
C        LIST POINT SOURCE INFORMATION.                                 RAM12090
      WRITE (IO,2250) NPT,(PNAME(J,NPT),J=1,3),(SOURCE(K,NPT),K=1,8),DSARAM12100
     1V(NPT),HSAV(NPT),F                                                RAM12110
C        SOURCE COORDINATES ARE TRANSFORMED INTO INTERNAL UNITS.        RAM12120
260   SOURCE(1,NPT)=SOURCE(1,NPT)/UNITS                                 RAM12130
      SOURCE(2,NPT)=SOURCE(2,NPT)/UNITS                                 RAM12140
C                                                                       RAM12150
C        GO BACK AND READ DATA FOR ANOTHER POINT SOURCE.                RAM12160
      GO TO 160                                                         RAM12170
C                                                                       RAM12180
270   NPT=NPT-1                                                         RAM12190
C                                                                       RAM12200
C                                                                       RAM12210
C        RANK  25  HIGHEST POINT SOURCES.                               RAM12220
      NLIM=25                                                           RAM12230
      IF (NPT.LT.25) NLIM=NPT                                           RAM12240
      DO 290 I=1,NLIM                                                   RAM12250
      SIGMAX=-1.0                                                       RAM12260
      DO 280 J=1,NPT                                                    RAM12270
      IF (DSAV(J).LE.SIGMAX) GO TO 280                                  RAM12280
      SIGMAX=DSAV(J)                                                    RAM12290
      LMAX=J                                                            RAM12300
280   CONTINUE                                                          RAM12310
C        IMPS IS THE SOURCE NUMBER IN ORDER OF SIGNIFICANCE.            RAM12320
      IMPS(I)=LMAX                                                      RAM12330
C        PSAV IS THE CALC. CONC. IN ORDER OF SIGNIFICANCE.              RAM12340
      PSAV(I)=SIGMAX                                                    RAM12350
290   DSAV(LMAX)=-1.0                                                   RAM12360
C        OUTPUT TABLE OF RANKED SOURCES.                                RAM12370
      WRITE (IO,2260) TITLE(IP)                                         RAM12380
      DO 300 I=1,NLIM                                                   RAM12390
      WRITE (IO,2270) I,PSAV(I),IMPS(I)                                 RAM12400
300   CONTINUE                                                          RAM12410
C       IF NOT EXPECTING AREA SOURCES, SKIP.                            RAM12420
310   IF (IOPT(6).EQ.0) GO TO 550                                       RAM12430
      NAS=0                                                             RAM12440
      IF (IOPT(21).EQ.1) GO TO 320                                      RAM12450
      WRITE (IO,2280)                                                   RAM12460
C        BEGIN LOOP TO READ AREA SOURCES                                RAM12470
320   NAS=NAS+1                                                         RAM12480
      IF (NAS.LE.MAXA) GO TO 330                                        RAM12490
      READ (IN,1810) DUM                                                RAM12500
      IF (DUM.EQ.ENDA) GO TO 390                                        RAM12510
C        WRITE ERROR STATEMENT                                          RAM12520
      WRITE (IO,1890) MAXA                                              RAM12530
C     CALL WAUDIT
      STOP                                                              RAM12540
C                                                                       RAM12550
C        READ CARD TYPE 8  (SEE DESCRIPTION, SECTION B)                 RAM12560
C                                                                       RAM12570
330   READ (IN,1830) (ANAME(J,NAS),J=1,3),ASORC(1,NAS),ASORC(2,NAS),ASORRAM12580
     1C(5,NAS),ASORC(3,NAS),ASORC(4,NAS),ASORC(6,NAS)                   RAM12590
      IF (ANAME(1,NAS).EQ.ENDA) GO TO 390                               RAM12600
      IF (IOPT(22).EQ.1) GO TO 370                                      RAM12610
C        STORE AREA EMISSIONS ACCORDING TO HEIGHT CLASS                 RAM12620
      DO 340 I=1,20                                                     RAM12630
      HC=I*5.                                                           RAM12640
      IF (ASORC(6,NAS).LE.HC) GO TO 350                                 RAM12650
340   CONTINUE                                                          RAM12660
      GO TO 360                                                         RAM12670
C         ADD EMISSION RATE INTO TABLE AND TOTAL.                       RAM12680
350   TABLE(3,I)=TABLE(3,I)+ASORC(IPOL,NAS)                             RAM12690
360   TABLE(3,21)=TABLE(3,21)+ASORC(IPOL,NAS)                           RAM12700
C         CALCULATE SIDE LENGTH IN INTERNAL UNITS                       RAM12710
370   WA=ASORC(5,NAS)/UNITS                                             RAM12720
C       CONVERTS SIDE LENGTH IN INTERNAL UNITS TO METERS AND ADJUST     RAM12730
C       EMISSION RATE                                                   RAM12740
      SF=WA*1000.*CONTWO                                                RAM12750
C       DETERMINE EMISSION RATE IN G/SEC-M**2.                          RAM12760
      ASORC(3,NAS)=ASORC(3,NAS)/(SF*SF)                                 RAM12770
      ASORC(4,NAS)=ASORC(4,NAS)/(SF*SF)                                 RAM12780
C       FOR AREA SOURCES, SIGNIFICANCE IS DETERMINED BY SELECTING A     RAM12790
C       SPECIFIED NUMBER OF AREA SOURCES (N < OR = 10) WHICH HAVE       RAM12800
C       THE HIGHEST EMISSION RATE TIMES THE SIDE LENGTH OF THE AREA     RAM12810
C       SOURCE.                                                         RAM12820
      SIGNIF(NAS)=SF*ASORC(IPOL,NAS)                                    RAM12830
      IF (IOPT(21).EQ.1) GO TO 380                                      RAM12840
      WRITE (IO,2290) NAS,(ANAME(J,NAS),J=1,3),(ASORC(K,NAS),K=1,6),SIGNRAM12850
     1IF(NAS)                                                           RAM12860
C       CO-ORDINATES ARE TRANSLATED TO INTERNAL UNITS.                  RAM12870
380   ASORC(1,NAS)=ASORC(1,NAS)/UNITS                                   RAM12880
      ASORC(2,NAS)=ASORC(2,NAS)/UNITS                                   RAM12890
      ASORC(5,NAS)=WA                                                   RAM12900
C       READJUST AREA SOURCE REGION BOUNDARIES AS REQUIRED              RAM12910
C         (INTERNAL UNITS).                                             RAM12920
      RC=ASORC(1,NAS)                                                   RAM12930
      SC=ASORC(2,NAS)                                                   RAM12940
      IF (RC.LT.RMIN) RMIN=RC                                           RAM12950
      IF (SC.LT.SMIN) SMIN=SC                                           RAM12960
C        RC,SC, AND WA IN INTERNAL UNITS.                               RAM12970
      A=RC+WA                                                           RAM12980
      B=SC+WA                                                           RAM12990
      IF (A.GT.RMAX) RMAX=A                                             RAM13000
      IF (B.GT.SMAX) SMAX=B                                             RAM13010
C          GO BACK AND READ DATA FOR ANOTHER AREA SOURCE.               RAM13020
      GO TO 320                                                         RAM13030
C                                                                       RAM13040
390   NAS=NAS-1                                                         RAM13050
C                                                                       RAM13060
C          DETERMINE SIZE OF AREA ARRAY                                 RAM13070
      A=RMAX-RMIN+.0005                                                 RAM13080
      IRSIZE=A                                                          RAM13090
      IF (A-FLOAT(IRSIZE).GT.0.001) GO TO 410                           RAM13100
      B=SMAX-SMIN+.0005                                                 RAM13110
      ISSIZE=B                                                          RAM13120
      IF (B-FLOAT(ISSIZE).GT.0.001) GO TO 420                           RAM13130
C        CHECK SIZE OF AREA SOURCE REGION WITH DIMENSIONS OF IA ARRAY.  RAM13140
      IF (IRSIZE.GT.IRDIM) GO TO 400                                    RAM13150
      IF (ISSIZE.LE.ISDIM) GO TO 430                                    RAM13160
C         WRITE ERROR STATEMENT                                         RAM13170
400   WRITE (IO,1900) IRSIZE,ISSIZE                                     RAM13180
C     CALL WAUDIT
      STOP                                                              RAM13190
C         WRITE ERROR STATEMENT                                         RAM13200
410   WRITE (IO,1910)                                                   RAM13210
C     CALL WAUDIT
      STOP                                                              RAM13220
C         WRITE ERROR STATEMENT                                         RAM13230
420   WRITE (IO,1920)                                                   RAM13240
C     CALL WAUDIT
      STOP                                                              RAM13250
C        ZERO IA ARRAY(AREA SOURCE MAP ARRAY)                           RAM13260
430   DO 440 I=1,IRSIZE                                                 RAM13270
      DO 440 J=1,ISSIZE                                                 RAM13280
440   IA(I,J)=0                                                         RAM13290
C       LOOP THROUGH ALL AREA SOURCES AND STORE SOURCE NO'S IN IA.      RAM13300
C         THERE CAN BE NO OVERLAPPING OF AREA SOURCES. LOCATIONS ARE    RAM13310
C         DEFINED BY THE INTERNAL GRID SYSTEM.                          RAM13320
      A=RMIN-1.                                                         RAM13330
      B=SMIN-1.                                                         RAM13340
      DO 460 NS=1,NAS                                                   RAM13350
      IR=ASORC(1,NS)-A+.0005                                            RAM13360
      IS=ASORC(2,NS)-B+.0005                                            RAM13370
      IWA=ASORC(5,NS)+.0005-1.                                          RAM13380
      IQ=IS+IWA                                                         RAM13390
      ID=IR+IWA                                                         RAM13400
      DO 450 I=IR,ID                                                    RAM13410
      DO 450 J=IS,IQ                                                    RAM13420
C        CHECK TO SEE IF IA ALREADY HAS A SOURCE IN THE I,J TH POSITION RAM13430
      IF (IA(I,J).EQ.0) GO TO 450                                       RAM13440
C         WRITE ERROR STATEMENT                                         RAM13450
      WRITE (IO,1930) IA(I,J),I,J,NS                                    RAM13460
C     CALL WAUDIT
      STOP                                                              RAM13470
C        STORE SOURCE NO. IN APPROPRIATE POSITION                       RAM13480
450   IA(I,J)=NS                                                        RAM13490
460   CONTINUE                                                          RAM13500
C       PRINT OUT AREA SOURCE MAP ARRAY(IA) IF NOT TOO LARGE TO FIT     RAM13510
C         ACROSS PAGE.                                                  RAM13520
      IF (IRSIZE.GT.41) GO TO 480                                       RAM13530
      WRITE (IO,2300)                                                   RAM13540
      ID=ISSIZE+1                                                       RAM13550
      DO 470 IQ=1,ISSIZE                                                RAM13560
      J=ID-IQ                                                           RAM13570
470   WRITE (IO,2310) J,(IA(I,J),I=1,IRSIZE)                            RAM13580
      WRITE (IO,2320) (I,I=1,IRSIZE)                                    RAM13590
      GO TO 490                                                         RAM13600
C         WRITE EXPLANATORY STATEMENT                                   RAM13610
480   WRITE (IO,1940)                                                   RAM13620
C        PRINT OUT ORIGIN CO-ORDINATES AND BOUNDARIES IN INTERNAL UNITS RAM13630
490   WRITE (IO,2330) A,B,IRSIZE,ISSIZE                                 RAM13640
      WRITE (IO,2340) RMIN,RMAX,SMIN,SMAX                               RAM13650
C                                                                       RAM13660
C         RANK HIGHEST 10 AREA SOURCES                                  RAM13670
      NLIM=10                                                           RAM13680
      IF (NAS.LT.10) NLIM=NAS                                           RAM13690
      DO 510 I=1,NLIM                                                   RAM13700
      SIGMAX=-1.0                                                       RAM13710
      DO 500 J=1,NAS                                                    RAM13720
      IF (SIGNIF(J).LE.SIGMAX) GO TO 500                                RAM13730
      SIGMAX=SIGNIF(J)                                                  RAM13740
      LMAX=J                                                            RAM13750
500   CONTINUE                                                          RAM13760
      IMAS(I)=LMAX                                                      RAM13770
      HPR(I)=SIGMAX                                                     RAM13780
510   SIGNIF(LMAX)=-1.0                                                 RAM13790
      IF (NSIGA.EQ.0) GO TO 530                                         RAM13800
      WRITE (IO,2350) TITLE(IP)                                         RAM13810
      DO 520 I=1,NLIM                                                   RAM13820
      WRITE (IO,2360) I,HPR(I),IMAS(I)                                  RAM13830
520   CONTINUE                                                          RAM13840
530   DO 540 I=1,NAS                                                    RAM13850
      ASORC(5,I)=ASORC(5,I)*0.5                                         RAM13860
540   IASIGS(I)=0                                                       RAM13870
550   IF (IOPT(22).EQ.1) GO TO 610                                      RAM13880
C                                                                       RAM13890
C           EMISSIONS WITH HEIGHT TABLE.                                RAM13900
C                                                                       RAM13910
      DO 590 I=1,NPT                                                    RAM13920
      DO 560 J=1,20                                                     RAM13930
      HC=J*5.                                                           RAM13940
      IF (SOURCE(5,I).LE.HC) GO TO 570                                  RAM13950
560   CONTINUE                                                          RAM13960
C        POINT SOURCES WITH PHYSICAL HEIGHTS GT 100 METERS ARE LISTED   RAM13970
C        SEPARATELY.                                                    RAM13980
      WRITE (IO,2370) I,SOURCE(5,I),SOURCE(IPOL,I)                      RAM13990
      GO TO 580                                                         RAM14000
C        ADD EMISSION RATE INTO TABLE AND TOTAL.                        RAM14010
570   TABLE(1,J)=TABLE(1,J)+SOURCE(IPOL,I)                              RAM14020
580   TABLE(1,21)=TABLE(1,21)+SOURCE(IPOL,I)                            RAM14030
590   CONTINUE                                                          RAM14040
C          OUTPUT SOURCE-STRENGTH-HEIGHT TABLE                          RAM14050
C           THIS TABLE DISPLAYS THE TOTAL EMISSIONS FOR BOTH POINT AND  RAM14060
C           AREA SOURCES AND THE CUMULATIVE FREQUENCY ACCORDING TO      RAM14070
C           HEIGHT CLASS. REQUIRED INPUT TO RAM, SUCH AS HEIGHT CLASS   RAM14080
C           BOUNDARIES FOR AREA SOURCES AND REPRESENTATIVE HEIGHTS FOR  RAM14090
C           EACH HEIGHT CLASS, CAN BE DETERMINED FROM THESE TABLES.     RAM14100
      WRITE (IO,2380) TITLE(IP)                                         RAM14110
C         HEIGHT CLASS EMISSIONS ARE IN 1 AND 3.                        RAM14120
C          DETERMINE CUMULATIVE PERCENT IN 2 AND 4.                     RAM14130
      IF (TABLE(1,21).EQ.0.0) TABLE(1,21)=1.0                           RAM14140
      IF (TABLE(3,21).EQ.0.0) TABLE(3,21)=1.0                           RAM14150
      ID=0                                                              RAM14160
      IQ=5                                                              RAM14170
      TABLE(2,1)=TABLE(1,1)/TABLE(1,21)                                 RAM14180
      TABLE(4,1)=TABLE(3,1)/TABLE(3,21)                                 RAM14190
      WRITE (IO,2390) ID,IQ,(TABLE(J,1),J=1,4)                          RAM14200
      DO 600 I=2,20                                                     RAM14210
      IQ=I*5                                                            RAM14220
      ID=IQ-4                                                           RAM14230
      TABLE(2,I)=TABLE(1,I)/TABLE(1,21)+TABLE(2,I-1)                    RAM14240
      TABLE(4,I)=TABLE(3,I)/TABLE(3,21)+TABLE(4,I-1)                    RAM14250
      WRITE (IO,2390) ID,IQ,(TABLE(J,I),J=1,4)                          RAM14260
600   CONTINUE                                                          RAM14270
      IF (NSIGP.EQ.0) TABLE(1,21)=0.0                                   RAM14280
      IF (NSIGA.EQ.0) TABLE(3,21)=0.0                                   RAM14290
      WRITE (IO,2400) TABLE(1,21),TABLE(3,21)                           RAM14300
C          WRITE FIRST EMISSION RECORD                                  RAM14310
610   WRITE (9) NPT,NAS                                                 RAM14320
      IF (NPT.EQ.0) GO TO 620                                           RAM14330
C                                                                       RAM14340
C                                                                       RAM14350
C           WRITE RECORD OF POINT SOURCE INFORMATION                    RAM14360
      WRITE (9) (IMPS(I),I=1,25),((SOURCE(I,J),I=1,9),J=1,NPT)          RAM14370
620   IF (NAS.EQ.0) GO TO 630                                           RAM14380
C           WRITE RECORD OF AREA SOURCE INFORMATION                     RAM14390
      WRITE (9) (IMAS(I),I=1,10),RMIN,RMAX,SMIN,SMAX,IRSIZE,ISSIZE,((ASORAM14400
     1RC(I,J),I=1,6),J=1,NAS),((IA(I,J),I=1,IRSIZE),J=1,ISSIZE)         RAM14410
C                                                                       RAM14420
C->->->->SECTION K - EXECUTE FOR INPUT OF SIGNIFICANT SOURCE NUMBERS.   RAM14430
C                                                                       RAM14440
630   WRITE (IO,2410) NPT,NSIGP                                         RAM14450
      IF (NSIGP.EQ.0) GO TO 700                                         RAM14460
      IF (NSIGP.GT.NPT) NSIGP=NPT                                       RAM14470
      IF (NSIGA.GT.NAS) NSIGA=NAS                                       RAM14480
      IF (IOPT(11).EQ.0) GO TO 660                                      RAM14490
C                                                                       RAM14500
C        READ CARD TYPE 9 (SEE DESCRIPTION, SECTION B).                 RAM14510
C                                                                       RAM14520
      READ (IN,1840) INPT,(MPS(I),I=1,INPT)                             RAM14530
      WRITE (IO,2420) INPT,(MPS(I),I=1,INPT)                            RAM14540
      IF (INPT.LE.NSIGP) GO TO 640                                      RAM14550
C         WRITE ERROR STATEMENT                                         RAM14560
      WRITE (IO,1950) INPT,NSIGP                                        RAM14570
C     CALL WAUDIT
      STOP                                                              RAM14580
640   IF (INPT.EQ.0) GO TO 660                                          RAM14590
C        IF LAST SPECIFIED SOURCE NUMBER IS ZERO WRITE WARNING STATEMENTRAM14600
      IF (MPS(INPT).EQ.0) WRITE (IO,1960)                               RAM14610
      J=INPT+1                                                          RAM14620
      K=1                                                               RAM14630
C        ADD SIGNIFICANT PT. SOURCES DETERMINED FROM RANKED SOURCE LIST RAM14640
C        IF NSIGP GREATER THAN INPT.                                    RAM14650
      IF (J.GT.NSIGP) GO TO 680                                         RAM14660
      DO 650 I=J,NSIGP                                                  RAM14670
      MPS(I)=IMPS(K)                                                    RAM14680
650   K=K+1                                                             RAM14690
      GO TO 680                                                         RAM14700
660   DO 670 I=1,NSIGP                                                  RAM14710
670   MPS(I)=IMPS(I)                                                    RAM14720
680   WRITE (IO,2430) (MPS(I),I=1,NSIGP)                                RAM14730
C        FILL IN SIGNIFICANT POINT SOURCE ARRAY                         RAM14740
      DO 690 I=1,NSIGP                                                  RAM14750
      J=MPS(I)                                                          RAM14760
690   IPSIGS(J)=I                                                       RAM14770
700   IF (IOPT(9).EQ.0) GO TO 720                                       RAM14780
C        SAVE AVERAGE EMISSION RATE                                     RAM14790
      DO 710 I=1,NPT                                                    RAM14800
710   PSAV(I)=SOURCE(IPOL,I)                                            RAM14810
C                                                                       RAM14820
C        IOPT(6) CONTROL OPTION, AREA SOURCE INPUT? 0=NO, 1=YES.        RAM14830
C          IF NO AREA SOURCES, SKIP                                     RAM14840
720   IF (IOPT(6).EQ.0) GO TO 800                                       RAM14850
      WRITE (IO,2440) NAS,NSIGA                                         RAM14860
C                                                                       RAM14870
C         READ CARD TYPE 10                                             RAM14880
C                                                                       RAM14890
      READ (IN,*) FH,XLIM,NHTS,(HINT(I),I=1,NHTS)                       RAM14900
      NBP=NHTS-1                                                        RAM14910
      WRITE (IO,2450) NHTS,(HINT(I),I=1,NHTS)                           RAM14920
      IF (NBP.LE.0) NBP=1                                               RAM14930
C                                                                       RAM14940
C          READ CARD TYPE 11.                                           RAM14950
C                                                                       RAM14960
      READ (IN,*) (BPH(I),I=1,NBP)                                      RAM14970
      WRITE (IO,2460) (BPH(I),I=1,NBP)                                  RAM14980
C        CONVERT TO USER UNITS FOR PRINT OUT. XLIM IS CONVERTED TO KM.  RAM14990
      C1=RMIN*UNITS                                                     RAM15000
      C2=RMAX*UNITS                                                     RAM15010
      C3=SMIN*UNITS                                                     RAM15020
      C4=SMAX*UNITS                                                     RAM15030
      C5=XLIM                                                           RAM15040
      XLIM=XLIM*CONONE                                                  RAM15050
      WRITE (IO,2470) FH,C5,C1,C2,C3,C4,IRSIZE,ISSIZE                   RAM15060
      IF (XLIM.LT.116.) GO TO 730                                       RAM15070
C         WRITE ERROR STATEMENT                                         RAM15080
      WRITE (IO,1970) XLIM                                              RAM15090
C     CALL WAUDIT
      STOP                                                              RAM15100
730   IF (NSIGA.EQ.0) GO TO 810                                         RAM15110
C        IF NOT SPECIFYING SIGNIF. AREA SOURCES, SKIP                   RAM15120
      IF (IOPT(12).EQ.0) GO TO 760                                      RAM15130
C                                                                       RAM15140
C        READ THE NUMBER OF SIGNIFICANT AREA SOURCES THAT USER          RAM15150
C        WANTS TO SPECIFY AND THE NUMBER DESIGNATIONS OF THOSE SOURCES  RAM15160
C        ON CARD TYPE 12.                                               RAM15170
C                                                                       RAM15180
      READ (IN,1840) INAS,(MAS(I),I=1,INAS)                             RAM15190
      WRITE (IO,2480) INAS,(MAS(I),I=1,INAS)                            RAM15200
      IF (INAS.LE.NSIGA) GO TO 740                                      RAM15210
C         WRITE ERROR STATEMENT                                         RAM15220
      WRITE (IO,1950) INAS,NSIGA                                        RAM15230
C     CALL WAUDIT
      STOP                                                              RAM15240
740   IF (INAS.EQ.0) GO TO 760                                          RAM15250
C        IF LAST SPECIFIED SOURCE NUMBER IS ZERO WRITE WARNING STATEMENTRAM15260
      IF (MAS(INAS).EQ.0) WRITE (IO,1980)                               RAM15270
      J=INAS+1                                                          RAM15280
      K=1                                                               RAM15290
C         ADD SIGNIFICANT AREA SOURCES DETERMINED FROM RANKED SOURCE    RAM15300
C             LIST IF NSIGA GREATER THAN INAS.                          RAM15310
      IF (J.GT.NSIGA) GO TO 780                                         RAM15320
      DO 750 I=J,NSIGA                                                  RAM15330
      MAS(I)=IMAS(K)                                                    RAM15340
750   K=K+1                                                             RAM15350
      GO TO 780                                                         RAM15360
C      TRANSFER SIGNIFICANT SOURCES DETERMINED FROM SIGNIFICANT SOURCE  RAM15370
C       LIST IF INAS EQUAL ZERO.                                        RAM15380
760   DO 770 I=1,NSIGA                                                  RAM15390
770   MAS(I)=IMAS(I)                                                    RAM15400
780   WRITE (IO,2490) (MAS(I),I=1,NSIGA)                                RAM15410
C                                                                       RAM15420
C       FILL IN SIGNIFICANT AREA SOURCE MARKER ARRAY                    RAM15430
      DO 790 I=1,NSIGA                                                  RAM15440
      J=MAS(I)                                                          RAM15450
790   IASIGS(J)=I                                                       RAM15460
800   CONTINUE                                                          RAM15470
C                                                                       RAM15480
C->->->->SECTION L - CHECK MET DATA IF FROM FILE OF ONE YEAR'S DATA.    RAM15490
C                                                                       RAM15500
810   IF (IOPT(8).EQ.1) GO TO 840                                       RAM15510
C                                                                       RAM15520
C        READ CARD TYPE 13 (SEE DESCRIPTION, SECTION B).                RAM15530
C                                                                       RAM15540
      READ (IN,*) ISFCD,ISFCYR,IMXD,IMXYR                               RAM15550
C        READ ID RECORD FROM PREPROCESSED MET DISK OR TAPE FILE.        RAM15560
      READ (11) ID,IYEAR,IDM,IYM                                        RAM15570
      IF (ISFCD.EQ.ID.AND.ISFCYR.EQ.IYEAR) GO TO 820                    RAM15580
C        WRITE ERROR STATEMENT                                          RAM15590
      WRITE (IO,1990) ISFCD,ISFCYR,ID,IYEAR,IMXD,IMXYR,IDM,IYM          RAM15600
C     CALL WAUDIT
      STOP                                                              RAM15610
820   IF (IMXD.EQ.IDM.AND.IMXYR.EQ.IYM) GO TO 830                       RAM15620
C        WRITE ERROR STATEMENT                                          RAM15630
      WRITE (IO,1990) ISFCD,ISFCYR,ID,IYEAR,IMXD,IMXYR,IDM,IYM          RAM15640
C     CALL WAUDIT
      STOP                                                              RAM15650
830   WRITE (IO,2500) ISFCD,ISFCYR,IMXD,IMXYR                           RAM15660
C                                                                       RAM15670
C->->->->SECTION M - GENERATE POLAR COORDINATE RECEPTORS.               RAM15680
C                                                                       RAM15690
840   NRECEP=0                                                          RAM15700
      WRITE (IO,2510)                                                   RAM15710
      DO 850 I=1,180                                                    RAM15720
      DO 850 J=1,2                                                      RAM15730
850   RNAME(J,I)=BNK4                                                   RAM15740
      IF (IOPT(18).NE.1) GO TO 890                                      RAM15750
C                                                                       RAM15760
C        READ CARD TYPE 14 (SEE DESCRIPTION, SECTION B).                RAM15770
C                                                                       RAM15780
      READ (IN,*) RADIL,CENTX,CENTY                                     RAM15790
      JA=0                                                              RAM15800
      DO 860 J=1,5                                                      RAM15810
      IF (RADIL(J).EQ.0) GO TO 860                                      RAM15820
      JA=JA+1                                                           RAM15830
860   CONTINUE                                                          RAM15840
      WRITE (IO,2520) CENTX,CENTY,RADIL                                 RAM15850
      DO 880 I=1,36                                                     RAM15860
C          CALCULATE THE ANGLE IN RADIANS                               RAM15870
      A=FLOAT(I)*0.1745329                                              RAM15880
C        0.1745329 IS 2*PI/36                                           RAM15890
      SINT=SIN(A)                                                       RAM15900
      COST=COS(A)                                                       RAM15910
      DO 870 J=1,JA                                                     RAM15920
      NRECEP=I+36*(J-1)                                                 RAM15930
      RREU(NRECEP)=(RADIL(J)*SINT)+CENTX                                RAM15940
C          CALCULATE THE EAST-COORDINATE                                RAM15950
      SREU(NRECEP)=(RADIL(J)*COST)+CENTY                                RAM15960
C          CALCULATE THE NORTH-COORDINATE                               RAM15970
      ITYPE(NRECEP)=IRPC                                                RAM15980
      RNAME(1,NRECEP)=DNAME(I)                                          RAM15990
C          ALPHANUMERIC INFORMATION WHICH INDICATES DEGREES AZIMUTH     RAM16000
C     ENCODE (4,2530,RNAME(2,NRECEP)) RADIL(J)                          IBM16010
C          ENCODE THE FLOATING POINT VARIABLE OF RADIAL DISTANCE        RAM16020
C          TO ALPHANUMERIC REPRESENTATION SO INFO CAN BE PRINTED        RAM16030
C                                                                       IBM
C  THE IBM3090 DOES NOT SUPPORT ENCODE SO WRITE THE RADIL DISTANCE      IBM
C  TO AN INTERNAL FILE TO CONVERT IT TO A CHARACTER VALUE               IBM
C                                                                       IBM
      ASSIGN 2531 TO NUMF                                               IBM
      IF (RADIL(J) .LT. 100.) ASSIGN 2532 TO NUMF                       IBM
      IF (RADIL(J) .LT. 0.1) ASSIGN 2533 TO NUMF                        IBM
      WRITE(CRADIL,NUMF) RADIL(J)                                       IBM
      RNAME(2,NRECEP)=CRADIL                                            IBM
C                                                                       IBM
870   CONTINUE                                                          RAM16040
880   CONTINUE                                                          RAM16050
      NRECEP=36*JA                                                      RAM16060
C                                                                       RAM16070
C->->->->SECTION N - READ AND PROCESS RECEPTOR INFORMATION.             RAM16080
C                                                                       RAM16090
C          NOW READ CARD TYPE 15 IF NECESSARY. MUST HAVE A CARD WITH    RAM16100
C          'ENDR'IN COLS 1-4 TO INDICATE END OF RECEPTOR CARDS.         RAM16110
C          NO MORE THAN 180 RECEPTORS CAN BE INPUT TO MPTER.            RAM16120
C                                                                       RAM16130
890   IF (IOPT(14).EQ.0) GO TO 940                                      RAM16140
C        START LOOP TO ENTER RECEPTORS.                                 RAM16150
      NRECEP=NRECEP+1                                                   RAM16160
      IF (NRECEP.LE.180) GO TO 910                                      RAM16170
      READ (IN,1810,END=900) DUM                                        RAM16180
      IF (DUM.EQ.ENDR) GO TO 930                                        RAM16190
C        WRITE ERROR STATEMENT                                          RAM16200
900   WRITE (IO,2000)                                                   RAM16210
C     CALL WAUDIT
      STOP                                                              RAM16220
C                                                                       RAM16230
C        READ CARD TYPE 15 (SEE DESCRIPTION, SECTION B).                RAM16240
C                                                                       RAM16250
910   READ (IN,1850) (RNAME(J,NRECEP),J=1,2),RREU(NRECEP),SREU(NRECEP)  RAM16260
C        PLACE 'ENDR' IN COLS 1 TO 4 ON CARD FOLLOWING LAST RECEPTOR    RAM16270
C        TO END READING TYPE 15 CARDS.                                  RAM16280
      ITYPE(NRECEP)=IRIN                                                RAM16290
      IF (RNAME(1,NRECEP).EQ.ENDR) GO TO 920                            RAM16300
      GO TO 890                                                         RAM16310
920   RNAME(1,NRECEP)=BNK4                                              RAM16320
930   NRECEP=NRECEP-1                                                   RAM16330
      IF (NRECEP.GT.0) GO TO 940                                        RAM16340
C         WRITE ERROR STATEMENT                                         RAM16350
      WRITE (IO,2010) NRECEP                                            RAM16360
C     CALL WAUDIT
      STOP                                                              RAM16370
940   IF (NRECEP.EQ.0) GO TO 960                                        RAM16380
C        PRINT OUT TABLE OF RECEPTORS.    (IN USER UNITS)               RAM16390
      WRITE (IO,2540)                                                   RAM16400
      DO 950 K=1,NRECEP                                                 RAM16410
      WRITE (IO,2550) K,ITYPE(K),(RNAME(J,K),J=1,2),RREU(K),SREU(K)     RAM16420
      RREC(K)=RREU(K)/UNITS                                             RAM16430
      SREC(K)=SREU(K)/UNITS                                             RAM16440
950   ICODE(K)=0                                                        RAM16450
960   NPREC=NRECEP                                                      RAM16460
      IF (IOPT(17).EQ.0) GO TO 990                                      RAM16470
C                                                                       RAM16480
C        READ CARD TYPE 16                                              RAM16490
C                                                                       RAM16500
      READ (IN,*) GRDSPU,HRMNU,HRMXU,HSMNU,HSMXU                        RAM16510
      IF (HRMXU.EQ.0.0) GO TO 970                                       RAM16520
C      IF USER DOESN'T SPECIFY BOUNDARIES FOR HONEYCOMB SOURCES         RAM16530
C      USE AREA SOURCE BOUNDARIES.                                      RAM16540
C      CONVERT INPUT GRID BOUNDARIES(USER UNITS) TO INTERNAL UNITS      RAM16550
      HRMIN=HRMNU/UNITS                                                 RAM16560
      HRMAX=HRMXU/UNITS                                                 RAM16570
      HSMIN=HSMNU/UNITS                                                 RAM16580
      HSMAX=HSMXU/UNITS                                                 RAM16590
      GO TO 980                                                         RAM16600
C       RMIN,RMAX,SMIN,SMAX ARE IN INTERNAL UNITS                       RAM16610
970   HRMIN=RMIN                                                        RAM16620
      HRMAX=RMAX                                                        RAM16630
      HSMIN=SMIN                                                        RAM16640
      HSMAX=SMAX                                                        RAM16650
C       CONVERT GRIDSP FROM USER UNITS TO INTERNAL UNITS.               RAM16660
980   GRIDSP=GRDSPU/UNITS                                               RAM16670
C                                                                       RAM16680
C->->->->SECTION O - POSITION FILES AS REQUIRED.                        RAM16690
C                                                                       RAM16700
990   IF (IOPT(39).EQ.0) GO TO 1000                                     RAM16710
C                                                                       RAM16720
C        READ CARD TYPE 17 (SEE DESCRIPTION, SECTION B).                RAM16730
C                                                                       RAM16740
      READ (IN,*) IDAY,LDRUN                                            RAM16750
      WRITE (IO,2560) IDAY,LDRUN                                        RAM16760
      IF (IDAY.EQ.0) GO TO 1000                                         RAM16770
C        READ INFO FOR HIGH-FIVE TABLE FROM LAST SEGMENT.               RAM16780
      READ (14) IDAYS,SUM,NHR,DAY1A,HR1,HMAXA,NDAY,IHR                  RAM16790
      REWIND 14                                                         RAM16800
      IF (IDAY.EQ.IDAYS) GO TO 1000                                     RAM16810
C         WRITE ERROR STATEMENT                                         RAM16820
      WRITE (IO,2020) IDAY,IDAYS                                        RAM16830
C     CALL WAUDIT
      STOP                                                              RAM16840
1000  NP=IDAY*(24/NAVG)                                                 RAM16850
C        IF OPTION 40 = 1, WRITE INITIAL INFO TO UNIT 10(PART. CONC.)   RAM16860
      IF (IOPT(40).EQ.1) WRITE (10) NPER,NAVG,LINE1,LINE2,LINE3         RAM16870
      IF (IOPT(41).EQ.0) GO TO 1040                                     RAM16880
      IF (IOPT(15).EQ.0.AND.IOPT(16).EQ.0.AND.IOPT(17).EQ.0) GO TO 1010 RAM16890
C           WRITE TERMINATION OF RUN STATEMENT                          RAM16900
C           (WRONG COMBINATION OF OPTIONS).                             RAM16910
      WRITE (IO,2030)                                                   RAM16920
C     CALL WAUDIT
      STOP                                                              RAM16930
1010  IF (IDAY.LE.0) GO TO 1030                                         RAM16940
C        SKIP PREVIOUSLY GENERATED HOURLY RECORDS.                      RAM16950
      ISKIP=IDAY*24+2                                                   RAM16960
      DO 1020 I=1,ISKIP                                                 RAM16970
1020  READ (12)                                                         RAM16980
      GO TO 1040                                                        RAM16990
C        WRITE LEAD TWO RECORDS ON HOURLY FILE.                         RAM17000
1030  WRITE (12) NPER,NAVG,LINE1,LINE2,LINE3                            RAM17010
      WRITE (12) NRECEP,(RREU(I),I=1,NRECEP),(SREU(I),I=1,NRECEP)       RAM17020
1040  IF (IOPT(42).EQ.0) GO TO 1080                                     RAM17030
      IF (IOPT(15).EQ.0.AND.IOPT(16).EQ.0.AND.IOPT(17).EQ.0) GO TO 1050 RAM17040
C           WRITE TERMINATION OF RUN STATEMENT                          RAM17050
C           (WRONG COMBINATION OF OPTIONS).                             RAM17060
      WRITE (IO,2030)                                                   RAM17070
C     CALL WAUDIT
      STOP                                                              RAM17080
1050  IF (IDAY.LE.0) GO TO 1070                                         RAM17090
C        SKIP PREVIOUSLY GENERATED AVERAGING-PERIOD FILE.               RAM17100
      ISKIP=NP+2                                                        RAM17110
      DO 1060 I=1,ISKIP                                                 RAM17120
1060  READ (13)                                                         RAM17130
      GO TO 1080                                                        RAM17140
C        WRITE LEAD TWO RECORDS ON AVERAGING PERIOD FILE.               RAM17150
1070  WRITE (13) NPER,NAVG,LINE1,LINE2,LINE3                            RAM17160
      WRITE (13) NRECEP,(RREU(I),I=1,NRECEP),(SREU(I),I=1,NRECEP)       RAM17170
      GO TO 1120                                                        RAM17180
1080  IF (IOPT(9).EQ.0) GO TO 1100                                      RAM17190
      IF (IDAY.EQ.0) GO TO 1100                                         RAM17200
C         SKIP PREVIOUSLY USED HOURLY PT. EMISSIONS.                    RAM17210
      ISKIP=IDAY*24                                                     RAM17220
      DO 1090 I=1,ISKIP                                                 RAM17230
1090  READ (15)                                                         RAM17240
1100  IF (IOPT(10).EQ.0) GO TO 1120                                     RAM17250
      IF (IDAY.EQ.0) GO TO 1120                                         RAM17260
C         SKIP PREVIOUSLY USED HOURLY AREA EMISSIONS.                   RAM17270
      ISKIP=IDAY*24                                                     RAM17280
      DO 1110 I=1,ISKIP                                                 RAM17290
1110  READ (16)                                                         RAM17300
1120  IDAY=IDATE(2)-1                                                   RAM17310
      IF (IDAY.LE.0.OR.IOPT(8).EQ.1) GO TO 1140                         RAM17320
C        SKIP PREVIOUSLY USED HOURLY MET.  RECORDS.                     RAM17330
      DO 1130 I=1,IDAY                                                  RAM17340
1130  READ (11)                                                         RAM17350
1140  CONTINUE                                                          RAM17360
C                                                                       RAM17370
C->->->->SECTION P - START LOOPS FOR DAY AND AVG TIME; READ MET DATA.   RAM17380
C                                                                       RAM17390
1150  IDAY=IDAY+1                                                       RAM17400
      D=IDAY                                                            RAM17410
      NHRS=0                                                            RAM17420
      IF (IOPT(8).EQ.1) GO TO 1190                                      RAM17430
C        IF OPTION 8 EQUALS ZERO, INPUT MET DATA OFF DISK (UNIT 11)     RAM17440
      READ (11) JYR,ID,DAY1,IKST,QU,QTEMP,DUMR,QTHETA,HLH               RAM17450
      DO 1151 JM1=1,24                                                  RAM17460
      IDUMR(JM1)=DUMR(JM1)+0.5                                          RAM17470
 1151 CONTINUE                                                          RAM17480
      IF (JYR.NE.IDATE(1)) GO TO 1160                                   RAM17490
      IF (DAY1.EQ.D) GO TO 1170                                         RAM17500
C        DATE ON MET TAPE DOES NOT MATCH INTERNAL DATE                  RAM17510
C         WRITE ERROR STATEMENT                                         RAM17520
1160  WRITE (IO,2040) JYR,IDATE(2),IDATE(1),IDAY                        RAM17530
C     CALL WAUDIT
      STOP                                                              RAM17540
C        MODIFY WIND VECTOR BY 180 DEGREES. SINCE FLOW VECTORS WERE     RAM17550
C        OUTPUT FROM RAMMET. THIS CONVERTS BACK TO WIND DIRECTIONS.     RAM17560
1170  IDATE(2)=DAY1                                                     RAM17570
      DO 1180 IQ=1,24                                                   RAM17580
      IF (IKST(IQ).EQ.7) IKST(IQ)=6                                     RAM17590
      QTHETA(IQ)=QTHETA(IQ)+180.                                        RAM17600
      IF (QTHETA(IQ).GT.360.) QTHETA(IQ)=QTHETA(IQ)-360.                RAM17610
1180  QHL(IQ)=HLH(MIX,IQ)                                               RAM17620
1190  NB=IHSTRT                                                         RAM17630
      NE=NB+NAVG-1                                                      RAM17640
      IF (NB.GT.0) GO TO 1200                                           RAM17650
C    WRITE ERROR STATEMENT                                              RAM17660
      WRITE (IO,2050) IHSTRT                                            RAM17670
C     CALL WAUDIT
      STOP                                                              RAM17680
C        START LOOP FOR AVERAGING PERIOD.                               RAM17690
1200  U=0.0                                                             RAM17700
      TEMP=0.0                                                          RAM17710
      DELN=0.0                                                          RAM17720
      DELM=0.0                                                          RAM17730
      DO 1210 I=1,7                                                     RAM17740
1210  IFREQ(I)=0.0                                                      RAM17750
      NRECEP=NPREC                                                      RAM17760
      DO 1240 I=NB,NE                                                   RAM17770
      JHR=I                                                             RAM17780
      DAY2=IDATE(2)                                                     RAM17790
      IF (IOPT(8).EQ.0) GO TO 1220                                      RAM17800
C                                                                       RAM17810
C        READ CARD TYPE 18 IF IOPT(8) =1. (HOURLY MET DATA)             RAM17820
C         (SEE DESCRIPTION, SECTION B).                                 RAM17830
C                                                                       RAM17840
      READ (IN,*) JYR,DAY1,JHR,IKST(JHR),QU(JHR),QTEMP(JHR),QTHETA(JHR),RAM17850
     1QHL(JHR)                                                          RAM17860
      IF (I.NE.NB) GO TO 1220                                           RAM17870
C        REDEFINE START HOURS AND DATES AT FIRST HOUR OF EACH           RAM17880
C         AVERAGING PERIOD IF READING HOURLY MET DATA.                  RAM17890
C         THE PURPOSE OF THIS IS TO BE ABLE TO CALCULATE                RAM17900
C         FOR SEVERAL AVG-PERIODS THAT ARE NOT CONTINUOUS               RAM17910
C         IN TIME.                                                      RAM17920
      IDATE(1)=JYR                                                      RAM17930
      IHSTRT=JHR                                                        RAM17940
      ISTDAY=DAY1                                                       RAM17950
      IDATE(2)=ISTDAY                                                   RAM17960
      DAY2=IDATE(2)                                                     RAM17970
1220  IF (IKST(JHR).EQ.7) IKST(JHR)=6                                   RAM17980
      IF (IOPT(15).EQ.0.AND.IOPT(16).EQ.0.AND.IOPT(23).EQ.1) GO TO 1240 RAM17990
C                                                                       RAM18000
C->->->->SECTION Q - CALCULATE AND  WRITE  MET. SUMMARY INFO.           RAM18010
C                                                                       RAM18020
      IF (IOPT(23).EQ.1) GO TO 1230                                     RAM18030
      IF (I.EQ.NB) WRITE (IO,2570) NAVG,IHSTRT,IDATE                    RAM18040
      WRITE (IO,2580) JHR,QTHETA(JHR),QU(JHR),QHL(JHR),QTEMP(JHR),IKST(JRAM18050
     1HR)                                                               RAM18060
1230  TRAD=QTHETA(JHR)*0.01745329                                       RAM18070
      SINT=SIN(TRAD)                                                    RAM18080
      COST=COS(TRAD)                                                    RAM18090
C        CALCULATE WIND COMPONENTS                                      RAM18100
      URES=QU(JHR)                                                      RAM18110
      A=URES*SINT                                                       RAM18120
      B=URES*COST                                                       RAM18130
      DELM=DELM+A                                                       RAM18140
      DELN=DELN+B                                                       RAM18150
      TEMP=TEMP+QTEMP(JHR)                                              RAM18160
      U=U+URES                                                          RAM18170
      KST=IKST(JHR)                                                     RAM18180
      IFREQ(KST)=IFREQ(KST)+1                                           RAM18190
C        END LOOP TO READ ALL MET DATA FOR AVERAGING PERIOD.            RAM18200
1240  CONTINUE                                                          RAM18210
      IF (IOPT(15).EQ.0.AND.IOPT(16).EQ.0.AND.IOPT(23).EQ.1) GO TO 1310 RAM18220
C        CALCULATE RESULTANT  WIND DIRECTION THETA                      RAM18230
      DELN=DELN/NAVG                                                    RAM18240
      DELM=DELM/NAVG                                                    RAM18250
      THETA=ANGARC(DELM,DELN)                                           RAM18260
C        CALCULATE AVERAGE AND RESULTANT SPEED AND PERSISTENCE.         RAM18270
      U=U/NAVG                                                          RAM18280
      TEMP=TEMP/NAVG                                                    RAM18290
      URES=SQRT(DELN*DELN+DELM*DELM)                                    RAM18300
      A=URES/U                                                          RAM18310
C        DETERMINE MODAL AND AVERAGE STABILITY                          RAM18320
      LSMAX=0                                                           RAM18330
      DO 1250 I=1,7                                                     RAM18340
      LST=IFREQ(I)                                                      RAM18350
      IF (LST.LE.LSMAX) GO TO 1250                                      RAM18360
      LSMAX=LST                                                         RAM18370
      LSTAB=I                                                           RAM18380
1250  CONTINUE                                                          RAM18390
      ID=LSTAB+1                                                        RAM18400
      KST=LSTAB                                                         RAM18410
      DO 1260 I=ID,7                                                    RAM18420
      IF (LSMAX.EQ.IFREQ(I)) GO TO 1270                                 RAM18430
1260  CONTINUE                                                          RAM18440
      GO TO 1290                                                        RAM18450
C        IF TIE FOR MAX MODAL STABILITY, CALCULATE AVERAGE STABILITY    RAM18460
1270  IQ=0                                                              RAM18470
      DO 1280 J=1,7                                                     RAM18480
1280  IQ=IQ+IFREQ(J)*J                                                  RAM18490
      KST=FLOAT(IQ)/FLOAT(NAVG)+0.5                                     RAM18500
C        PRINT RESULTANT MET DATA SUMMARY FOR AVERAGING PERIOD.         RAM18510
1290  IF (IOPT(23).EQ.1) GO TO 1300                                     RAM18520
      WRITE (IO,2590) THETA,URES,U,TEMP,A,KST                           RAM18530
C                                                                       RAM18540
C->->->->SECTION R - DETERMINE ADDITIONAL RECEPTORS FOR THIS AVG-PERIOD RAM18550
C          (OPTIONAL).                                                  RAM18560
C                                                                       RAM18570
C         DETERMINE RECEPTORS ACCORDING TO SIGNIFICANT SOURCES          RAM18580
C         IOPT(15)  CONTROL OPTION, SIGNIFICANT POINT RECEPTORS?        RAM18590
C         IOPT(16)  CONTROL OPTION, SIGNIFICANT AREA RECEPTORS?         RAM18600
1300  IF ((IOPT(15)+IOPT(16)).EQ.0) GO TO 1310                          RAM18610
      TRAD=THETA*0.01745329                                             RAM18620
      SINT=SIN(TRAD)                                                    RAM18630
      COST=COS(TRAD)                                                    RAM18640
      CALL GREC                                                         RAM18650
C        FILL IN RECEPTORS WITH HONEYCOMB ARRAY                         RAM18660
C      IOPT(17) CONTROL OPTION, FILL IN HONEYCOMB RECEPTORS? 0=NO, 1=YESRAM18670
1310  IF (IOPT(17).EQ.0) GO TO 1320                                     RAM18680
      WRITE (IO,2600) HRMNU,HRMXU,HSMNU,HSMXU,GRDSPU                    RAM18690
      CALL JMHHON                                                       RAM18700
1320  IF (NRECEP.NE.0) GO TO 1330                                       RAM18710
C         WRITE ERROR STATEMENT                                         RAM18720
      WRITE (IO,2060)                                                   RAM18730
C     CALL WAUDIT
      STOP                                                              RAM18740
C         INITIALIZE CONCENTRATION SUMS                                 RAM18750
C      IF SIGNIFICANT OR HONEYCOMB RECEPTORS,WRITE CAUTIONING STATEMENT.RAM18760
1330  IF ((IOPT(15)+IOPT(16)+IOPT(17)).GT.0) WRITE (IO,2610)            RAM18770
C        REDEFINE NB AND NE IN CASE NON-CONSECUTIVE DAYS ARE BEING RUN  RAM18780
      IF (IOPT(8).EQ.0) GO TO 1340                                      RAM18790
      NB=IHSTRT                                                         RAM18800
      NE=IHSTRT+NAVG-1                                                  RAM18810
C                                                                       RAM18820
C->->->->SECTION S - INITIALIZE FOR HOURLY LOOP.                        RAM18830
C                                                                       RAM18840
C        INITIALIZE SUMS FOR CONC AND PARTIAL CONC FOR AVG PERIOD.      RAM18850
1340  DO 1370 K=1,NRECEP                                                RAM18860
      ACHI(K)=0.                                                        RAM18870
      PCHI(K)=0.0                                                       RAM18880
      DO 1350 I=1,11                                                    RAM18890
1350  ASIGS(K,I)=0.                                                     RAM18900
      DO 1360 I=1,26                                                    RAM18910
1360  PSIGS(K,I)=0.0                                                    RAM18920
1370  CONTINUE                                                          RAM18930
C        IF SAVING PARTIAL CONCENTRATIONS, WRITE  SECOND RECORD .       RAM18940
      IF (IOPT(40).EQ.0) GO TO 1380                                     RAM18950
      WRITE (10) NRECEP,NPT,NAS,(RREU(I),I=1,NRECEP),(SREU(I),I=1,NRECEPRAM18960
     1)                                                                 RAM18970
C                                                                       RAM18980
C->->->->SECTION T - BEGIN HOURLY LOOP.                                 RAM18990
C                                                                       RAM19000
1380  DO 1580 ID=NB,NE                                                  RAM19010
      LH=ID                                                             RAM19020
      IF (LH.LE.24) GO TO 1390                                          RAM19030
      LH=MOD(ID,24)                                                     RAM19040
      IF (LH.EQ.1) IDATE(2)=DAY1                                        RAM19050
C        INITIALIZE SUMS FOR CONC AND PARTIAL CONC FOR HOURLY PERIODS.  RAM19060
1390  DO 1420 K=1,NRECEP                                                RAM19070
      AHCHI(K)=0.                                                       RAM19080
      PHCHI(K)=0.0                                                      RAM19090
      DO 1400 I=1,11                                                    RAM19100
1400  AHSIGS(K,I)=0.                                                    RAM19110
      DO 1410 I=1,26                                                    RAM19120
1410  PHSIGS(K,I)=0.0                                                   RAM19130
1420  CONTINUE                                                          RAM19140
C        SET MET CONDITIONS FOR THIS HOUR                               RAM19150
      THETA=QTHETA(LH)                                                  RAM19160
C       DETERMINE WIND DIRECTION CONTROL, IWD, 90 DEG. QUADRANT OF WIND RAM19170
C                                                                       RAM19180
      DO 1430 I=1,3                                                     RAM19190
      IF (THETA.LE.DEG(I)) GO TO 1440                                   RAM19200
1430  CONTINUE                                                          RAM19210
      I=4                                                               RAM19220
1440  IWD=I                                                             RAM19230
      U=QU(LH)                                                          RAM19240
      HL=QHL(LH)                                                        RAM19250
      TEMP=QTEMP(LH)                                                    RAM19260
      KST=IKST(LH)                                                      RAM19270
      TRAD=THETA*0.01745329                                             RAM19280
      SINT=SIN(TRAD)                                                    RAM19290
      COST=COS(TRAD)                                                    RAM19300
C        IF OPTION 9 IS 1, READ HOURLY EMISSIONS.                       RAM19310
      IF (IOPT(9).EQ.0) GO TO 1450                                      RAM19320
C          WRITE ERROR STATEMENT                                        RAM19330
      IDCK=IDATE(1)*100000+IDATE(2)*100+LH                              RAM19340
      READ (15) IDATA,(SOURCE(IPOL,I),I=1,NPT)                          RAM19350
C        CHECK DATE                                                     RAM19360
      IF (IDCK.EQ.IDATA) GO TO 1450                                     RAM19370
C         WRITE ERROR STATEMENT                                         RAM19380
      WRITE (IO,2070) IDCK,IDATA                                        RAM19390
C     CALL WAUDIT
      STOP                                                              RAM19400
C        CALCULATE POINT SOURCE CONTRIBUTIONS                           RAM19410
1450  CALL PT                                                           RAM19420
C        CHECK FOR AREA SOURCES                                         RAM19430
      IF (IOPT(6).NE.1) GO TO 1490                                      RAM19440
C        IOPT(10) CONTROL OPTION, HOURLY EMISSION INPUT? 0=NO, 1=YES    RAM19450
      IF (IOPT(10).EQ.0) GO TO 1480                                     RAM19460
      IDCK=IDATE(1)*100000+IDATE(2)*100+LH                              RAM19470
C        READ HOURLY AREA SOURCE EMISSION RECORD                        RAM19480
      READ (16) IDATA,(ASORC(IPOL,I),I=1,NAS)                           RAM19490
C        CHECK DATE                                                     RAM19500
      IF (IDCK.EQ.IDATA) GO TO 1460                                     RAM19510
C        WRITE ERROR STATEMENT                                          RAM19520
      WRITE (IO,2080) IDCK,IDATA                                        RAM19530
C     CALL WAUDIT
      STOP                                                              RAM19540
C        CONVERT HOURLY AREA EMISSIONS FROM G/SEC TO G/SQ. M/SEC        RAM19550
1460  DO 1470 I=1,NAS                                                   RAM19560
C        CONVERT SIDE LENGTH TO METERS.                                 RAM19570
C        NOTE: SIDE LENGTH HAD BEEN MULTIPLIED BY .5 ABOVE FOR TIME     RAM19580
C        CONSIDERATIONS                                                 RAM19590
      SF=ASORC(5,I)*2000*CONTWO                                         RAM19600
1470  ASORC(IPOL,I)=ASORC(IPOL,I)/(SF*SF)                               RAM19610
C        SET UP INTEGRATION TABLES FOR AREA SOURCE CALCULATIONS         RAM19620
1480  CALL JMH54                                                        RAM19630
C        CALCULATE AREA SOURCE CONTRIBUTIONS                            RAM19640
      CALL JMHARE                                                       RAM19650
C         DETERMINE TOTAL CONCENTRATION.                                RAM19660
1490  DO 1500 K=1,NRECEP                                                RAM19670
1500  GRANDT(K)=AHCHI(K)+PHCHI(K)                                       RAM19680
      IF (IOPT(41).EQ.0) GO TO 1510                                     RAM19690
C        WRITE HOURLY CONCENTRATIONS TO TAPE                            RAM19700
C         THIS WILL GENERATE NPER*NAVG RECORDS.                         RAM19710
      WRITE (12) IDATE(2),LH,(GRANDT(I),I=1,NRECEP)                     RAM19720
C                                                                       RAM19730
C->->->->SECTION U - CALCULATE AND STORE FOR HIGH-FIVE TABLE.           RAM19740
C                                                                       RAM19750
1510  NHR=NHR+1                                                         RAM19760
C        IF OPTION 36 IS 1, DELETE COMPUTATIONS FOR AVG CONC.           RAM19770
C         FOR LENGTH OF RECORD AND HIGH-FIVE TABLE.                     RAM19780
      IF (IOPT(36).EQ.1) GO TO 1570                                     RAM19790
C        CUMULATE CONCENTRATIONS FOR AVG TIMES AND LENGTH OF RECORD.    RAM19800
C                                                                       RAM19810
C         FOR DEFAULT OPTION DETERMINE CALM HOURS.                      RAM19820
C         FOR CALM HOURS, CONCENTRATIONS AT EACH RECEPTOR ARE           RAM19830
C          SET EQUAL TO ZERO.                                           RAM19840
C         --- A CALM HOUR IS AN HOUR WITH A WIND SPEED                  RAM19850
C             OF 1.00 M/S AND A WIND DIRECTION THE SAME                 RAM19860
C              AS THE PREVIOUS HOUR.                                    RAM19870
      IF(IOPT(38).EQ.1.AND.QU(LH).LT.1.009.AND.ITMIN1.EQ.               RAM19880
     *IDUMR(LH))THEN                                                    RAM19890
      ICALM=ICALM+1                                                     RAM19900
      DO 955 K=1,NRECEP                                                 RAM19910
      GRANDT(K)=0.0                                                     RAM19920
955   CONTINUE                                                          RAM19930
      GO TO 971                                                         RAM19940
      END IF                                                            RAM19950
      DO 1530 K=1,NRECEP                                                RAM19960
      DO 1520 L=1,NAVT                                                  RAM19970
1520  CONC(K,L)=CONC(K,L)+GRANDT(K)                                     RAM19980
1530  SUM(K)=SUM(K)+GRANDT(K)                                           RAM19990
C          STORE DATE FOR WHICH CONCS. HAVE BEEN CALCULATED.            RAM20000
  971 JDAY=IDATE(2)                                                     RAM20010
C        SUBROUTINE RANK IS CALLED WHENEVER A COUNTER                   RAM20020
C        INDICATES THAT ENOUGH END TO END HOURLY CONCENTRATIONS         RAM20030
C        HAVE BEEN STORED OFF TO COMPLETE AN AVG TIME.                  RAM20040
C        NP3, NP8, NP24, NPX ARE USED AS COUNTERS FOR EACH              RAM20050
C        AVG TIME AND ARE ZEROED AFTER EACH CALL TO RANK.               RAM20060
C                                                                       RAM20070
C        FOR THE DEFAULT OPTION CALCULATE AVERAGE                       RAM20080
C        CONCENTRATION FOR APPROPRIATE AVERAGING PERIOD.                RAM20090
C        SET UP CALM FLAG FOR ENTRY INTO SUBROUTINE RANK.               RAM20100
C                                                                       RAM20110
      IF(IOPT(38).EQ.0) GOTO 979                                        RAM20120
      CALL RANK(1)                                                      RAM20130
      NP3=NP3+1                                                         RAM20140
      IF(QU(LH).LT.1.009.AND.IDUMR(LH).EQ.ITMIN1)ICFL3=1                RAM20150
      IF(NP3.NE.3) GO TO 974                                            RAM20160
C        FOR 3 HOUR AVERAGING PERIOD DIVIDE SUM BY 3.0.                 RAM20170
      DO 972 LQ=1,NRECEP                                                RAM20180
972   CONC(LQ,2)=CONC(LQ,2)/3.0                                         RAM20190
      LL2=2                                                             RAM20200
      IF(ICFL3.EQ.1)LL2=22                                              RAM20210
      CALL RANK(LL2)                                                    RAM20220
      NP3=0                                                             RAM20230
      ICFL3=0                                                           RAM20240
974   NP8=NP8+1                                                         RAM20250
      IDIV8=IDIV8+1                                                     RAM20260
      IF(QU(LH).LT.1.009.AND.IDUMR(LH).EQ.ITMIN1)THEN                   RAM20270
      IDIV8=IDIV8-1                                                     RAM20280
      ICFL8=1                                                           RAM20290
      END IF                                                            RAM20300
      IF(NP8.NE.8)GO TO 976                                             RAM20310
      IF(IDIV8.LT.6)IDIV8=6                                             RAM20320
      DIV8=IDIV8                                                        RAM20330
C        FOR 8 HOUR AVERAGING PERIOD DIVIDE THE SUM OF THE HOURLY       RAM20340
C        CONCENTRATIONS BY THE NUMBER OF NON-CALM HOURS OR 6.0          RAM20350
C        WHICHEVER IS GREATER.                                          RAM20360
      DO 975 LQ=1,NRECEP                                                RAM20370
975   CONC(LQ,3)=CONC(LQ,3)/DIV8                                        RAM20380
      LL3=3                                                             RAM20390
      IF(ICFL8.EQ.1)LL3=33                                              RAM20400
      CALL RANK(LL3)                                                    RAM20410
      NP8=0                                                             RAM20420
      IDIV8=0                                                           RAM20430
      ICFL8=0                                                           RAM20440
976   NP24=NP24+1                                                       RAM20450
      IDIV24=IDIV24+1                                                   RAM20460
      IF(QU(LH).LT.1.009.AND.IDUMR(LH).EQ.ITMIN1)THEN                   RAM20470
      IDIV24=IDIV24-1                                                   RAM20480
      ICFL24=1                                                          RAM20490
      END IF                                                            RAM20500
      IF(NP24.NE.24)GO TO 1011                                          RAM20510
      IF(IDIV24.LT.18)IDIV24=18                                         RAM20520
      DIV24=IDIV24                                                      RAM20530
C        FOR 24 HOUR AVERAGING PERIOD DIVIDE THE SUM OF THE HOURLY      RAM20540
C        CONCENTRATIONS BY THE NUMBER OF NON-CALM HOURS OR 18,          RAM20550
C        WHICHEVER IS GREATER.                                          RAM20560
      DO 977 LQ=1,NRECEP                                                RAM20570
977   CONC(LQ,4)=CONC(LQ,4)/DIV24                                       RAM20580
      LL4=4                                                             RAM20590
      IF(ICFL24.EQ.1)LL4=44                                             RAM20600
      CALL RANK(LL4)                                                    RAM20610
      NP24=0                                                            RAM20620
      IDIV24=0                                                          RAM20630
      ICFL24=0                                                          RAM20640
1011  ITMIN1=IDUMR(LH)                                                  RAM20650
      GO TO 1570                                                        RAM20660
C                                                                       RAM20670
C        WHEN DEFAULT OPTION IS NOT USED, DETERMINE ENTRY INTO          RAM20680
C        SUBROUTINE RANK FOR APPROPRIATE AVERAGING PERIOD.              RAM20690
C        RANKING BASED ON HIGH AVERAGING PERIOD SUM.                    RAM20700
C                                                                       RAM20710
979   CALL RANK (1)                                                     RAM20720
      NP3=NP3+1                                                         RAM20730
      IF (NP3.NE.3) GO TO 1540                                          RAM20740
      CALL RANK (2)                                                     RAM20750
      NP3=0                                                             RAM20760
1540  NP8=NP8+1                                                         RAM20770
      IF (NP8.NE.8) GO TO 1550                                          RAM20780
      CALL RANK (3)                                                     RAM20790
      NP8=0                                                             RAM20800
1550  NP24=NP24+1                                                       RAM20810
      IF (NP24.NE.24) GO TO 1560                                        RAM20820
      CALL RANK (4)                                                     RAM20830
      NP24=0                                                            RAM20840
1560  IF (NAVT.EQ.4) GO TO 1570                                         RAM20850
      NPX=NPX+1                                                         RAM20860
      IF (NPX.NE.NAV5) GO TO 1570                                       RAM20870
      CALL RANK (5)                                                     RAM20880
      NPX=0                                                             RAM20890
C                                                                       RAM20900
C->->->->SECTION V - END HOURLY, AVERAGING TIME, AND DAILY LOOPS.       RAM20910
C                                                                       RAM20920
1570  IF (IOPT(24).EQ.1) GO TO 1580                                     RAM20930
C         IF IOPT(24) = 1,SKIP HOURLY OUTPUT.                           RAM20940
      CALL OUTPT                                                        RAM20950
1580  CONTINUE                                                          RAM20960
C                                                                       RAM20970
C        END OF HOURLY LOOP                                             RAM20980
C                                                                       RAM20990
      IF (NE.GT.24) IDATE(2)=ISTDAY                                     RAM21000
C         DETERMINE AVG.-PER.CONCENTRATIONS.                            RAM21010
      DO 1590 K=1,NRECEP                                                RAM21020
      ACHI(K)=ACHI(K)/NAVG                                              RAM21030
      PCHI(K)=PCHI(K)/NAVG                                              RAM21040
1590  GRANDT(K)=ACHI(K)+PCHI(K)                                         RAM21050
      IF (IOPT(42).EQ.0) GO TO 1600                                     RAM21060
C         WRITE PERIODIC CONC. TO DISK/TAPE- FOR LONG-TERM              RAM21070
C         APPLICATION. THIS STATEMENT WILL GENERATE 'NPER' RECORDS      RAM21080
      WRITE (13) IDATE(2),NE,(GRANDT(K),K=1,NRECEP)                     RAM21090
1600  IF (IOPT(43).EQ.0) GO TO 1620                                     RAM21100
C         PUNCH AVG.-PER. CONC. CARDS (ONE FOR EACH RECEPTOR).          RAM21110
      DO 1610 K=1,NRECEP                                                RAM21120
      GWU=GRANDT(K)*1.0E+06                                             RAM21130
      A=ACHI(K)*1.0E+06                                                 RAM21140
      B=PCHI(K)*1.0E+06                                                 RAM21150
      WRITE (1,2090) RREU(K),SREU(K),GWU,A,B,K,IDATE,NE,NAVG            RAM21160
1610  CONTINUE                                                          RAM21170
C        OUTPUT AVG.-PER. RESULTS                                       RAM21180
1620  IF (IOPT(32).EQ.1) GO TO 1630                                     RAM21190
      CALL OUTAV                                                        RAM21200
1630  NP=NP+1                                                           RAM21210
      NHRS=NHRS+NAVG                                                    RAM21220
C        NEXT STATEMENT IS BRANCH FOR END OF RUN.                       RAM21230
      IF (NP.GE.NPER) GO TO 1660                                        RAM21240
      IF (NHRS.LT.24) GO TO 1640                                        RAM21250
      IF (IOPT(39).EQ.0) GO TO 1150                                     RAM21260
C        NEXT STATEMENT CHECKS FOR END OF SEGMENTED RUN.                RAM21270
      IF (IDAY.GE.LDRUN) GO TO 1650                                     RAM21280
      GO TO 1150                                                        RAM21290
C                                                                       RAM21300
C          END OF LOOP FOR CALENDAR DAYS                                RAM21310
C                                                                       RAM21320
1640  NB=NB+NAVG                                                        RAM21330
      NE=NE+NAVG                                                        RAM21340
      IF (NB.LE.24) GO TO 1200                                          RAM21350
      NB=MOD(NB,24)                                                     RAM21360
      NE=NB+NAVG-1                                                      RAM21370
      GO TO 1200                                                        RAM21380
C                                                                       RAM21390
C        END OF LOOP FOR AVERAGING PERIOD.                              RAM21400
C                                                                       RAM21410
C        IF SEGMENTED RUN, TEMPORARILY STORE                            RAM21420
C         HIGH-FIVE INFO ON UNIT 14 FILE.                               RAM21430
1650  WRITE (14) IDAY,SUM,NHR,DAY1A,HR1,HMAXA,NDAY,IHR                  RAM21440
      WRITE (IO,2620) IDAY                                              RAM21450
      GO TO 1750                                                        RAM21460
1660  IF (IOPT(36).EQ.1) GO TO 1750                                     RAM21470
C                                                                       RAM21480
C->->->->SECTION W - WRITE AVERAGE CONC. AND HIGH-FIVE TABLES.          RAM21490
C                                                                       RAM21500
C        IF OPTION 36 = 0, WRITE AVERAGE CONCENTRATION.                 RAM21510
C         FOR LENGTH OF RECORD AND HIGH-FIVE TABLE.                     RAM21520
      DO 1670 J=1,NRECEP                                                RAM21530
      STAR(1,J)=BLNK                                                    RAM21540
      STAR(2,J)=BLNK                                                    RAM21550
1670  CONTINUE                                                          RAM21560
      WRITE (IO,2630) LINE1,LINE2,LINE3                                 RAM21570
      HR2=NE                                                            RAM21580
C        FOR DEFAULT OPTION CALCULATE AND REPORT THE                    RAM21590
C        NUMBER OF CALMS FOR AVERAGING PERIOD.                          RAM21600
      IF(IOPT(38).EQ.1)THEN                                             RAM21610
      NHR=NHR-ICALM                                                     RAM21620
      WRITE(6,1761)ICALM                                                RAM21630
      END IF                                                            RAM21640
C         INITIALIZE PERIODIC CONC TO BEGIN RANKING FOR PERIODIC MAX    RAM21650
      SUM(1)=SUM(1)/NHR                                                 RAM21660
      HF=SUM(1)                                                         RAM21670
      ID=1                                                              RAM21680
C         FIND HIGHEST AVERAGE CONC. AMONG RECEPTORS.                   RAM21690
      DO 1680 K=2,NRECEP                                                RAM21700
      SUM(K)=SUM(K)/NHR                                                 RAM21710
      IF (SUM(K).LE.HF) GO TO 1680                                      RAM21720
      ID=K                                                              RAM21730
      HF=SUM(K)                                                         RAM21740
1680  CONTINUE                                                          RAM21750
      STAR(1,ID)=STR                                                    RAM21760
C         WRITE AVERAGE CONC.(HIGHEST HAS ASTERISK).                    RAM21770
      WRITE (IO,2640) DAY1A,HR1,DAY2,HR2                                RAM21780
      DO 1690 K=1,NRECEP                                                RAM21790
1690  WRITE (IO,2650) K,ITYPE(K),ICODE(K),(RNAME(J,K),J=1,2),RREU(K),SRERAM21800
     1U(K),STAR(1,K),SUM(K)                                             RAM21810
      STAR(1,ID)=BLNK                                                   RAM21820
C        LOOP TO WRITE HIGH-FIVE TABLE FOR 4 OR 5 AVG TIMES.            RAM21830
      DO 1740 L=1,NAVT                                                  RAM21840
C        ASTERISKS DEPICT RECEPTORS WITH HIGHEST AND                    RAM21850
C         SECOND HIGHEST CONCENTRATIONS.                                RAM21860
      ID=1                                                              RAM21870
      IQ=1                                                              RAM21880
      A=HMAXA(1,1,L)                                                    RAM21890
      B=HMAXA(2,1,L)                                                    RAM21900
      DO 1710 K=2,NRECEP                                                RAM21910
      IF (HMAXA(1,K,L).LE.A) GO TO 1700                                 RAM21920
      A=HMAXA(1,K,L)                                                    RAM21930
      ID=K                                                              RAM21940
1700  IF (HMAXA(2,K,L).LE.B) GO TO 1710                                 RAM21950
      B=HMAXA(2,K,L)                                                    RAM21960
      IQ=K                                                              RAM21970
1710  CONTINUE                                                          RAM21980
      STAR(1,ID)=STR                                                    RAM21990
      STAR(2,IQ)=STR                                                    RAM22000
C         WRITE HIGH-FIVE TABLE FOR AN AVERAGING TIME.                  RAM22010
      IF((IOPT(38).EQ.1.AND.L.EQ.1).OR.(IOPT(38).NE.1))THEN             RAM22020
      WRITE (IO,2660) NTIME(L),TITLE(IP),(I,I=1,5)                      RAM22030
      END IF                                                            RAM22040
      IF(IOPT(38).EQ.1.AND.L.NE.1)THEN                                  RAM22050
      WRITE (IO,2661) NTIME(L),TITLE(IP),(I,I=1,5)                      RAM22060
      END IF                                                            RAM22070
      ZDUM=ATIME(L)                                                     IBM22080
      DO 1730 K=1,NRECEP                                                RAM22090
C        SET CALM FLAG FOR PRINTING.                                    RAM22100
C        RESET HOUR VARIABLE FOR CALM HOURS.                            RAM22110
      IF(IOPT(38).EQ.1)THEN                                             RAM22120
      DO 1712 J=1,5                                                     RAM22130
      CF(J)=BLNK                                                        RAM22140
      IF(IHR(J,K,L).GT.24)THEN                                          RAM22150
      IHR(J,K,L)=IHR(J,K,L)-100                                         RAM22160
      CF(J)=C                                                           RAM22170
      END IF                                                            RAM22180
1712  CONTINUE                                                          RAM22190
      END IF                                                            RAM22200
      IF(IOPT(38).EQ.1)GO TO 1711                                       RAM22210
C        CALCULATE AVERAGE CONCENTRATIONS WHEN                          RAM22220
C        DEFAULT OPTION IS NOT ON.                                      RAM22230
      DO 1720 J=1,5                                                     RAM22240
1720  HMAXA(J,K,L)=HMAXA(J,K,L)/ZDUM                                    IBM22250
 1711 WRITE (IO,2670) K,RREC(K),SREC(K),(STAR(J,K),HMAXA(J,K,L),CF(J),  RAM22260
     1NDAY(J,K,L),IHR(J,K,L),J=1,2),(HMAXA(J,K,L),CF(J),NDAY(J,K,L),    RAM22270
     2IHR(J,K,L),J=3,5)                                                 RAM22280
1730  CONTINUE                                                          RAM22290
C        INITIALIZE ASTERISK STORAGE TO BLANKS.                         RAM22300
      STAR(1,ID)=BLNK                                                   RAM22310
      STAR(2,IQ)=BLNK                                                   RAM22320
1740  CONTINUE                                                          RAM22330
C                                                                       RAM22340
C->->->->SECTION X - CLOSE OUT FILES.                                   RAM22350
C                                                                       RAM22360
1750  IF (IOPT(40).EQ.0) GO TO 1760                                     RAM22370
      END FILE 10                                                       RAM22380
C     END FILE 10                                                       IBM22390
1760  IF (IOPT(41).EQ.0) GO TO 1770                                     RAM22400
      END FILE 12                                                       RAM22410
C     END FILE 12                                                       IBM22420
1770  IF (IOPT(42).EQ.0) GO TO 1780                                     RAM22430
      END FILE 13                                                       RAM22440
C     END FILE 13                                                       IBM22450
1780  WRITE (IO,2680)                                                   RAM22460
C     CALL WAUDIT
      STOP                                                              RAM22470
C                                                                       RAM22480
C->->->->SECTION Y - FORMAT STATEMENTS.                                 RAM22490
C                                                                       RAM22500
C        INPUT FORMATS                                                  RAM22510
C                                                                       RAM22520
1761  FORMAT(5X,T98,'# CALMS FOR PERIOD: ',I4)                          RAM22530
1790  FORMAT (20A4/20A4/20A4)                                           RAM22540
1800  FORMAT (50I1)                                                     RAM22550
1810  FORMAT (A4)                                                       RAM22560
1820  FORMAT (3A4,8F8.2)                                                RAM22570
1830  FORMAT (3A4,6F10.2)                                               RAM22580
1840  FORMAT (26I3)                                                     RAM22590
1850  FORMAT (2A4,2F10.3)                                               RAM22600
C                                                                       RAM22610
C        ERROR AND WARNING STATEMENT FORMATS                            RAM22620
C                                                                       RAM22630
1860  FORMAT (1X,' NSIGP (THE NO. OF SIGNF POINT SOURCES) WAS FOUND',' TRAM22640
     1O EXCEED THE LIMIT (25).  USER TRIED TO INPUT ',I3,' SOURCES'/'   RAM22650
     2******** EXECUTION TERMINATED  ********')                         RAM22660
1870  FORMAT (1X,'NSIGA(THE NO. OF SIGNIF. AREA SOURCES) WAS FOUND TO ',RAM22670
     1'EXCEED THE LIMIT (10). USER TRIED TO INPUT ',I3,' SOURCES.'/'    RAM22680
     2****EXECUTION TERMINATED   *****')                                RAM22690
1880  FORMAT (' USER TRIED TO INPUT MORE THAN ',I4,' POINT SOURCES. THISRAM22700
     1 GOES BEYOND THE CURRENT PROGRAM DIMENSIONS.')                    RAM22710
1890  FORMAT (' USER TRIED TO INPUT MORE THAN ',I4,' AREA SOURCES. THIS RAM22720
     1GOES BEYOND THE CURRENT PROGRAM DIMENSIONS.')                     RAM22730
1900  FORMAT (' DIMENSIONS TOO SMALL TO HOLD ARRAY ',I3,' BY ',I3)      RAM22740
1910  FORMAT (' AREA SOURCES, UNITS OR SIDE LENGTH SPECIFIED INCORRECTLYRAM22750
     1; ERROR ON EAST MAX BOUNDARY.')                                   RAM22760
1920  FORMAT (' AREA SOURCES, UNITS OR SIDE LENGTH SPECIFIED INCORRECTLYRAM22770
     1; ERROR ON NORTH MAX BOUNDARY.')                                  RAM22780
1930  FORMAT (' SOURCE ',I3,' IS ALREADY LOCATED AT POSITION (',I3,',',IRAM22790
     13,')   CHECK SOURCE ',I3)                                         RAM22800
1940  FORMAT (' AREA ARRAY IS TOO WIDE FOR PAGE SIZE, THEREFORE WILL NOTRAM22810
     1 BE PRINTED')                                                     RAM22820
1950  FORMAT (1H1,'***ERROR---USER TRIED TO SPECIFY ',I4,' SIGNIFICANT SRAM22830
     1OURCES, BUT IS ONLY ALLOWING ',I3,' TOTAL SIGNIFICANT SOURCES IN TRAM22840
     2HIS RUN.',/2X,'   RUN TERMINATED-CHECK INPUT DATA!   ')           RAM22850
1960  FORMAT (' (MPS) THE INPUT SIGNIFICANT SOURCE NUMBER ','WAS FOUND TRAM22860
     1O EQUAL ZERO - USER CHECK INPUT DATA.')                           RAM22870
1970  FORMAT (' THE INPUT LIMIT OF MAX DISTANCE FOR AREA INTEGRATION ','RAM22880
     1 CONVERTS TO ',F10.3,' KM WHICH EXCEEDS STORAGE ','LIMITATIONS. UPRAM22890
     2  T0 116 KM DISTANCES ARE ALLOWED.')                              RAM22900
1980  FORMAT (47H   ERROR IN SPECIFYING SIGNIF. POINT SOURCES   )       RAM22910
1990  FORMAT ('0DISAGREEMENT OF IDENTIFIERS- ',/' SURFACE DATA FROM CARDRAM22920
     1: STATION = ',I5,' YEAR = ',I2,/'              FROM MET FILE: STATRAM22930
     2ION = ',I5,' YEAR = ',I2,/' MIX HT  DATA FROM CARD: STATION = ',I5RAM22940
     3,' YEAR =',I2,/'              FROM MET FILE: STATION = ',I5,' YEARRAM22950
     4 = ',I2)                                                          RAM22960
2000  FORMAT (1X,'****USER EITHER TRIED TO INPUT MORE THAN 180 ','RECEPTRAM22970
     1ORS OR ENDR WAS NOT PLACED AFTER THE LAST RECEPTOR ','CARD   *'/'*RAM22980
     2*******EXECUTION TERMINATED*******')                              RAM22990
2010  FORMAT (1X,'NO RECEPTORS HAVE BEEN CHOSEN')                       RAM23000
2020  FORMAT (1H0,'   DAYS DO NOT MATCH, IDAY = ',I4,', IDAYS = ',I4)   RAM23010
2030  FORMAT ('O RUN TERMINATED . CAN  NOT WRITE FILES (OPTIONS 41, ','0RAM23020
     1R 42)'/1X,'WHEN HAVING RAM GENERATE RECEPTORS FOR EACH AVG-PER','(RAM23030
     2OPTIONS 15,16,OR 17).')                                           RAM23040
2040  FORMAT (' DATE ON MET. TAPE, ',I2,I3,' ,DOES NOT MATCH INTERNAL DARAM23050
     1TE, ',I2,I3)                                                      RAM23060
2050  FORMAT (' HOUR ',I3,' IS NOT PERMITTED. HOURS MUST BE DEFINED BETWRAM23070
     1EEN 1 AND 24')                                                    RAM23080
2060  FORMAT (1X,'NO RECEPTORS HAVE BEEN CHOSEN')                       RAM23090
2070  FORMAT (' DATE BEING PROCESSED IS = ',I8/1X,'DATE OF HOURLY POINT RAM23100
     1EMISSION RECORD IS =',I8/1X,'***PLEASE CHECK EMISSION RECORDS   ')RAM23110
2080  FORMAT (' DATE BEING PROCESSED IS= ',I8/1X,'DATE OF HOURLY AREA EMRAM23120
     1ISSION RECORD IS =',I8/1X,'***PLEASE CHECK EMISSION RECORDS***')  RAM23130
C                                                                       RAM23140
C     PUNCH CARD FORMAT(FOR OUTPUT, OPTION 43)                          RAM23150
C                                                                       RAM23160
2090  FORMAT ('CNTL',1X,5F10.3,5I5)                                     RAM23170
C                                                                       RAM23180
C        OUTPUT FORMATS                                                 RAM23190
C                                                                       RAM23200
2100  FORMAT (1H1,T40,' OUTPUT FROM ',A4,A1,' RAM           (DATED 89213RAM23210
     1)',/)
2110  FORMAT (/1X,20A4/1X,20A4/1X,20A4)                                 RAM23250
2120  FORMAT ('0',T30,'GENERAL INPUT INFORMATION'//2X,'THIS IS THE ',A4,RAM23260
     1A1,' VERSION(81352) OF RAM FOR THE POLLUTANT ',A4,' FOR ',I3,1X,I3RAM23270
     2,'-HOUR PERIODS.'/2X,'CONCENTRATION ESTIMATES BEGIN ON HOUR-',I2,'RAM23280
     3, JULIAN DAY-',I3,', YEAR-19',I2,'.'/1X,' UNITS - THERE ARE ',F14.RAM23290
     47,' USER UNITS(INPUT UNITS) PER SMALLEST AREA SOURCE SQUARE SIDE LRAM23300
     5ENGTH(INTERNAL UNIT)'/2X,'CONONE - THERE ARE',F14.7,' KILOMETERS PRAM23310
     6ER USER UNIT'/2X,'CONTWO - IT IS CALCULATED THAT THERE ARE',F14.7,RAM23320
     7' KILOMETERS PER SMALLEST AREA SOURCE SQUARE SIDE LENGTH(INTERNAL RAM23330
     8UNIT)'/2X,'RECEPTOR HEIGHT IS ',F14.7,' METERS')                  RAM23340
2130  FORMAT (1H0,'THIS RUN WILL NOT CONSIDER ANY POLLUTANT LOSS.')     RAM23350
2140  FORMAT (1H0,' A HALF-LIFE OF ',F10.2,' (SECONDS) HAS BEEN ASSUMED RAM23360
     1 BY THE USER.')                                                   RAM23370
2150  FORMAT (1X,' HIGH-FIVE SUMMARY CONCENTRATION TABLES ','WILL BE OUTRAM23380
     1PUT FOR ',I3,' AVERAGING PERIODS.'/'  AVG TIMES ','OF 1,3,8, AND 2RAM23390
     24 HOURS ARE AUTOMATICALLY DISPLAYED.')                            RAM23400
2160  FORMAT (1X,'THE FIFTH AVERAGING PERIOD FOR THE HIGH ','-FIVE TABLERAM23410
     1S IS ',I3,'HOURS ')                                               RAM23420
2170  FORMAT (1H0,T3,'OPTION  ',T16,'OPTION LIST',T46,'OPTION SPECIFICATRAM23430
     1ION : 0= IGNORE OPTION'/1X,T68,' 1= USE OPTION'/T25,'TECHNICAL OPTRAM23440
     2IONS'/1X,T7,I2,T16,'NO STACK DOWNWASH',T70,I1/1X,T7,I2,T16,'NO GRARAM23450
     3DUAL PLUME RISE.',T70,I1/1X,T7,I2,T16,'USE BOUYANCY INDUCED DISPERRAM23460
     4SION',T70,I1/1X,T7,I2,T16,'NOT USED THIS VERSION',T70,I1)         RAM23470
2180  FORMAT (1H0,T25,'INPUT OPTIONS'/1X,T7,I2,T16,'WILL YOU ','INPUT PORAM23480
     1INT SOURCES?',T70,I1/1X,T7,I2,T16,'WILL YOU INPUT AREA SOURCES?',TRAM23490
     270,I1/1X,T7,I2,T16,'WILL YOU USE EMISSIONS FROM PREVIOUS RUN? (UNIRAM23500
     3T 9)',T70,I1/1X,T7,I2,T16,'MET.DATA ON CARDS? (FROM UNIT',' 11 OTHRAM23510
     4ERWISE)',T70,I1/1X,T7,I2,T16,'READ HOURLY PT. SOURCE'' EMISSIONS (RAM23520
     5UNIT 15).',T70,I1/1X,T7,I2,T16,'READ HOURLY ','AREA SOURCE EMISSIORAM23530
     6NS (UNIT 16).',T70,I1/1X,T7,I2,T16,'SPECIFY   SIGNIF PT. SOURCES.'RAM23540
     7,T70,I1/1X,T7,I2,T16,'SPECIFY SIGNIF. AREA ','SOURCES.',T70,I1/1X,RAM23550
     8T7,I2,T16,'NOT USED THIS VERSION',T70,I1)                         RAM23560
2190  FORMAT (1H0,T25,'RECEPTOR OPTIONS'/1X,T7,I2,T16,'WILL YOU ENTER ',RAM23570
     1'RECEPTORS BY SPECIFYING COORDINATES?',T70,I1/1X,T7,I2,T16,'DO',' RAM23580
     2YOU WANT RAM TO GENERATE RECEPTORS DOWNWIND '/1X,T7,T16,' OF ','SIRAM23590
     3GNIF. PT. SOURCES? (WILL DO SO BY AVG-PERIOD)',T70,I1,/1X,T7,I2,T1RAM23600
     46,'DO YOU WANT RAM TO GENERATE RECEPTORS DOWNWIND '/1X,T7,T16,'OF RAM23610
     5SIGNIF. AREA SOURCES?(WILL DO SO BY AVG-PERIOD)',T70,I1,/1X,T7,I2,RAM23620
     6T16,'DO YOU WANT RAM TO GENERATE A HONEYCOMB ARRAY OF',/1X,T7,T16,RAM23630
     7'RECEPTORS TO COVER A SPECIFIC AREA?',T70,I1/1X,T7,I2,T16,'WILL YORAM23640
     8U INPUT RADIAL DISTANCES(UP TO 5) TO GENERATE ',/1X,T7,T16,'A POLARAM23650
     9R COORDINATE RECEPTOR ARRAY'/1X,T7,T16,'(36 RECEP','TORS FOR EACH RAM23660
     ADISTANCE)',T70,I1/1X,T7,I2,T16,'NOT USED THIS ',' VERSION',T70,I1)RAM23670
2200  FORMAT (1H0,T25,'PRINTED OUTPUT OPTIONS'/1X,T7,I2,T16,'DELETE POI'RAM23680
     1,'NT SOURCE LIST',T70,I1/1X,T7,I2,T16,'DELETE AREA SOURCE LIST A',RAM23690
     2'ND MAP',T70,I1/1X,T7,I2,T16,'DELETE EMISSIONS WITH HEIGHT TABLE',RAM23700
     3T70,I1/1X,T7,I2,T16,'DELETE RESULANT MET. DATA SUMMARY FOR AVE','RRAM23710
     4AGING PERIOD',T70,I1/1X,T7,I2,T16,'DELETE ALL HOURLY OUTPUT ',' (PXXX23720
     5T.,AREA,& SUMMARIES)',T70,I1/1X,T7,I2,T16,'DELETE HOURLY POI','NT RAM23730
     6CONTRIBUTIONS',T70,I1/1X,T7,I2,T16,'DELETE MET. DATA ON HR. ','PT.RAM23740
     7 CONTRIB.',T70,I1/1X,T7,I2,T16,'DELETE PLUME HT. AND DIST. ','TO FRAM23750
     8INAL RISE ON'/1X,T7,T16,'  HR. PT. CONTRIB.',T70,I1/1X,T7,I2,T16,'RAM23760
     9DELETE HOURLY AREA CONTRIBUTIONS',T70,I1/1X,T7,I2,T16,'DELETE MET.RAM23770
     A DATA ON HR. AREA CONTRIB.',T70,I1/1X,T7,I2,T16,'DELETE HOURLY SUMRAM23780
     BMARY.',T70,I1/1X,T7,I2,T16,'DELETE MET. ''DATA ON HOURLY SUMMARY.'RAM23790
     C,T70,I1)                                                          RAM23800
2210  FORMAT (1X,T7,I2,T16,'DELETE ALL AVG-PERIOD OUTPUT.',T70,I1/1X,T7,RAM23810
     1I2,T16,'DELETE POINT AVG-PERIOD CONTRIBUTIONS.',T70,I1/1X,T7,I2,T1RAM23820
     26,'DELETE AREA AVG-PERIOD CONTRIBUTIONS.',T70,I1/1X,T7,I2,T16,'DELRAM23830
     3ETE AVG-PERIOD SUMMARY.',T70,I1/1X,T7,I2,T16,'DELETE AVE','RAGE CORAM23840
     4NCENTRATIONS & HI-FIVE TABLE.',T70,I1/1X,T7,I2,T16,'NOT',' USED THRAM23850
     5IS VERSION.',T70,I1/1X,T25,'DEFAULT OPTION.'/                     RAM23860
     61X,T7,I2,T16,'SET DEFAULT OPTION.',T70,I1)                        RAM23870
2220  FORMAT (1H0,T25,'OTHER CONTROL AND OUTPUT OPTIONS:'/1X,T7,I2,T16,'RAM23880
     1RUN IS PART OF A SEGMENTED RUN.',T70,I1/1X,T7,I2,T16,'WRITE PAR','RAM23890
     2TIAL CONC.TO DISK OR TAPE (UNIT 10).',T70,I1/1X,T7,I2,T16,'WRIT','RAM23900
     3E',' HOURLY CONC.TO DISK OR TAPE (UNIT 12).',T70,I1/1X,T7,I2,T16,'RAM23910
     4WRITE AVG-PERIOD CONC.TO DISK OR TAPE (UNIT 13).',T70,I1/1X,T7,I2,RAM23920
     5T16,'PUNCH AVERAGING-PERIOD CONC. ON CARDS (UNIT 1).',T70,I1/1X,T7RAM23930
     6,I2,T16,'NOT USED THIS VERSION.',T70,I1/1X,T7,I2,T16,'NOT USED',' RAM23940
     7THIS VERSION.',T70,I1/1X,T7,I2,T16,'NOT USED THIS VERSION.',T70,I1RAM23950
     8/1X,T7,I2,T16,'NOT USED THIS VERSION.',T70,I1/1X,T7,I2,T16,'NOT USRAM23960
     9ED THIS VERSION.',T70,I1/1X,T7,I2,T16,'NOT USED THIS ','VERSION.' RAM23970
     A,T70,I1/1X,T7,I2,T16,'NOT USED THIS VERSION.',T70,I1)             RAM23980
2230  FORMAT (1H0,2X,'ANEMOMETER HEIGHT= ',F10.2/3X,'WIND PROFILE WITH 'RAM23990
     1,'HEIGHT EXPONENTS CORRESPONDING TO STABILITY ARE AS FOLLOWS:'/8X,RAM24000
     2'FOR STABILITY A: ',F4.2,3X,', B: ',F4.2,3X,', C: ',F4.2,3X,' D: 'RAM24010
     3,F4.2,3X,' E: ',F4.2,3X,' F: ',F4.2)                              RAM24020
2240  FORMAT ('0',T40,'POINT SOURCE INFORMATION'//1X,T5,'SOURCE',T23,'EARAM24030
     1ST',T32,'NORTH',T40,'SO2(G/SEC)  PART(G/SEC)  STACK  STACK   STACKRAM24040
     2   STACK',3X,'POTEN. IMPACT',2X,'EFF',3X,' BUOY FLUX'/1X,T23,'COORRAM24050
     3D',T32,'COORD','   EMISSIONS   EMISSIONS    HT(M) TEMP(K) DIAM(M)'RAM24060
     4,'VEL(M/SEC)(MICRO G/M**3) HT(M)',3X,'F'/1X,T17,'          (USER URAM24070
     5NITS)',T116,' M**4/S**3')                                         RAM24080
2250  FORMAT (1X,I3,1X,3A4,1X,2F9.3,2F12.3,4F8.2,6PF13.3,0PF9.3,F9.3)   RAM24090
2260  FORMAT ('0',T3,'SIGNIFICANT ',A4,' POINT SOURCES'//1X,T8,'RANK',T2RAM24100
     12,'CHI-MAX',T33,'SOURCE NO.'/1X,T17,'(MICROGRAMS/M**3)'/1X)       RAM24110
2270  FORMAT (1X,T9,I3,T18,6PF12.2,T35,I3)                              RAM24120
2280  FORMAT ('0',T20,'AREA SOURCE INFORMATION'//1X,T2,'SOURCE',T20,' EARAM24130
     1ST',T28,'NORTH',T37,'SO2',T50,'PART',T61,'SIDE',T72,'EFFECTIVE SIGRAM24140
     2NIFICANCE'/1X,T20,'COORD',T28,'COORD',T37,'EMISSIONS',T50,'EMISSIORAM24150
     3NS',T61,'LENGTH',T72,'HEIGHT',T81,'(G/M/SEC)'/1X,T21,'(USER UNITS)RAM24160
     4',T39,'(GRAMS/M**2/SEC) ',T58,'(USER UNITS) (METERS)'/1X)         RAM24170
2290  FORMAT (1X,T2,I3,1X,3A4,2F9.3,1X,2(1X,1PE11.4),2X,0PF6.3,5X,F6.3,2RAM24180
     1X,1PE11.4)                                                        RAM24190
2300  FORMAT ('0',5X,'AREA SOURCE MAP ARRAY (IA)'/1X)                   RAM24200
2310  FORMAT (1X,I3,2X,41I3/1X)                                         RAM24210
2320  FORMAT (/6X,41I3/1X)                                              RAM24220
2330  FORMAT ('0THE ORIGIN IN INTERNAL UNITS IS (',F10.2,',',F10.2,')'/1RAM24230
     1X,'THE SIZE OF THE AREA SOURCE ARRAY IS (',I5,',',I5,')')         RAM24240
2340  FORMAT (' RMIN=',F8.2,' RMAX=',F8.2,' SMIN=',F8.2,' SMAX=',F8.2,' RAM24250
     1  (IN INTERNAL UNITS)')                                           RAM24260
2350  FORMAT ('0',1X,T3,'SIGNIFICANT ',A4,' AREA SOURCES'//1X,T8,'RANK  RAM24270
     1',T20,'Q*LENGTH',T33,'SOURCE NO.'/1X,T19,'(G/M/SEC)'/1X)          RAM24280
2360  FORMAT (1X,T9,I3,T18,1PE12.4,T35,I3)                              RAM24290
2370  FORMAT (1X,'HEIGHT ABOVE 100M FOR POINT SOURCE',I4,3X,' HEIGHT=',FRAM24300
     16.2,' (METERS)','   EMISSIONS=',F10.2,' (G/SEC)')                 RAM24310
2380  FORMAT ('0',4X,'TOTAL ',A4,' EMISSION AND CUMULATIVE FRACTION ACCORAM24320
     1RDING TO HEIGHT'//1X,T12,'TOTAL POINT   CUMULATIVE      TOTAL AREARAM24330
     2    CUMULATIVE'/1X,'HEIGHT(M) EMISSIONS(G/S)  FRACTION      EMISSIRAM24340
     3ONS(G/S)  FRACTION'/1X)                                           RAM24350
2390  FORMAT (1X,T2,I2,' -',I3,T11,F8.2,T26,F7.3,T41,F8.2,T56,F7.3)     RAM24360
2400  FORMAT ('0',T2,'TOTAL',2X,F10.2,T39,F10.2)                        RAM24370
2410  FORMAT (1H0,21X,'ADDITIONAL INFORMATION ON SOURCES.'/1X,T21,'POINTRAM24380
     1 SOURCE INFORMATION'/'0',2X,'EMISSION INFORMATION FOR ',I4,' (NPT)RAM24390
     2 POINT SOUR','CES HAS BEEN INPUT'/2X,I2,' SIGNIFICANT POINT SOURCERAM24400
     3S (NSIGP) ','ARE TO BE USED FOR THIS RUN'/3X)                     RAM24410
2420  FORMAT (1H0,'  USER SPECIFIED ',I3,' (NPT) SIGNIFICANT POINT ','SORAM24420
     1URCES AS LISTED BY POINT SOURCE NUMBER:'/2X,25I5)                 RAM24430
2430  FORMAT (1X,'THE ORDER OF SIGNIFICANCE (IMPS) FOR 25',' OR LESS POIRAM24440
     1NT SOURCES USED IN THIS RUN AS LISTED BY POINT ','SOURCE NUMBER:'/RAM24450
     22X,25I5)                                                          RAM24460
2440  FORMAT (1H0,T21,'AREA SOURCE INFORMATION'//2X,'EMISSION INFORMATIORAM24470
     1N FOR ',I4,' (NAS) AREA SOURCES HAVE BEEN DETERMINED BY RAM'/2X,I2RAM24480
     2,' SIGNIFICANT AREA SOURCES (NSIGA) ARE TO BE USED FOR THIS RUN') RAM24490
2450  FORMAT (2X,'NUMBER OF AREA HEIGHT CLASSES (NHTS)=',I2/2X,'REPRESENRAM24500
     1TATIVE AREA SOURCE HEIGHTS FOR EACH HEIGHT CLASS (HINT) IN METERS RAM24510
     2=',3F10.2)                                                        RAM24520
2460  FORMAT (2X,'BREAK POINT HEIGHT BETWEEN THE AREA HEIGHT CLASSES (BPRAM24530
     1H) IN METERS =',2F10.2)                                           RAM24540
2470  FORMAT (2X,' FRACTION OF AREA SOURCE HEIGHT WHICH IS PHYSICAL HEIGRAM24550
     1HT (FH) =',F10.3/2X,'LIMIT OF DISTANCE FOR AREA SOURCE INTEGRATIONRAM24560
     2 TABLES (XLIM) IN USER UNITS =',F10.3/2X,'BOUNDARIES OF THE AREA 'RAM24570
     3,'SOURCE GRID IN USER UNITS:'/1X,T6,'RMIN=',F10.3,5X,'RMAX=',F10.3RAM24580
     4,5X,'SMIN=',F10.3,5X,'SMAX=',F10.3/2X,'SIZE(IRSIZE X ISSIZE) OF ',RAM24590
     5' AREA SOURCE MAP ARRAY(IA) IN INTERNAL UNITS =',I3,' EAST-WEST ''RAM24600
     6BY ',I3,' NORTH-SOUTH')                                           RAM24610
2480  FORMAT (1H0,'  USER SPECIFIED ',I3,' (NAS) SIGNIFICANT  AREA ','SORAM24620
     1URCES AS LISTED BY  AREA SOURCE NUMBER:'/2X,25I5)                 RAM24630
2490  FORMAT (1X,T21,'THE ORDER OF SIGNIFICANCE (IMAS) FOR 10 OR LESS ',RAM24640
     1' AREA SOURCE IS LISTED BY  AREA SOURCE NUMBER:'/2X,10I5)         RAM24650
2500  FORMAT (1H0,'SURFACE MET DATA FROM STATION(ISFCD) ',I6,', YEAR(ISFRAM24660
     1CYR) 19',I2/2X,'MIXING HEIGHT DATA FROM STATION(IMXD) ',I6,', YEARRAM24670
     2(IMXYR) 19',I2)                                                   RAM24680
2510  FORMAT (1H0,T21,'RECEPTOR INFORMATION')                           RAM24690
2520  FORMAT (1H0,' MPTER INTERNALLY GENERATES 36 RECEPTORS ','ON A CIRCRAM24700
     1LE CORRESPONDING TO EACH NON-ZERO ','RADIAL DISTANCE FROM A CENTERRAM24710
     2 POINT '/1X,T10,'COORDINATES ARE (USER UNITS): (',F8.3,',',F8.3,')RAM24720
     3'/1X,T10,'RADIAL DISTANCE(S) USER SPECIFIED (USER UNITS): ',5(F11.RAM24730
     43,'  '))                                                          RAM24740
2530  FORMAT (F4.1)                                                     RAM24750
2540  FORMAT ('0',' RECEPTOR    IDENTIFICATION  EAST     NORTH          RAM24760
     1'/1X,T30,'COORD',T39,'COORD'/1X,T31,'(USER UNITS)')               RAM24770
2550  FORMAT (1X,T3,I3,1X,A1,8X,2A4,F13.3,F10.3)                        RAM24780
2560  FORMAT (//1X,' THE NUMBER OF   DAYS  PREVIOUSLY COMPLETED EQUAL ',RAM24790
     1I3,' AND THE LAST   DAY  TO BE COMPLETED IN THIS RUN IS ',I3)     RAM24800
2570  FORMAT ('1INPUT MET DATA FOR ',I3,'-HR PERIOD STARTING AT HOUR: ',RAM24810
     1I3,', YEAR',I3,', JULIAN DAY',I4/1X,T2,'HOUR   THETA    SPEED   MIRAM24820
     2XING   TEMP     STABILITY'/1X,T9,'(DEG)    (M/S)  HEIGHT(M) (DEG-KRAM24830
     3)  CLASS'/1X)                                                     RAM24840
2580  FORMAT (1X,T3,I2,4F9.2,6X,I1)                                     RAM24850
2590  FORMAT ('0','RESULTANT MET CONDITIONS'//2X,'WIND DIRECTION=',F7.2,RAM24860
     1T36,'RESULTANT WIND SPEED=',F7.2/2X,'AVERAGE WIND SPEED=',F7.2,T36RAM24870
     2,'AVERAGE TEMP=',F7.2/2X,'WIND PERSISTENCE=',F6.3,T36,'MODAL STABIRAM24880
     3LITY=',I2)                                                        RAM24890
2600  FORMAT ('0',T20,'GENERATED HONEYCOMB RECEPTORS'/1X,/1X,'THE AREA TRAM24900
     1O BE COVERED BY HONEYCOMB RECEPTORS IS BOUNDED BY:'/1X,' RMIN=',F1RAM24910
     20.3,' RMAX=',F10.3,' SMIN=',F10.3,' SMAX=',F10.3//1X,'DISTANCE BETRAM24920
     3WEEN HONEYCOMB RECEPTORS(GRIDSP) IN USER UNITS=',F7.3//1X,'RECEPTORAM24930
     4R       EAST     NORTH')                                          RAM24940
2610  FORMAT ('    PLEASE NOTE: THE RECEPTOR NUMBERS AND LOCATIONS GENERRAM24950
     1ATED FOR THIS AVERAGING TIME PERIOD ARE DIFFERENT FROM THOSE GENERRAM24960
     2ATED FOR'/18X,' THE PRECEEDING AVERAGING PERIOD.   ')             RAM24970
2620  FORMAT (1H0,' THIS SEGMENT OF A SEGMENTED RUN HAS COMPLETED',I5,' RAM24980
     1(IDAY) DAYS.')                                                    RAM24990
2630  FORMAT ('1',20A4/1X,20A4/1X,20A4)                                 RAM25000
2640  FORMAT ('0',T9,'      RECEPTORS'//1X,'RECEPTOR    IDENTIFICATION  RAM25010
     1EAST     NORTH                                          ',T99,'AVGRAM25020
     2 CONC FOR PERIOD'/1X,T30,'COORD',T39,'COORD                       RAM25030
     3            ',T94,'DAY',F4.0,'HR',F3.0,' TO DAY',F4.0,'HR',F3.0/1XRAM25040
     4,T31,'(USER UNITS)                                        ',T100,'RAM25050
     5(MICROGRAMS/M**3)'/1X)                                            RAM25060
2650  FORMAT (1X,T3,I3,1X,A1,I3,5X,2A4,5X,F8.2,2X,F8.2,T110,A1,6PF7.2)  RAM25070
2660  FORMAT (1H1,T29,'FIVE HIGHEST ',I2,'-HOUR ',A4,' CONCENTRATIONS((ERAM25080
     1NDING ON JULIAN DAY, HOUR)'/1X,T55,'(MICROGRAMS/M**3)'//2X,'RECEPTRAM25090
     2OR ',T38,4(I1,20X),I1,/1X)                                        RAM25100
2661  FORMAT (1H1,T29,'FIVE HIGHEST ',I2,'-HOUR ',A4,' CONCENTRATIONS((ERAM25110
     1NDING ON JULIAN DAY, HOUR)'/1X,T55,'(MICROGRAMS/M**3)'/           RAM25120
     21X,T36,'C-FLAG IDENTIFIES CONCENTRATIONS AFFECTED BY CALM HOURS'//RAM25130
     32X,'RECEPTOR ',T38,4(I1,20X),I1,/1X)                              RAM25140
2670  FORMAT (1H ,2X,I3,'(',F7.2,',',F7.2,')',2(1X,A1,6PF9.2,A1,1X,'(',IRAM25150
     13,',',I2,')'),3(2X,6PF9.2,A1,1X,'(',I3,',',I2,')'))               RAM25160
2680  FORMAT ('0 THIS RUN HAS TERMINATED NORMALLY.')                    RAM25170
C                                                                       RAM25180
 2531 FORMAT(F5.1)                                                      IBM
 2532 FORMAT(F5.2)                                                      IBM
 2533 FORMAT(F5.3)                                                      IBM
      END                                                               RAM25190
C
      BLOCK DATA                                                        RAM25210
C                    BLOCK DATA        (VERSION 80336), PART OF RAM.    RAM25220
C               BLOCK DATA FOR RAM                                      RAM25230
C   COEFFICIENTS GENERATED WITH RURAL SIGMAS USING PGSYSZ &PGSZ         RAM25240
C   DIST OF MAX. CONC. FROM PT SOURCE = PXCOR(KST,IH)*H**PXEXR(KST,IH)  RAM25250
C   RELATIVE CONC. NORMALIZED FOR WIND SPEED FROM PT SOURCE, CHI*U/Q, = RAM25260
C        PXUCOR(KST,IH)*H**PXUEXR(KST,IH)                               RAM25270
C   DISTANCE OF MAX. CONC. FROM DOWNWIND EDGE OF AREA SOURCE =          RAM25280
C        AXCOR(KST,IH)*H**AXEXR(KST,IH)                                 RAM25290
C      IH=1 FOR H LESS THAN 20 METERS.                                  RAM25300
C      IH=2 FOR H FROM 20 TO 30 METERS.                                 RAM25310
C      IH=3 FOR H FROM 30 TO 50 METERS.                                 RAM25320
C      IH=4 FOR H FROM 50 TO 70 METERS.                                 RAM25330
C      IH=5 FOR H FROM 70 TO 100 METERS.                                RAM25340
C      IH=6 FOR H FROM 100 TO 200 METERS.                               RAM25350
C      IH=7 FOR H FROM 200 TO 300 METERS.                               RAM25360
C      IH=8 FOR H FROM 300 TO 500 METERS.                               RAM25370
C      IH=9 FOR H GREATER THAN 500 METERS.                              RAM25380
C                                                                       RAM25390
      COMMON /AE/ HC1(10),PXUCOR(6,9),PXUEXR(6,9),PXCOR(6,9),PXEXR(6,9),RAM25400
     1PXUCOF(6,9),PXUEXP(6,9),PXCOF(6,9),PXEXP(6,9),AXCOR(6,9),AXEXR(6,9RAM25410
     2),AXCOF(6,9),AXEXP(6,9)                                           RAM25420
C                                                                       RAM25430
      DATA HC1 /10.,20.,30.,50.,70.,100.,200.,300.,500.,1000./          RAM25440
      DATA PXCOR /.38964E-02,.54607E-02,.75278E-02,.11563E-01,.12743E-01RAM25450
     1,.21051E-01,.59088E-02,.50774E-02,.74442E-02,.87095E-02,.10152E-01RAM25460
     2,.10867E-01,.59366E-02,.67049E-02,.76095E-02,.14437E-01,.79376E-02RAM25470
     3,.10552E-01,.10739E-01,.67199E-02,.75237E-02,.22618E-02,.38170E-02RAM25480
     4,.13053E-02,.14425E-01,.10509E-01,.75283E-02,.22489E-02,.24006E-02RAM25490
     5,.79956E-03,.37139E-01,.10418E-01,.75363E-02,.17287E-02,.15400E-02RAM25500
     6,.14422E-03,.51107E-01,.10468E-01,.75324E-02,.12670E-02,.13842E-03RAM25510
     7,.43952E-09,.50921E-01,.10472E-01,.75225E-02,.84890E-03,.10930E-06RAM25520
     8,.13979E-02,.50996E-01,.10401E-01,.74961E-02,.19441E-03,.10859E-04RAM25530
     9,.20000E+04/                                                      RAM25540
      DATA PXEXR /.10995E+01,.10757E+01,.10965E+01,.11383E+01,.12469E+01RAM25550
     1,.12577E+01,.96054E+00,.11000E+01,.11002E+01,.12329E+01,.13228E+01RAM25560
     2,.14784E+01,.95916E+00,.10182E+01,.10937E+01,.10843E+01,.13951E+01RAM25570
     3,.14870E+01,.80763E+00,.10176E+01,.10966E+01,.15582E+01,.15823E+01RAM25580
     4,.20212E+01,.73818E+00,.91238E+00,.10965E+01,.15595E+01,.16914E+01RAM25590
     5,.21366E+01,.53282E+00,.91427E+00,.10963E+01,.16166E+01,.17878E+01RAM25600
     6,.25085E+01,.47257E+00,.91337E+00,.10964E+01,.16753E+01,.22426E+01RAM25610
     7,.49057E+01,.47321E+00,.91331E+00,.10966E+01,.17455E+01,.34951E+01RAM25620
     8,.22807E+01,.47297E+00,.91440E+00,.10971E+01,.19827E+01,.27551E+01RAM25630
     9,.00000E+00/                                                      RAM25640
      DATA PXUCOR /.10401E+00,.12133E+00,.14273E+00,.15351E+00,.18855E+0RAM25650
     10,.18668E+00,.77533E-01,.11728E+00,.14120E+00,.18239E+00,.20458E+0RAM25660
     20,.34326E+00,.67228E-01,.10013E+00,.13963E+00,.19162E+00,.38998E+0RAM25670
     30,.76271E+00,.40484E-01,.75308E-01,.13784E+00,.54357E+00,.72550E+0RAM25680
     40,.22936E+01,.28539E-01,.66936E-01,.13615E+00,.52790E+00,.12908E+0RAM25690
     51,.56943E+01,.14792E-01,.65799E-01,.13315E+00,.74832E+00,.28818E+0RAM25700
     61,.40940E+03,.12403E-01,.64321E-01,.12927E+00,.10826E+01,.77020E+0RAM25710
     72,.23011E+05,.12340E-01,.62874E-01,.12546E+00,.15580E+01,.68810E+0RAM25720
     83,.46522E+06,.12245E-01,.60615E-01,.11952E+00,.22517E+01,.42842E+0RAM25730
     93,.00000E+00/                                                     RAM25740
      DATA PXUEXR /-.19460E+01,-.19774E+01,-.20086E+01,-.20742E+01,-.218RAM25750
     122E+01,-.22176E+01,-.18479E+01,-.19661E+01,-.20050E+01,-.21317E+01RAM25760
     2,-.22094E+01,-.24209E+01,-.18060E+01,-.19196E+01,-.20017E+01,-.214RAM25770
     362E+01,-.23991E+01,-.26556E+01,-.16763E+01,-.18468E+01,-.19984E+01RAM25780
     4,-.24128E+01,-.25578E+01,-.29371E+01,-.15940E+01,-.18191E+01,-.199RAM25790
     555E+01,-.24059E+01,-.26934E+01,-.31511E+01,-.14513E+01,-.18153E+01RAM25800
     6,-.19907E+01,-.24817E+01,-.28678E+01,-.40795E+01,-.14181E+01,-.181RAM25810
     711E+01,-.19851E+01,-.25514E+01,-.34879E+01,-.48399E+01,-.14172E+01RAM25820
     8,-.18071E+01,-.19799E+01,-.26152E+01,-.38719E+01,-.53670E+01,-.141RAM25830
     960E+01,-.18012E+01,-.19721E+01,-.26744E+01,-.37956E+01,-.17020E+02RAM25840
     A/                                                                 RAM25850
      DATA AXCOR /.68365E-02,.79134E-02,.11062E-01,.14818E-01,.17234E-01RAM25860
     1,.19793E-01,.92054E-02,.94211E-02,.11254E-01,.13875E-01,.91114E-02RAM25870
     2,.65416E-02,.12311E-01,.11151E-01,.11079E-01,.53876E-02,.48999E-02RAM25880
     3,.17087E-02,.19297E-01,.13824E-01,.11267E-01,.42195E-02,.17526E-02RAM25890
     4,.13715E-03,.32619E-01,.13833E-01,.11119E-01,.30122E-02,.11144E-02RAM25900
     5,.73510E-06,.53524E-01,.13821E-01,.11115E-01,.22334E-02,.20868E-04RAM25910
     6,.28987E-05,.55881E-01,.13920E-01,.11152E-01,.11204E-02,.21361E-05RAM25920
     7,.20000E+04,.55160E-01,.13838E-01,.11153E-01,.61078E-03,.10114E-03RAM25930
     8,.20000E+04,.55799E-01,.13881E-01,.11140E-01,.61554E-03,.20000E+04RAM25940
     9,.20000E+04/                                                      RAM25950
      DATA AXEXR /.10103E+01,.10748E+01,.10960E+01,.12112E+01,.13211E+01RAM25960
     1,.14994E+01,.91095E+00,.10166E+01,.10903E+01,.12332E+01,.15339E+01RAM25970
     2,.18689E+01,.82547E+00,.96699E+00,.10949E+01,.15113E+01,.17163E+01RAM25980
     3,.22636E+01,.71059E+00,.91206E+00,.10906E+01,.15738E+01,.19791E+01RAM25990
     4,.29084E+01,.58703E+00,.91191E+00,.10937E+01,.16531E+01,.20856E+01RAM26000
     5,.41392E+01,.47949E+00,.91210E+00,.10938E+01,.17181E+01,.29494E+01RAM26010
     6,.38412E+01,.47136E+00,.91075E+00,.10932E+01,.18483E+01,.33796E+01RAM26020
     7,.00000E+00,.47363E+00,.91178E+00,.10932E+01,.19546E+01,.27033E+01RAM26030
     8,.00000E+00,.47178E+00,.91129E+00,.10933E+01,.19534E+01,.00000E+00RAM26040
     9,.00000E+00/                                                      RAM26050
C                                                                       RAM26060
C   COEFFICIENTS GENERATED WITH URBAN SIGMAS USING BRSYSZ & BRSZ        RAM26070
C   DIST OF MAX. CONC. FROM PT SOURCE = PXCOF(KST,IH)*H**PXEXP(KST,IH)  RAM26080
C   RELATIVE CONC. NORMALIZED FOR WIND SPEED FROM PT SOURCE, CHI*U/Q, = RAM26090
C        PXUCOF(KST,IH)*H**PXUEXP(KST,IH)                               RAM26100
C   DISTANCE OF MAX. CONC. FROM DOWNWIND EDGE OF AREA SOURCE =          RAM26110
C        AXCOF(KST,IH)*H**AXEXP(KST,IH)                                 RAM26120
C      IH=1 FOR H LESS THAN 20 METERS.                                  RAM26130
C      IH=2 FOR H FROM 20 TO 30 METERS.                                 RAM26140
C      IH=3 FOR H FROM 30 TO 50 METERS.                                 RAM26150
C      IH=4 FOR H FROM 50 TO 70 METERS.                                 RAM26160
C      IH=5 FOR H FROM 70 TO 100 METERS.                                RAM26170
C      IH=6 FOR H FROM 100 TO 200 METERS.                               RAM26180
C      IH=7 FOR H FROM 200 TO 300 METERS.                               RAM26190
C      IH=8 FOR H FROM 300 TO 500 METERS.                               RAM26200
C      IH=9 FOR H GREATER THAN 500 METERS.                              RAM26210
C                                                                       RAM26220
      DATA PXCOF /.29000E-02,.29000E-02,.33389E-02,.49374E-02,.76841E-02RAM26230
     1,.76841E-02,.31586E-02,.31586E-02,.34293E-02,.50285E-02,.65931E-02RAM26240
     2,.65931E-02,.31977E-02,.31977E-02,.36114E-02,.45861E-02,.51435E-02RAM26250
     3,.51435E-02,.34513E-02,.34513E-02,.34298E-02,.43860E-02,.33140E-02RAM26260
     4,.33140E-02,.36196E-02,.36196E-02,.33575E-02,.39506E-02,.19672E-02RAM26270
     5,.19672E-02,.41677E-02,.41677E-02,.32748E-02,.32439E-02,.63291E-03RAM26280
     6,.63291E-03,.50465E-02,.50465E-02,.31556E-02,.21446E-02,.19145E-03RAM26290
     7,.19145E-03,.60289E-02,.60289E-02,.30537E-02,.12214E-02,.12483E-03RAM26300
     8,.12483E-03,.77521E-02,.77521E-02,.29817E-02,.39130E-03,.11337E-03RAM26310
     9,.11337E-03/                                                      RAM26320
      DATA PXEXP /.10000E+01,.10000E+01,.10205E+01,.10141E+01,.10829E+01RAM26330
     1,.10829E+01,.97149E+00,.97149E+00,.10116E+01,.10080E+01,.11340E+01RAM26340
     2,.11340E+01,.96787E+00,.96787E+00,.99634E+00,.10350E+01,.12070E+01RAM26350
     3,.12070E+01,.94836E+00,.94836E+00,.10095E+01,.10465E+01,.13194E+01RAM26360
     4,.13194E+01,.93716E+00,.93716E+00,.10145E+01,.10711E+01,.14421E+01RAM26370
     5,.14421E+01,.90654E+00,.90654E+00,.10200E+01,.11139E+01,.16884E+01RAM26380
     6,.16884E+01,.87043E+00,.87043E+00,.10270E+01,.11920E+01,.19141E+01RAM26390
     7,.19141E+01,.83924E+00,.83924E+00,.10327E+01,.12907E+01,.19890E+01RAM26400
     8,.19890E+01,.79879E+00,.79879E+00,.10365E+01,.14738E+01,.20045E+01RAM26410
     9,.20045E+01/                                                      RAM26420
      DATA PXUCOF /.16808E+00,.16808E+00,.20927E+00,.20378E+00,.18861E+0RAM26430
     10,.18861E+00,.15945E+00,.15945E+00,.20527E+00,.20229E+00,.21253E+0RAM26440
     20,.21253E+00,.14777E+00,.14777E+00,.19871E+00,.20011E+00,.24888E+0RAM26450
     30,.24888E+00,.13262E+00,.13262E+00,.18908E+00,.19685E+00,.30041E+0RAM26460
     40,.30041E+00,.11745E+00,.11745E+00,.17767E+00,.19301E+00,.34521E+0RAM26470
     50,.34521E+00,.91943E-01,.91943E-01,.15327E+00,.18499E+00,.34368E+0RAM26480
     60,.34368E+00,.65533E-01,.65533E-01,.11984E+00,.17445E+00,.23640E+0RAM26490
     70,.23640E+00,.47345E-01,.47345E-01,.89821E-01,.16720E+00,.15537E+0RAM26500
     80,.15537E+00,.29993E-01,.29993E-01,.56100E-01,.16747E+00,.11009E+0RAM26510
     90,.11009E+00/                                                     RAM26520
      DATA PXUEXP /-.19722E+01,-.19722E+01,-.19896E+01,-.19965E+01,-.206RAM26530
     149E+01,-.20649E+01,-.19546E+01,-.19546E+01,-.19831E+01,-.19940E+01RAM26540
     2,-.21047E+01,-.21047E+01,-.19322E+01,-.19322E+01,-.19736E+01,-.199RAM26550
     308E+01,-.21512E+01,-.21512E+01,-.19045E+01,-.19045E+01,-.19609E+01RAM26560
     4,-.19867E+01,-.21993E+01,-.21993E+01,-.18759E+01,-.18759E+01,-.194RAM26570
     562E+01,-.19820E+01,-.22320E+01,-.22320E+01,-.18228E+01,-.18228E+01RAM26580
     6,-.19142E+01,-.19728E+01,-.22310E+01,-.22310E+01,-.17589E+01,-.175RAM26590
     789E+01,-.18677E+01,-.19617E+01,-.21604E+01,-.21604E+01,-.17019E+01RAM26600
     8,-.17019E+01,-.18172E+01,-.19543E+01,-.20868E+01,-.20868E+01,-.162RAM26610
     984E+01,-.16284E+01,-.17414E+01,-.19545E+01,-.20314E+01,-.20314E+01RAM26620
     A/                                                                 RAM26630
      DATA AXCOF /.44505E-02,.44505E-02,.50000E-02,.68776E-02,.10026E-01RAM26640
     1,.10026E-01,.45289E-02,.45289E-02,.50000E-02,.68258E-02,.76276E-02RAM26650
     2,.76276E-02,.47786E-02,.47786E-02,.50000E-02,.63099E-02,.51380E-02RAM26660
     3,.51380E-02,.52938E-02,.52938E-02,.50000E-02,.59067E-02,.29303E-02RAM26670
     4,.29303E-02,.57593E-02,.57593E-02,.50000E-02,.52626E-02,.16889E-02RAM26680
     5,.16889E-02,.68765E-02,.68765E-02,.50000E-02,.39429E-02,.74769E-03RAM26690
     6,.74769E-03,.82988E-02,.82988E-02,.50000E-02,.22800E-02,.39161E-03RAM26700
     7,.39161E-03,.99556E-02,.99556E-02,.50000E-02,.10882E-02,.29900E-03RAM26710
     8,.29900E-03,.12206E-01,.12206E-01,.50000E-02,.28165E-03,.25538E-03RAM26720
     9,.25538E-03/                                                      RAM26730
      DATA AXEXP /.96437E+00,.96437E+00,.10000E+01,.10199E+01,.11356E+01RAM26740
     1,.11356E+01,.95855E+00,.95855E+00,.10000E+01,.10224E+01,.12269E+01RAM26750
     2,.12269E+01,.94276E+00,.94276E+00,.10000E+01,.10455E+01,.13430E+01RAM26760
     3,.13430E+01,.91659E+00,.91659E+00,.10000E+01,.10624E+01,.14866E+01RAM26770
     4,.14866E+01,.89676E+00,.89676E+00,.10000E+01,.10896E+01,.16163E+01RAM26780
     5,.16163E+01,.85826E+00,.85826E+00,.10000E+01,.11523E+01,.17932E+01RAM26790
     6,.17932E+01,.82277E+00,.82277E+00,.10000E+01,.12557E+01,.19153E+01RAM26800
     7,.19153E+01,.79086E+00,.79086E+00,.10000E+01,.13853E+01,.19626E+01RAM26810
     8,.19626E+01,.75807E+00,.75807E+00,.10000E+01,.16028E+01,.19880E+01RAM26820
     9,.19880E+01/                                                      RAM26830
C                                                                       RAM26840
      END                                                               RAM26850
C                                                                       IBM
      BLOCK DATA ONE                                                    IBM
C                                                                       IBM
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,R IBM
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                       IBM
      COMMON /AK/ BPH(2),RMIN,SMIN,RMAX,SMAX,NAS,IRSIZE,ISSIZE,IA(25,25) IBM
     1,IWD,IASIGS(100),NBP                                               IBM
C                                                                        IBM
      DATA IRSIZE,ISSIZE /1,1/                                           IBM
      DATA RMIN,SMIN /99999.,99999./                                     IBM
      DATA IO /6/                                                        IBM
C                                                                        IBM
      END                                                                IBM
      FUNCTION ANGARC(DELM,DELN)                                        RAM26870
C                    FUNCTION ANGARC   (VERSION 80336), PART OF RAM.    RAM26880
C         THIS SUBROUTINE IS REFERRED TO AS B IN THE COMMON STATEMENTS  RAM26890
C        DETERMINES APPROPRIATE ANGLE OF TAN(ANG) = DELM/DELN           RAM26900
C        WHICH IS REQUIRED FOR CALCULATION OF RESULTANT WIND DIRECTION. RAM26910
C        DELM IS THE AVERAGE WIND COMPONENT IN THE EAST DIRECTION.      RAM26920
C        DELN IS THE AVERAGE WIND COMPONENT IN THE NORTH DIRECTION.     RAM26930
C        USES LIBRARY FUNCTION ATAN                                     RAM26940
C                                                                       RAM26950
      IF (DELN) 10,40,80                                                RAM26960
10    IF (DELM) 20,30,20                                                RAM26970
20    ANGARC=57.29578*ATAN(DELM/DELN)+180.                              RAM26980
      RETURN                                                            RAM26990
30    ANGARC=180.                                                       RAM27000
      RETURN                                                            RAM27010
40    IF (DELM) 50,60,70                                                RAM27020
50    ANGARC=270.                                                       RAM27030
      RETURN                                                            RAM27040
60    ANGARC=0.                                                         RAM27050
C     ANGARC=0. INDICATES INDETERMINATE ANGLE                           RAM27060
      RETURN                                                            RAM27070
70    ANGARC=090.                                                       RAM27080
      RETURN                                                            RAM27090
80    IF (DELM) 90,100,110                                              RAM27100
90    ANGARC=57.29578*ATAN(DELM/DELN)+360.                              RAM27110
      RETURN                                                            RAM27120
100   ANGARC=360.                                                       RAM27130
      RETURN                                                            RAM27140
110   ANGARC=57.29578*ATAN(DELM/DELN)                                   RAM27150
      RETURN                                                            RAM27160
C                                                                       RAM27170
      END                                                               RAM27180
C
      SUBROUTINE SYSZ                                                   RAM27200
C                    SUBROUTINE SYSZ   (VERSION 80336), PART OF RAM.    RAM27210
C         THIS SUBROUTINE REFERRED TO AS C IN THE COMMON STATEMENTS     RAM27220
C                                                                       RAM27230
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,RRAM27240
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                      RAM27250
      DIMENSION XA(7), XB(2), XD(5), XE(8), XF(9), AA(8), BA(8), AB(3), RAM27260
     1BB(3), AD(6), BD(6), AE(9), BE(9), AF(10), BF(10)                 RAM27270
      DATA XA /.5,.4,.3,.25,.2,.15,.1/                                  RAM27280
      DATA XB /.4,.2/                                                   RAM27290
      DATA XD /30.,10.,3.,1.,.3/                                        RAM27300
      DATA XE /40.,20.,10.,4.,2.,1.,.3,.1/                              RAM27310
      DATA XF /60.,30.,15.,7.,3.,2.,1.,.7,.2/                           RAM27320
      DATA AA /453.85,346.75,258.89,217.41,179.52,170.22,158.08,122.8/  RAM27330
      DATA BA /2.1166,1.7283,1.4094,1.2644,1.1262,1.0932,1.0542,.9447/  RAM27340
      DATA AB /109.30,98.483,90.673/                                    RAM27350
      DATA BB /1.0971,0.98332,0.93198/                                  RAM27360
      DATA AD /44.053,36.650,33.504,32.093,32.093,34.459/               RAM27370
      DATA BD /0.51179,0.56589,0.60486,0.64403,0.81066,0.86974/         RAM27380
      DATA AE /47.618,35.420,26.970,24.703,22.534,21.628,21.628,23.331,2RAM27390
     14.26/                                                             RAM27400
      DATA BE /0.29592,0.37615,0.46713,0.50527,0.57154,0.63077,0.75660,0RAM27410
     1.81956,0.8366/                                                    RAM27420
      DATA AF /34.219,27.074,22.651,17.836,16.187,14.823,13.953,13.953,1RAM27430
     14.457,15.209/                                                     RAM27440
      DATA BF /0.21716,0.27436,0.32681,0.41507,0.46490,0.54503,0.63227,0RAM27450
     1.68465,0.78407,0.81558/                                           RAM27460
C                                                                       RAM27470
      ASSIGN 10 TO K                                                    RAM27480
      IF (MUOR.EQ.2) ASSIGN 70 TO K                                     RAM27490
      RETURN                                                            RAM27500
C                                                                       RAM27510
      ENTRY SYZ                                                         RAM27520
      GO TO K, (10,70)                                                  RAM27530
C           MCELROY-POOLER URBAN DISPERSION PARAMETERS FROM ST. LOUIS   RAM27540
C             EXPERIMENT AS PUT IN EQUATION FORM BY BRIGGS.             RAM27550
C              XK IS DISTANCE IN KM.                                    RAM27560
C              KST IS PASQUILL STABILITY CLASS.                         RAM27570
C              SY AND SZ ARE IN METERS.                                 RAM27580
C         CONVERT X TO METERS                                           RAM27590
10    XM=1000.*X                                                        RAM27600
      GO TO (20,20,30,40,50,50), KST                                    RAM27610
20    SY=0.32*XM/SQRT(1.+0.0004*XM)                                     RAM27620
      SZ=0.24*XM*SQRT(1.+0.001*XM)                                      RAM27630
      GO TO 60                                                          RAM27640
30    SY=0.22*XM/SQRT(1.+0.0004*XM)                                     RAM27650
      SZ=0.2*XM                                                         RAM27660
      GO TO 60                                                          RAM27670
40    SY=0.16*XM/SQRT(1.+0.0004*XM)                                     RAM27680
      SZ=0.14*XM/SQRT(1.+0.0003*XM)                                     RAM27690
      GO TO 60                                                          RAM27700
50    SY=0.11*XM/SQRT(1.+0.0004*XM)                                     RAM27710
      SZ=0.08*XM/SQRT(1.+0.0015*XM)                                     RAM27720
60    IF (SZ.GT.5000.) SZ=5000.                                         RAM27730
      RETURN                                                            RAM27740
C                                                                       RAM27750
C          PASQUILL-GIFFORD PARAMETERS VALID FOR RURAL CONDITIONS.      RAM27760
C        VERTICAL DISPERSION PARAMETER VALUE, SZ DETERMINED BY          RAM27770
C         SZ = A * X ** B WHERE A AND B ARE FUNCTIONS OF BOTH STABILITY RAM27780
C         AND RANGE OF X.                                               RAM27790
C        HORIZONTAL DISPERSION PARAMETER VALUE, SY DETERMINED BY        RAM27800
C         LOGARITHMIC INTERPOLATION OF PLUME HALF-ANGLE ACCORDING TO    RAM27810
C         DISTANCE AND CALCULATION OF 1/2.15 TIMES HALF-ARC LENGTH.     RAM27820
70    GO TO (80,110,140,150,180,210), KST                               RAM27830
C           STABILITY A                                                 RAM27840
80    TH=(24.167-2.5334*ALOG(X))/57.2958                                RAM27850
      IF (X.GT.3.11) GO TO 240                                          RAM27860
      DO 90 ID=1,7                                                      RAM27870
      IF (X.GE.XA(ID)) GO TO 100                                        RAM27880
90    CONTINUE                                                          RAM27890
      ID=8                                                              RAM27900
100   SZ=AA(ID)*X**BA(ID)                                               RAM27910
      GO TO 260                                                         RAM27920
C        STABILITY B                                                    RAM27930
110   TH=(18.333-1.8096*ALOG(X))/57.2958                                RAM27940
      IF (X.GT.35.) GO TO 240                                           RAM27950
      DO 120 ID=1,2                                                     RAM27960
      IF (X.GE.XB(ID)) GO TO 130                                        RAM27970
120   CONTINUE                                                          RAM27980
      ID=3                                                              RAM27990
130   SZ=AB(ID)*X**BB(ID)                                               RAM28000
      GO TO 250                                                         RAM28010
C        STABILITY C                                                    RAM28020
140   TH=(12.5-1.0857*ALOG(X))/57.2958                                  RAM28030
      SZ=61.141*X**0.91465                                              RAM28040
      GO TO 250                                                         RAM28050
C        STABILITY D                                                    RAM28060
150   TH=(8.3333-0.72382*ALOG(X))/57.2958                               RAM28070
      DO 160 ID=1,5                                                     RAM28080
      IF (X.GE.XD(ID)) GO TO 170                                        RAM28090
160   CONTINUE                                                          RAM28100
      ID=6                                                              RAM28110
170   SZ=AD(ID)*X**BD(ID)                                               RAM28120
      GO TO 250                                                         RAM28130
C        STABILITY E                                                    RAM28140
180   TH=(6.25-0.54287*ALOG(X))/57.2958                                 RAM28150
      DO 190 ID=1,8                                                     RAM28160
      IF (X.GE.XE(ID)) GO TO 200                                        RAM28170
190   CONTINUE                                                          RAM28180
      ID=9                                                              RAM28190
200   SZ=AE(ID)*X**BE(ID)                                               RAM28200
      GO TO 250                                                         RAM28210
C        STABILITY F                                                    RAM28220
210   TH=(4.1667-0.36191*ALOG(X))/57.2958                               RAM28230
      DO 220 ID=1,9                                                     RAM28240
      IF (X.GE.XF(ID)) GO TO 230                                        RAM28250
220   CONTINUE                                                          RAM28260
      ID=10                                                             RAM28270
230   SZ=AF(ID)*X**BF(ID)                                               RAM28280
      GO TO 250                                                         RAM28290
240   SZ=5000.                                                          RAM28300
      GO TO 260                                                         RAM28310
250   IF (SZ.GT.5000.) SZ=5000.                                         RAM28320
260   SY=465.116*X*SIN(TH)/COS(TH)                                      RAM28330
C        465.116 = 1000. (M/KM) / 2.15                                  RAM28340
      RETURN                                                            RAM28350
C                                                                       RAM28360
      END                                                               RAM28370
C
      SUBROUTINE SGZ                                                    RAM28390
C                    SUBROUTINE SGZ    (VERSION 81352), PART OF RAM.    RAM28400
C         THIS SUBROUTINE IS REFERRED TO AS D IN THE COMMON STATEMENTS  RAM28410
C                                                                       RAM28420
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,RRAM28430
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                      RAM28440
      DIMENSION XA(7), XB(2), XD(5), XE(8), XF(9), AA(8), BA(8), AB(3), RAM28450
     1BB(3), AD(6), BD(6), AE(9), BE(9), AF(10), BF(10)                 RAM28460
      DATA XA /.5,.4,.3,.25,.2,.15,.1/                                  RAM28470
      DATA XB /.4,.2/                                                   RAM28480
      DATA XD /30.,10.,3.,1.,.3/                                        RAM28490
      DATA XE /40.,20.,10.,4.,2.,1.,.3,.1/                              RAM28500
      DATA XF /60.,30.,15.,7.,3.,2.,1.,.7,.2/                           RAM28510
      DATA AA /453.85,346.75,258.89,217.41,179.52,170.22,158.08,122.8/  RAM28520
      DATA BA /2.1166,1.7283,1.4094,1.2644,1.1262,1.0932,1.0542,.9447/  RAM28530
      DATA AB /109.30,98.483,90.673/                                    RAM28540
      DATA BB /1.0971,0.98332,0.93198/                                  RAM28550
      DATA AD /44.053,36.650,33.504,32.093,32.093,34.459/               RAM28560
      DATA BD /0.51179,0.56589,0.60486,0.64403,0.81066,0.86974/         RAM28570
      DATA AE /47.618,35.420,26.970,24.703,22.534,21.628,21.628,23.331,2RAM28580
     14.26/                                                             RAM28590
      DATA BE /0.29592,0.37615,0.46713,0.50527,0.57154,0.63077,0.75660,0RAM28600
     1.81956,0.8366/                                                    RAM28610
      DATA AF /34.219,27.074,22.651,17.836,16.187,14.823,13.953,13.953,1RAM28620
     14.457,15.209/                                                     RAM28630
      DATA BF /0.21716,0.27436,0.32681,0.41507,0.46490,0.54503,0.63227,0RAM28640
     1.68465,0.78407,0.81558/                                           RAM28650
C                                                                       RAM28660
      ASSIGN 10 TO K                                                    RAM28670
      IF (MUOR.EQ.2) ASSIGN 70 TO K                                     RAM28680
      RETURN                                                            RAM28690
C                                                                       RAM28700
      ENTRY SIGZ                                                        RAM28710
      GO TO K, (10,70)                                                  RAM28720
C       MCELROY-POOLER URBAN SIGMA Z.                                   RAM28730
C        XM IS DISTANCE IN KM.                                          RAM28740
C        KST IS PASQUILL STABILITY CLASS.                               RAM28750
C        SZ IS IN METERS.                                               RAM28760
C           CONVERT X TO METERS                                         RAM28770
10    XM=1000.*X                                                        RAM28780
      GO TO (20,20,30,40,50,50), KST                                    RAM28790
20    SZ=0.24*XM*SQRT(1.+0.001*XM)                                      RAM28800
      GO TO 60                                                          RAM28810
30    SZ=0.2*XM                                                         RAM28820
      GO TO 60                                                          RAM28830
40    SZ=0.14*XM/SQRT(1.+0.0003*XM)                                     RAM28840
      GO TO 60                                                          RAM28850
50    SZ=0.08*XM/SQRT(1.+0.0015*XM)                                     RAM28860
60    IF (SZ.GT.5000.) SZ=5000.                                         RAM28870
      RETURN                                                            RAM28880
C         PASQUILL-GIFFORD PARAMETER VALID FOR RURAL CONDITIONS.        RAM28890
C        VERTICAL DISPERSION PARAMETER VALUE, SZ DETERMINED BY          RAM28900
C         SZ = A * X ** B WHERE A AND B ARE FUNCTIONS OF BOTH STABILITY RAM28910
C      AND RANGE OF X.                                                  RAM28920
70    GO TO (80,110,140,150,180,210), KST                               RAM28930
C        STABILITY A (10)                                               RAM28940
80    IF (X.GT.3.11) GO TO 240                                          RAM28950
      DO 90 ID=1,7                                                      RAM28960
      IF (X.GE.XA(ID)) GO TO 100                                        RAM28970
90    CONTINUE                                                          RAM28980
      ID=8                                                              RAM28990
100   SZ=AA(ID)*X**BA(ID)                                               RAM29000
      GO TO 260                                                         RAM29010
C        STABILITY B (20)                                               RAM29020
110   IF (X.GT.35.) GO TO 240                                           RAM29030
      DO 120 ID=1,2                                                     RAM29040
      IF (X.GE.XB(ID)) GO TO 130                                        RAM29050
120   CONTINUE                                                          RAM29060
      ID=3                                                              RAM29070
130   SZ=AB(ID)*X**BB(ID)                                               RAM29080
      GO TO 250                                                         RAM29090
C        STABILITY C (30)                                               RAM29100
140   SZ=61.141*X**0.91465                                              RAM29110
      GO TO 250                                                         RAM29120
C        STABILITY D (40)                                               RAM29130
150   DO 160 ID=1,5                                                     RAM29140
      IF (X.GE.XD(ID)) GO TO 170                                        RAM29150
160   CONTINUE                                                          RAM29160
      ID=6                                                              RAM29170
170   SZ=AD(ID)*X**BD(ID)                                               RAM29180
      GO TO 250                                                         RAM29190
C        STABILITY E (50)                                               RAM29200
180   DO 190 ID=1,8                                                     RAM29210
      IF (X.GE.XE(ID)) GO TO 200                                        RAM29220
190   CONTINUE                                                          RAM29230
      ID=9                                                              RAM29240
200   SZ=AE(ID)*X**BE(ID)                                               RAM29250
      GO TO 250                                                         RAM29260
C        STABILITY F (60)                                               RAM29270
210   DO 220 ID=1,9                                                     RAM29280
      IF (X.GE.XF(ID)) GO TO 230                                        RAM29290
220   CONTINUE                                                          RAM29300
      ID=10                                                             RAM29310
230   SZ=AF(ID)*X**BF(ID)                                               RAM29320
      GO TO 250                                                         RAM29330
240   SZ=5000.                                                          RAM29340
      RETURN                                                            RAM29350
250   IF (SZ.GT.5000.) SZ=5000.                                         RAM29360
260   RETURN                                                            RAM29370
C                                                                       RAM29380
      END                                                               RAM29390
C
      SUBROUTINE JMHREC                                                 RAM29410
C                    SUBROUTINE JMHREC (VERSION 80336), PART OF RAM.    RAM29420
C         THIS SUBROUTINE IS REFERRED TO AS E IN THE COMMON STATEMENTS  RAM29430
C        THE PURPOSE OF THIS SUBROUTINE IS TO DETERMINE RECEPTORS FROM  RAM29440
C          SIGNIFICANT SOURCES.                                         RAM29450
C                                                                       RAM29460
      CHARACTER*4 ICHAR,JCHAR,ITYPE
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,RRAM29470
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                      RAM29480
      COMMON /AE/ HC1(10),PXUCOR(6,9),PXUEXR(6,9),PXCOR(6,9),PXEXR(6,9),RAM29490
     1PXUCOF(6,9),PXUEXP(6,9),PXCOF(6,9),PXEXP(6,9),AXCOR(6,9),AXEXR(6,9RAM29500
     2),AXCOF(6,9),AXEXP(6,9)                                           RAM29510
      COMMON /AEFM/ ICODE(180),UNITS,RREU(180),SREU(180)                XXX29520
      COMMON /AEFMC/ ITYPE(180)                                         XXX29525
      COMMON /AEFGKM/ NRECEP,RREC(180),SREC(180),IDATE(2),LH,NPT        RAM29530
      COMMON /AEG/ SOURCE(9,250)                                        RAM29540
      COMMON /AEGIKM/ IPOL,CONTWO,SINT,COST,U,HANE,PL(6)                RAM29550
      COMMON /AEK/ ASORC(6,100)                                         RAM29560
      COMMON /AEM/ NSIGP,MPS(25),NSIGA,MAS(10)                          RAM29570
      DATA ICHAR /'P'/ ,JCHAR /'A'/                                     RAM29580
C                                                                       RAM29590
      ASSIGN 120 TO KNTRL                                               RAM29600
      ASSIGN 190 TO KNTRM                                               RAM29610
      IF (MUOR.EQ.1) GO TO 10                                           RAM29620
      ASSIGN 110 TO KNTRL                                               RAM29630
      ASSIGN 180 TO KNTRM                                               RAM29640
10    RETURN                                                            RAM29650
C                                                                       RAM29660
      ENTRY GREC                                                        RAM29670
      IF (NSIGP.EQ.0) GO TO 150                                         RAM29680
      IF (IOPT(15).EQ.0) GO TO 150                                      RAM29690
      WRITE (IO,270)                                                    RAM29700
C                                                                       RAM29710
C       LOOP ON SIGNIFICANT POINT SOURCES                               RAM29720
C                                                                       RAM29730
      DO 140 IP=1,NSIGP                                                 RAM29740
      X=0.0                                                             RAM29750
      I=MPS(IP)                                                         RAM29760
C       EAST AND NORTH COORDINATES OF THE SOURCE (INTERNAL UNITS)       RAM29770
      RS=SOURCE(1,I)                                                    RAM29780
      SS=SOURCE(2,I)                                                    RAM29790
      Q=SOURCE(IPOL,I)                                                  RAM29800
C       MODIFY WIND SPEED BY POWER LAW PROFILE IN ORDER TO TAKE INTO    RAM29810
C       ACCOUNT THE INCREASE IN WIND SPEED WITH HEIGHT.                 RAM29820
      UPL=U*(SOURCE(5,I)/HANE)**PL(KST)                                 RAM29830
C       CALCULATE BUOYANCY PLUME RISE                                   RAM29840
      TS=SOURCE(6,I)                                                    RAM29850
      IF (TS.GT.TEMP) GO TO 20                                          RAM29860
      HF=SOURCE(5,I)                                                    RAM29870
      GO TO 80                                                          RAM29880
20    F=SOURCE(9,I)*(TS-TEMP)/TS                                        RAM29890
      GO TO (30,30,30,30,50,60), KST                                    RAM29900
30    IF (F.GE.55.) GO TO 40                                            RAM29910
      HF=SOURCE(5,I)+21.425*F**0.75/UPL                                 RAM29920
      GO TO 80                                                          RAM29930
40    HF=SOURCE(5,I)+38.71*F**0.6/UPL                                   RAM29940
      GO TO 80                                                          RAM29950
50    DTHDZ=0.02                                                        RAM29960
      GO TO 70                                                          RAM29970
60    DTHDZ=0.035                                                       RAM29980
70    S=9.80616*DTHDZ/TEMP                                              RAM29990
      HF=SOURCE(5,I)+2.6*(F/(UPL*S))**0.333333                          RAM30000
C       DETERMINE PROPER HEIGHT CLASS                                   RAM30010
80    DO 90 IH=2,10                                                     RAM30020
      IF (HF.LT.(HC1(IH)-.01)) GO TO 100                                RAM30030
90    CONTINUE                                                          RAM30040
      IH=10                                                             RAM30050
100   IS=IH-1                                                           RAM30060
      GO TO KNTRL, (110,120)                                            RAM30070
110   A=PXUCOR(KST,IS)                                                  RAM30080
      B=PXUEXR(KST,IS)                                                  RAM30090
      C=PXCOR(KST,IS)                                                   RAM30100
      D=PXEXR(KST,IS)                                                   RAM30110
      GO TO 130                                                         RAM30120
120   A=PXUCOF(KST,IS)                                                  RAM30130
      B=PXUEXP(KST,IS)                                                  RAM30140
      C=PXCOF(KST,IS)                                                   RAM30150
      D=PXEXP(KST,IS)                                                   RAM30160
C       CALCULATE RELATIVE CONC. NORMALIZED FOR WIND SPEED              RAM30170
130   CONM=A*HF**B*Q/UPL                                                RAM30180
C       CALCULATE DISTANCE TO MAX. CONC. FROM POINT SOURCE.             RAM30190
C        X IN KM.                                                       RAM30200
      X=C*HF**D                                                         RAM30210
C       DO NOT ALLOW  RECEPTORS BEYOND 1000 KM.                         RAM30220
      IF (X.GT.1000.) GO TO 140                                         RAM30230
      NRECEP=NRECEP+2                                                   RAM30240
      IF (NRECEP.GT.180) GO TO 260                                      RAM30250
C                                                                       RAM30260
C       TWO RECEPTORS ARE GENERATED FOR EACH SIGNIFICANT POINT SOURCE.  RAM30270
C         RECEPTORS ARE LOCATED AT A DISTANCE OF X AND AT 2X. X         RAM30280
C         IS THE LOCATION WHERE THE HIGHEST CONCENTRATION FROM THE IP-THRAM30290
C         POINT SOURCE IS EXPECTED. A RECEPTOR IS LOCATED AT A DIST     RAM30300
C         OF 2X TO ALLOW FOR THE INTERSECTION OF PLUMES FROM SEVERAL    RAM30310
C          POINT SOURCES. THE CHARACTERS "A" FOR AREA SOURCE AND "P"    RAM30320
C          FOR POINT SOURCES SIGNIFY WHICH TYPE OF SOURCE CAUSED THE    RAM30330
C          GENERATION OF A SPECIFIC RECEPTOR.                           RAM30340
      K=NRECEP-1                                                        RAM30350
      ITYPE(K)=ICHAR                                                    RAM30360
      ICODE(K)=I                                                        RAM30370
C        CALCULATE EAST AND NORTH COORDINATES(INTERNAL UNITS) OF THE    RAM30380
C         RECEPTOR. SINT AND COST REFER TO THE SINE AND COSINE OF THE   RAM30390
C         RESULTANT WIND DIRECTION.                                     RAM30400
      RREC(K)=RS-X*SINT/CONTWO                                          RAM30410
      SREC(K)=SS-X*COST/CONTWO                                          RAM30420
C         CONVERT TO USER UNITS FOR PRINT OUT.                          RAM30430
      RREU(K)=RREC(K)*UNITS                                             RAM30440
      SREU(K)=SREC(K)*UNITS                                             RAM30450
      WRITE (IO,280) K,ICHAR,I,RREU(K),SREU(K),CONM,X,HF,UPL            RAM30460
      X=2.0*X                                                           RAM30470
      ITYPE(NRECEP)=ICHAR                                               RAM30480
      ICODE(NRECEP)=I                                                   RAM30490
      RREC(NRECEP)=RS-X*SINT/CONTWO                                     RAM30500
      SREC(NRECEP)=SS-X*COST/CONTWO                                     RAM30510
C        CONVERT TO USER UNITS FOR PRINT OUT.                           RAM30520
      RREU(NRECEP)=RREC(NRECEP)*UNITS                                   RAM30530
      SREU(NRECEP)=SREC(NRECEP)*UNITS                                   RAM30540
      WRITE (IO,290) NRECEP,ICHAR,I,RREU(NRECEP),SREU(NRECEP),X,HF,UPL  RAM30550
140   CONTINUE                                                          RAM30560
C                                                                       RAM30570
C        LOOP ON SIGNIFICANT AREA SOURCES                               RAM30580
C      ONE RECEPTOR IS LOCATED ON THE DOWNWIND AZIMUTH FROM THE CENTER  RAM30590
C       OF EACH SIGNIFICANT AREA SOURCE AT A DISTANCE WHERE MAXIMUM     RAM30600
C       CONCENTRATION  IS EXPECTED.                                     RAM30610
C                                                                       RAM30620
150   IF (NSIGA.EQ.0) GO TO 250                                         RAM30630
      IF (IOPT(16).EQ.0) GO TO 250                                      RAM30640
      WRITE (IO,300)                                                    RAM30650
      DO 240 IP=1,NSIGA                                                 RAM30660
      I=MAS(IP)                                                         RAM30670
      WA=ASORC(5,I)                                                     RAM30680
C        LOCATE SOURCE CENTER                                           RAM30690
      RS=ASORC(1,I)+WA                                                  RAM30700
      SS=ASORC(2,I)+WA                                                  RAM30710
      H=ASORC(6,I)                                                      RAM30720
C        DETERMINE HEIGHT CLASS                                         RAM30730
C        IS = 1 FOR H LESS THAN 20 METERS.                              RAM30740
C        IS = 2 FOR H FROM 20 TO 30 METERS.                             RAM30750
C        IS = 3 FOR H FROM 30 TO 50 METERS.                             RAM30760
      DO 160 IH=2,3                                                     RAM30770
      IF (H.LT.HC1(IH)-0.01) GO TO 170                                  RAM30780
160   CONTINUE                                                          RAM30790
      IH=4                                                              RAM30800
170   IS=IH-1                                                           RAM30810
C        CALCULATE DISTANCE(KM) TO MAXIMUM CONCENTRATION.               RAM30820
      GO TO KNTRM, (180,190)                                            RAM30830
180   C=AXCOR(KST,IS)                                                   RAM30840
      D=AXEXR(KST,IS)                                                   RAM30850
      GO TO 200                                                         RAM30860
190   C=AXCOF(KST,IS)                                                   RAM30870
      D=AXEXP(KST,IS)                                                   RAM30880
200   X=C*H**D                                                          RAM30890
C       X IN KM.                                                        RAM30900
      IF (COST.EQ.0.) GO TO 210                                         RAM30910
      A=ABS(WA/COST)                                                    RAM30920
      IF (SINT.EQ.0.) GO TO 220                                         RAM30930
      B=ABS(WA/SINT)                                                    RAM30940
      AB=AMIN1(A,B)                                                     RAM30950
      GO TO 230                                                         RAM30960
210   AB=ABS(WA/SINT)                                                   RAM30970
      GO TO 230                                                         RAM30980
220   AB=A                                                              RAM30990
230   X=X+AB*CONTWO                                                     RAM31000
      NRECEP=NRECEP+1                                                   RAM31010
C        NO MORE THAN 180 RECEPTORS ARE ALLOWED.                        RAM31020
      IF (NRECEP.GT.180) GO TO 260                                      RAM31030
C        DETERMINE RECEPTOR COORDINATES(INTERNAL UNITS)                 RAM31040
      RREC(NRECEP)=RS-X*SINT/CONTWO                                     RAM31050
      SREC(NRECEP)=SS-X*COST/CONTWO                                     RAM31060
      RREU(NRECEP)=RREC(NRECEP)*UNITS                                   RAM31070
      SREU(NRECEP)=SREC(NRECEP)*UNITS                                   RAM31080
      WRITE (IO,280) NRECEP,JCHAR,I,RREU(NRECEP),SREU(NRECEP)           RAM31090
      ITYPE(NRECEP)=JCHAR                                               RAM31100
      ICODE(NRECEP)=I                                                   RAM31110
240   CONTINUE                                                          RAM31120
250   RETURN                                                            RAM31130
260   WRITE (IO,310)                                                    RAM31140
      NRECEP=180                                                        RAM31150
      RETURN                                                            RAM31160
C                                                                       RAM31170
270   FORMAT (1H0,T9,'SIGNIFICANT POINT RECEPTORS'//1X,'RECEPTOR #      RAM31180
     1 EAST     NORTH    PREDICTED MAX CONC.  MAX. DIST  EFF. HT    U(PHRAM31190
     2Y HT)'/1X,T38,'(MICROGRAMS/M**3)',T59,'(KM)',T70,'(M)',T80,'(M/SECRAM31200
     3)'/1X)                                                            RAM31210
280   FORMAT (1X,T2,I3,1X,A1,I3,4X,F9.3,3X,F9.3,4X,6P,F12.2,5X,0P,3F10. RAM31220
     13)
290   FORMAT (1X,T2,I3,1X,A1,I3,4X,F9.3,3X,F9.3,21X,3F10.3)             RAM31230
300   FORMAT (1H0,T9,'SIGNIFICANT AREA SOURCE RECEPTORS'//1X,'RECEPTOR #RAM31240
     1  EAST     NORTH    '//1X)                                        RAM31250
310   FORMAT (' THE MAXIMUM NO. OF RECEPTORS HAS BEEN GENERATED'//1X,' NRAM31260
     1O OTHERS WILL BE ACCEPTED')                                       RAM31270
C                                                                       RAM31280
      END                                                               RAM31290
C
      SUBROUTINE JMHHON                                                 RAM31310
C                    SUBROUTINE JMHHON (VERSION 80336), PART OF RAM.    RAM31320
C         THIS SUBROUTINE IS REFERRED TO AS F IN THE COMMON STATEMENTS  RAM31330
C       THIS ROUTINE GENERATES RECEPTORS IN A HONEYCOMB ARRANGEMENT.    RAM31340
C                                                                       RAM31350
      CHARACTER*4 ICHAR,ITYPE
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,RRAM31360
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                      RAM31370
      COMMON /AEFM/ ICODE(180),UNITS,RREU(180),SREU(180)                XXX31380
      COMMON /AEFMC/ ITYPE(180)                                         XXX31385
      COMMON /AEFGKM/ NRECEP,RREC(180),SREC(180),IDATE(2),LH,NPT        RAM31390
      COMMON /AF/ GRIDSP,HRMIN,HRMAX,HSMIN,HSMAX                        RAM31400
      DIMENSION HCOMBR(250), HCOMBS(250)                                RAM31410
C        THE CHARACTER 'H' IDENTIFIES A RECEPTOR WHICH WAS GENERATED BY RAM31420
C        THIS ROUTINE.                                                  RAM31430
      DATA ICHAR /'H'/                                                  RAM31440
C     DATA IO /6/                                                       IBM31450
C                                                                       RAM31460
C       INITIALIZE SPACING PARAMETER FOR RECEPTOR GENERATION.           RAM31470
C       THE HORIZONTAL LOCATIONS OF ODD AND EVEN ROWS ARE STAGGERED.    RAM31480
C       THE FIRST HORIZONTAL RECEPTOR (EVEN ROW) IS AT A DISTANCE       RAM31490
C       OF .5 GRIDSP FROM THE MINIMUM HORIZONTAL  DISTANCE IN CONTRAST  RAM31500
C        TO A DISTANCE OF GRIDSP FOR ODD ROWS.                          RAM31510
      XINC=GRIDSP*0.5                                                   RAM31520
      YINC=GRIDSP*0.866                                                 RAM31530
      YCD=HSMIN+YINC/2.                                                 RAM31540
      DUM=HRMAX-HRMIN                                                   RAM31550
      NCOLS1=DUM/GRIDSP                                                 RAM31560
      NCOLS2=(DUM+XINC)/GRIDSP                                          RAM31570
      NROWS=(HSMAX-HSMIN)/(2.*YINC)+1.                                  RAM31580
      NBEES=0                                                           RAM31590
      DO 50 J=1,NROWS                                                   RAM31600
C        THE STARTING LOCATION FOR THE GENERATION OF POSSIBLE HONEYCOMB RAM31610
C       RECEPTORS IS THE SOUTH WEST CORNER OF THE DEFINED HONEYCOMB GRIDRAM31620
C        AREA.                                                          RAM31630
      XCD1=HRMIN                                                        RAM31640
      XCD2=HRMIN-XINC                                                   RAM31650
C                                                                       RAM31660
C        GENERATION OF ODD ROWS.                                        RAM31670
C                                                                       RAM31680
C        THE FIRST POINT(ODD ROW) IS LOCATED AT THE DISTANCE OF GRIDSP  RAM31690
C        EAST FROM THE SOUTH WEST CORNER.                               RAM31700
C                                                                       RAM31710
      DO 10 I=1,NCOLS1                                                  RAM31720
      XCD1=XCD1+GRIDSP                                                  RAM31730
      IF (XCD1.GT.HRMAX) GO TO 20                                       RAM31740
      NBEES=NBEES+1                                                     RAM31750
C        NO MORE THAN 250 CANDIDATE RECEPTORS ARE ALLOWED.              RAM31760
      IF (NBEES.GT.250) GO TO 110                                       RAM31770
      HCOMBR(NBEES)=XCD1                                                RAM31780
      HCOMBS(NBEES)=YCD                                                 RAM31790
10    CONTINUE                                                          RAM31800
C      ROWS ARE LOCATED AT A PERPENDICULAR DISTANCE OF .866 TIMES GRIDSPRAM31810
C        ABOVE THE PRECEEDING ROW.                                      RAM31820
20    YCD=YCD+YINC                                                      RAM31830
      IF (YCD.GT.HSMAX) GO TO 60                                        RAM31840
C                                                                       RAM31850
C       GENERATION OF EVEN ROWS                                         RAM31860
C                                                                       RAM31870
      DO 30 I=1,NCOLS2                                                  RAM31880
      XCD2=XCD2+GRIDSP                                                  RAM31890
      IF (XCD2.GT.HRMAX) GO TO 40                                       RAM31900
      NBEES=NBEES+1                                                     RAM31910
      IF (NBEES.GT.250) GO TO 110                                       RAM31920
      HCOMBR(NBEES)=XCD2                                                RAM31930
      HCOMBS(NBEES)=YCD                                                 RAM31940
30    CONTINUE                                                          RAM31950
40    YCD=YCD+YINC                                                      RAM31960
      IF (YCD.GT.HSMAX) GO TO 60                                        RAM31970
50    CONTINUE                                                          RAM31980
C                                                                       RAM31990
C        ELIMINATE POSSIBLE HONEYCOMB RECEPTORS THAT ARE CLOSE TO OTHER RAM32000
C        RECEPTORS.                                                     RAM32010
C                                                                       RAM32020
60    NULIM=NRECEP                                                      RAM32030
      DLIM=XINC*XINC                                                    RAM32040
      DO 90 N=1,NBEES                                                   RAM32050
      RH=HCOMBR(N)                                                      RAM32060
      SH=HCOMBS(N)                                                      RAM32070
C        IF NO PREVIOUS RECEPTORS, THERE WILL BE NO COMPARISONS         RAM32080
      IF (NRECEP.LE.0) GO TO 80                                         RAM32090
      DO 70 M=1,NULIM                                                   RAM32100
      R=RREC(M)                                                         RAM32110
      S=SREC(M)                                                         RAM32120
      DUM1=ABS(R-RH)                                                    RAM32130
      IF (DUM1.GT.XINC) GO TO 70                                        RAM32140
      DUM2=ABS(S-SH)                                                    RAM32150
      IF (DUM2.GT.XINC) GO TO 70                                        RAM32160
      DISQ=DUM1*DUM1+DUM2*DUM2                                          RAM32170
C        IF THE DISTANCE BETWEEN A CURRENT RECEPTOR AND A POSSIBLE      RAM32180
C       HONEYCOMB RECEPTOR IS LESS THAN HALF THE GRIDSPACING,           RAM32190
C        THE POSSIBLE HONEYCOMB RECEPTOR IS DISCARDED.                  RAM32200
      IF (DISQ.LT.DLIM) GO TO 90                                        RAM32210
70    CONTINUE                                                          RAM32220
80    NRECEP=NRECEP+1                                                   RAM32230
C        THE TOTAL NUMBER OF RECEPTORS CAN NOT EXCEED 180.              RAM32240
      IF (NRECEP.GT.180) GO TO 100                                      RAM32250
C        ADD NEW RECEPTOR COORDINATES (INTERNAL UNITS)                  RAM32260
      RREC(NRECEP)=RH                                                   RAM32270
      SREC(NRECEP)=SH                                                   RAM32280
      ITYPE(NRECEP)=ICHAR                                               RAM32290
      ICODE(NRECEP)=0                                                   RAM32300
C         CONVERT TO USER UNITS FOR PRINTOUT.                           RAM32310
      RREU(NRECEP)=RREC(NRECEP)*UNITS                                   RAM32320
      SREU(NRECEP)=SREC(NRECEP)*UNITS                                   RAM32330
      WRITE (IO,120) NRECEP,ICHAR,RREU(NRECEP),SREU(NRECEP)             RAM32340
90    CONTINUE                                                          RAM32350
      RETURN                                                            RAM32360
100   WRITE (IO,130)                                                    RAM32370
      NRECEP=180                                                        RAM32380
      RETURN                                                            RAM32390
110   WRITE (IO,140)                                                    RAM32400
C     CALL WAUDIT
      STOP                                                              RAM32410
C                                                                       RAM32420
120   FORMAT (1X,T3,I3,1X,A1,6X,F9.3,3X,F9.3)                           RAM32430
130   FORMAT (' THE MAXIMUM NO. OF RECEPTORS HAS BEEN GENERATED'/1X,' NORAM32440
     1 OTHERS WILL BE ACCEPTED.')                                       RAM32450
140   FORMAT (' TOO  MANY POSSIBLE HONEYCOMB RECEPTOR LOCATIONS HAVE ','RAM32460
     1BEEN GENERATED. PLEASE REDEFINE BOUNDARIES OR GRID SPACING.')     RAM32470
C                                                                       RAM32480
      END                                                               RAM32490
C
      SUBROUTINE PT                                                     RAM32510
C                    SUBROUTINE PT     (VERSION 80336), PART OF RAM.    RAM32520
C         THIS SUBROUTINE IS REFERRED TO AS G IN THE COMMON STATEMENTS  RAM32530
C      THE PURPOSE OF THIS ROUTINE IS TO CALCULATE CONCENTRATIONS FROM  RAM32540
C      POINT SOURCES.                                                   RAM32550
C                                                                       RAM32560
C->->->->SECTION PT.A - COMMON AND DIMENSION.                           RAM32570
C                                                                       RAM32580
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,RRAM32590
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                      RAM32600
      COMMON /AEFGKM/ NRECEP,RREC(180),SREC(180),IDATE(2),LH,NPT        RAM32610
      COMMON /AEG/ SOURCE(9,250)                                        RAM32620
      COMMON /AEGIKM/ IPOL,CONTWO,SINT,COST,U,HANE,PL(6)                RAM32630
      COMMON /AGK/ PARTC(250)                                           RAM32640
      COMMON /AGM/ PSAV(250),HSAV(250),DH(250),DSAV(250),UPH(250),HPR(25RAM32650
     10),FP(250),PCHI(180),PHCHI(180),PSIGS(180,26),PHSIGS(180,26),IPSIGRAM32660
     2S(250),GRANDT(180)                                                RAM32670
C                                                                       RAM32680
C->->->->SECTION  PT.B - INITIALIZE AND START RECEPTOR LOOP.            RAM32690
C                                                                       RAM32700
C        ZERO EFFECTIVE STACK HEIGHT FOR EACH SOURCE                    RAM32710
C                                                                       RAM32720
C          NPT - THE NUMBER OF POINT SOURCES                            RAM32730
      DO 10 J=1,NPT                                                     RAM32740
C        HSAV WILL BE USED TO STORE THE SOURCE PLUME HEIGHTS.           RAM32750
10    HSAV(J)=0.0                                                       RAM32760
C        LOOP ON RECEPTORS                                              RAM32770
C          NRECEP - THE NUMBER OF RECEPTORS                             RAM32780
      DO 160 K=1,NRECEP                                                 RAM32790
C                                                                       RAM32800
C->->->->SECTION  PT.C - START SOURCES LOOP, CALCULATE                  RAM32810
C                        UPWIND AND CROSSWIND DISTANCES.                RAM32820
C                                                                       RAM32830
      DO 150 J=1,NPT                                                    RAM32840
      PARTC(J)=0.0                                                      RAM32850
C          RQ - EAST COORDINATE OF THE SOURCE                           RAM32860
      RQ=SOURCE(1,J)                                                    RAM32870
C          SQ - NORTH COORDINATE OF THE SOURCE                          RAM32880
      SQ=SOURCE(2,J)                                                    RAM32890
C        DETERMINE UPWIND DISTANCE                                      RAM32900
C        XDUM,YDUM IN INTERNAL UNITS. X,Y IN KM.                        RAM32910
C          RREC - EAST COORDINATE OF THE RECEPTOR                       RAM32920
      XDUM=RQ-RREC(K)                                                   RAM32930
C          SREC - NORTH COORDINATE OF THE RECEPTOR                      RAM32940
      YDUM=SQ-SREC(K)                                                   RAM32950
C        SINT AND COST ARE THE SIN AND COS OF THE WIND DIRECTION        RAM32960
C        CONTWO - MULTIPLIER CONSTANT TO CONVERT USER UNITS TO KM       RAM32970
      X=(YDUM*COST+XDUM*SINT)*CONTWO                                    RAM32980
C         X IS THE UPWIND DISTANCE  OF THE SOURCE FROM THE RECEPTOR.    RAM32990
C        IF X IS NEGATIVE, INDICATING THAT THE SOURCE IS DOWNWIND OF    RAM33000
C        THE RECEPTOR, THE CALCULATION IS TERMINATED ASSUMING NO        RAM33010
C        CONTRIBUTION FROM THAT SOURCE.                                 RAM33020
      IF (X.LE.0.0) GO TO 150                                           RAM33030
C                                                                       RAM33040
C        DETERMINE CROSSWIND DISTANCE                                   RAM33050
C                                                                       RAM33060
      Y=(YDUM*SINT-XDUM*COST)*CONTWO                                    RAM33070
      H=HSAV(J)                                                         RAM33080
C        SKIP PLUME RISE CALCULATION IF EFFECTIVE HT. HAS ALREADY BEEN  RAM33090
C           CALCULATED FOR THIS SOURCE                                  RAM33100
      IF (H.EQ.0.0) GO TO 20                                            RAM33110
      DELH=DH(J)                                                        RAM33120
C                                                                       RAM33130
C->->->->SECTION  PT.D - EXTRAPOLATE WIND SPEED TO STACK TOP            RAM33140
C                        CALCULATE PLUME RISE.                          RAM33150
C                                                                       RAM33160
      GO TO 100                                                         RAM33170
C         MODIFY WIND SPEED BY POWER LAW PROFILE IN ORDER TO TAKE INTO  RAM33180
C        ACCOUNT THE INCREASE OF WIND SPEED WITH HEIGHT.                RAM33190
C        ASSUME WIND MEASUREMENTS ARE REPRESENTATIVE FOR HEIGHT = HANE. RAM33200
C         THT IS THE PHYSICAL STACK HEIGHT                              RAM33210
20    THT=SOURCE(5,J)                                                   RAM33220
C        POINT SOURCE HEIGHT NOT ALLOWED TO BE LESS THAN 1 METER.       RAM33230
      IF (THT.LT.1.) THT=1.                                             RAM33240
C          U - WIND SPEED AT HEIGHT 'HANE'                              RAM33250
C          PL - POWER FOR THE WIND PROFILE                              RAM33260
C          UPL - WIND AT THE PHYSICAL STACK HEIGHT                      RAM33270
      UPL=U*(THT/HANE)**PL(KST)                                         RAM33280
C        WIND SPEED NOT ALLOWED TO BE LESS THAN 1 METER/SEC.            RAM33290
      IF (UPL.LT.1.) UPL=1.                                             RAM33300
C        STORE THE STACK TOP WIND FOR THE JTH SOURCE FOR THIS HOUR      RAM33310
      UPH(J)=UPL                                                        RAM33320
      VS=SOURCE(8,J)                                                    RAM33330
      BUOY=SOURCE(9,J)                                                  RAM33340
      TS=SOURCE(6,J)                                                    RAM33350
C        TEMP- THE AMBIENT AIR TEMPERATURE FOR THIS HOUR                RAM33360
      DELT=TS-TEMP                                                      RAM33370
      F=BUOY*DELT/TS                                                    RAM33380
C         IOPT(9) HOURLY EMISSION INPUT FROM TAPE/DISK?  0=NO, 1=YES.   RAM33390
      IF (IOPT(9).EQ.0) GO TO 30                                        RAM33400
C        MODIFY EXIT VELOCITY AND BUOYANCY BY RATIO OF HOURLY EMISSIONS RAM33410
C        TO AVERAGE EMISSIONS                                           RAM33420
      SCALE=SOURCE(IPOL,J)/PSAV(J)                                      RAM33430
      VS=VS*SCALE                                                       RAM33440
      F=F*SCALE                                                         RAM33450
30    D=SOURCE(7,J)                                                     RAM33460
C        CALCULATE  H PRIME WHICH TAKES INTO ACCOUNT STACK DOWNWASH     RAM33470
C        BRIGGS(1973) PAGE 4                                            RAM33480
      HPRM=THT                                                          RAM33490
C        IF IOPT(1)=1, THEN NO STACK DOWNWASH COMPUTATION               RAM33500
      IF (IOPT(1).EQ.1) GO TO 40                                        RAM33510
      DUM=VS/UPL                                                        RAM33520
      IF (DUM.LT.1.5) HPRM=THT+2.*D*(DUM-1.5)                           RAM33530
C        'HPRM' IS BRIGGS' H-PRIME                                      RAM33540
      IF (HPRM.LT.0.) HPRM=0.                                           RAM33550
40    CONTINUE                                                          RAM33560
C                                                                       RAM33570
C        CALCULATE PLUME RISE AND ADD H PRIME TO OBTAIN EFFECTIVE       RAM33580
C        STACK HEIGHT.                                                  RAM33590
C                                                                       RAM33600
C        PLUME RISE CALCULATION                                         RAM33610
      IF (KST.GT.4) GO TO 60                                            RAM33620
C        PLUME RISE FOR UNSTABLE CONDITIONS                             RAM33630
      IF (TS.LT.TEMP) GO TO 70                                          RAM33640
      IF (F.GE.55.) GO TO 50                                            RAM33650
C        DETERMINE DELTA-T FOR BUOYANCY-MOMENTUM CROSSOVER(F<55)        RAM33660
C        FOUND BY EQUATING BRIGGS(1969) EQ 5.2, P.59 WITH COMBINATION OFRAM33670
C        BRIGGS(1971) EQUATIONS 6 AND 7, PAGE 1031 FOR F<55.            RAM33680
      DTMB=0.0297*TS*VS**0.33333/D**0.66667                             RAM33690
      IF (DELT.LT.DTMB) GO TO 70                                        RAM33700
C        DISTANCE OF FINAL BUOYANT RISE(0.049 IS 14*3.5/1000)           RAM33710
C        BRIGGS(1971) EQN. 7,F<55, AND DIST TO FINAL RISE IS 3.5 XSTAR  RAM33720
C        DISTF IN KILOMETERS                                            RAM33730
      DISTF=0.049*F**0.625                                              RAM33740
C        COMBINATION OF BRIGGS(1971) EQNS. 6 AND 7, PAGE 1031 FOR F<55. RAM33750
      DELH=21.425*F**0.75/UPL                                           RAM33760
      GO TO 90                                                          RAM33770
C        DETERMINE DELTA-T FOR BUOYANCY-MOMENTUM CROSSOVER(F>55)        RAM33780
C        FOUND BY EQUATING BRIGGS(1969) EQ 5.2, P.59 WITH COMBINATION OFRAM33790
C         BRIGGS(1971) EQUATIONS 6 AND 7, PAGE 1031 FOR F>55.           RAM33800
50    DTMB=0.00575*TS*VS**0.66667/D**0.33333                            RAM33810
      IF (DELT.LT.DTMB) GO TO 70                                        RAM33820
C        DISTANCE OF FINAL BUOYANT RISE (0.119 IS 34*3.5/1000)          RAM33830
C        BRIGGS(1971) EQN. 7, F>55, AND DIST TO FINAL RISE IS 3.5 XSTAR.RAM33840
C        DISTF IN KILOMETERS                                            RAM33850
      DISTF=0.119*F**0.4                                                RAM33860
C        COMBINATION OF BRIGGS(1971) EQNS. 6 AND 7, PAGE 1031 FOR F>55. RAM33870
      DELH=38.71*F**0.6/UPL                                             RAM33880
      GO TO 90                                                          RAM33890
C        PLUME RISE FOR STABLE CONDITIONS.                              RAM33900
60    DTHDZ=0.02                                                        RAM33910
      IF (KST.GT.5) DTHDZ=0.035                                         RAM33920
      S=9.80616*DTHDZ/TEMP                                              RAM33930
      IF (TS.LT.TEMP) GO TO 80                                          RAM33940
C        DETERMINE DELTA-T FOR BUOYANCY-MOMENTUM CROSSOVER(STABLE)      RAM33950
C        FOUND BY EQUATING BRIGGS(1975) EQ 59, P. 96 FOR STABLE BUOYANCYRAM33960
C        RISE WITH BRIGGS(1969) EQ 4.28, P. 59 FOR STABLE MOMENTUM RISE.RAM33970
      DTMB=0.019582*TEMP*VS*SQRT(S)                                     RAM33980
      IF (DELT.LT.DTMB) GO TO 80                                        RAM33990
C        STABLE BUOYANT RISE FOR WIND CONDITIONS.(WIND NOT ALLOWED LOW  RAM34000
C        ENOUGH TO REQUIRE STABLE RISE IN CALM CONDITIONS.)             RAM34010
C        BRIGGS(1975) EQ 59, PAGE 96.                                   RAM34020
      DELH=2.6*(F/(UPL*S))**0.333333                                    RAM34030
C        COMBINATION OF BRIGGS(1975) EQ 48 AND EQ 59. NOTE DISTF IN KM. RAM34040
      DISTF=0.0020715*UPL/SQRT(S)                                       RAM34050
      GO TO 90                                                          RAM34060
C        UNSTABLE-NEUTRAL MOMENTUM RISE                                 RAM34070
C        BRIGGS(1969) EQN. 5.2, PAGE 59 NOTE: MOST ACCURATE WHEN VS/U>4;RAM34080
C        TENDS TO OVERESTIMATE RISE WHEN VS/U<4 (SEE BRIGGS(1975) P. 78,RAM34090
C         FIGURE 4.)                                                    RAM34100
70    DELH=3.*VS*D/UPL                                                  RAM34110
      DISTF=0.                                                          RAM34120
      GO TO 90                                                          RAM34130
C        STABLE MOMENTUM RISE                                           RAM34140
80    DHA=3.*VS*D/UPL                                                   RAM34150
C        BRIGGS(1969) EQUATION 4.28, PAGE 59                            RAM34160
      DELH=1.5*(VS*VS*D*D*TEMP/(4.*TS*UPL))**0.333333/S**0.166667       RAM34170
      IF (DHA.LT.DELH) DELH=DHA                                         RAM34180
      DISTF=0.                                                          RAM34190
C        STORE OFF PLUME HEIGHT(ETC.) FOR THIS SOURCE FOR USE WITH      RAM34200
C        OTHER RECEPTORS.                                               RAM34210
90    H=HPRM+DELH                                                       RAM34220
      HSAV(J)=H                                                         RAM34230
      DH(J)=DELH                                                        RAM34240
      DSAV(J)=DISTF                                                     RAM34250
      UPH(J)=UPL                                                        RAM34260
      HPR(J)=HPRM                                                       RAM34270
      FP(J)=F                                                           RAM34280
C        IF SOURCE-RECEPTOR DISTANCE IS GREATER OR EQUAL TO DISTANCE TO RAM34290
C        FINAL RISE, SKIP PLUME RISE CALCULATION AND USE FINAL RISE.    RAM34300
100   IF (X.GE.DSAV(J)) GO TO 110                                       RAM34310
      IF (IOPT(3).EQ.0.AND.IOPT(2).EQ.1) GO TO 110                      RAM34320
C        CALCULATE GRADUAL PLUME RISE IF (1) THE USER SPECIFIES SO,     RAM34330
C        OR (2) USER EMPLOYS CALCULATION OF INITIAL DISPERSION.....     RAM34340
C        IN THIS CASE, USE OF FINAL EFFECTIVE HEIGHT IN THE CALCULATION RAM34350
C        OF DISPERSION COEFFICENTS COULD LEAD TO MISLEADING VALUES SINCERAM34360
C          SIGMA-Y,-Z =  DELTA-H/3.5                                    RAM34370
      DELH=160.*FP(J)**0.333333*X**0.666667/UPH(J)                      RAM34380
C        PLUME RISE FOR DISTANCE X(160 IS 1.6*1000**.67 BECAUSE X IN KM)RAM34390
      IF (DELH.GT.DH(J)) DELH=DH(J)                                     RAM34400
      IF (IOPT(2).EQ.1) GO TO 110                                       RAM34410
C        IF SPECIFYING CALCULATION OF INITIAL DISPERSION BUT ARE NOT    RAM34420
C        SPECIFYING CALCULATION OF GRADUAL PLUME RISE, THEN DO NOT      RAM34430
C        ADD THE NEW GRADUAL DELTA-H TO THE EFFECTIVE HEIGHT. OTHERWISE,RAM34440
C        CHECK THE GRADUAL RISE PLUME HEIGHT WITH FINAL EFFECTIVE HEIGHTRAM34450
C        AND SET THE PLUME HEIGHT TO THE SMALLER OF THE TWO VALUES.     RAM34460
      H=HPR(J)+DELH                                                     RAM34470
C        ADD PLUME RISE TO STACK HEIGHT FOR TOTAL EFFECTIVE STACK HT.   RAM34480
C        END PLUME RISE CALCULATION                                     RAM34490
110   UPL=UPH(J)                                                        RAM34500
C                                                                       RAM34510
C->->->->SECTION  PT.E - CALCULATE THE CONTRIBUTION OF                  RAM34520
C                        ONE SOURCE TO ONE RECEPTOR.                    RAM34530
C                                                                       RAM34540
      IF (KST.GT.4) GO TO 120                                           RAM34550
      IF (H.LT.HL) GO TO 120                                            RAM34560
      PROD=0.                                                           RAM34570
      GO TO 130                                                         RAM34580
C          RCON CALCULATES                                              RAM34590
C         THE RELATIVE CONCENTRATION , CHI/Q (SEC/M**3)                 RAM34600
120   CALL RCON                                                         RAM34610
C        CALCULATE TRAVEL TIME IN KM-SEC/M TO INCLUDE DECAY RATE OF     RAM34620
C        POLLUTANT.                                                     RAM34630
      TT=X/UPL                                                          RAM34640
C        TLOS IN METERS/KM-SEC, SO TT*TLOS IS DIMENSIONLESS             RAM34650
C        INCLUDE THE POLLUTANT LOSS                                     RAM34660
      PROD=RC*SOURCE(IPOL,J)/EXP(TT*TLOS)                               RAM34670
C        IF HAFL IS ZERO, TLOS WILL START AS ZERO AND                   RAM34680
C        RESULT IN NO COMPUTATIION OF POLLUTANT LOSS.                   RAM34690
C        INCREMENT CONCENTRATION AT K-TH RECEPTOR(G/M**3)               RAM34700
C          PCHI - SUM FOR THE AVERAGING TIME AT RECEPTOR K              RAM34710
130   PCHI(K)=PCHI(K)+PROD                                              RAM34720
C          PHCHI - CONCENTRATION FOR THIS HOUR AT RECEPTOR K            RAM34730
      PHCHI(K)=PHCHI(K)+PROD                                            RAM34740
      KSIG=IPSIGS(J)                                                    RAM34750
      IF (KSIG.EQ.0) GO TO 140                                          RAM34760
C        STORE CONCENTRATIONS FROM SIGNIFICANT SOURCES.(G/M**3)         RAM34770
      PSIGS(K,KSIG)=PSIGS(K,KSIG)+PROD                                  RAM34780
      PHSIGS(K,KSIG)=PHSIGS(K,KSIG)+PROD                                RAM34790
      PSIGS(K,26)=PSIGS(K,26)+PROD                                      RAM34800
      PHSIGS(K,26)=PHSIGS(K,26)+PROD                                    RAM34810
140   PARTC(J)=PROD                                                     RAM34820
C                                                                       RAM34830
C->->->->SECTION  PT.F - END SOURCE AND RECEPTOR LOOPS.                 RAM34840
C                                                                       RAM34850
150   CONTINUE                                                          RAM34860
C        END OF LOOP FOR SOURCES                                        RAM34870
C        WRITE PARTIAL CONCENTRATIONS ON DISK(G/M**3)  IF IOPT(40) = 1. RAM34880
      IF (IOPT(40).EQ.0) GO TO 160                                      RAM34890
C        USER PLEASE NOTE: PARTIAL CONC. IN G/M**3, NOT MICROGRAM/M**3  RAM34900
      WRITE (10) IDATE,LH,K,(PARTC(J),J=1,NPT)                          RAM34910
160   CONTINUE                                                          RAM34920
C        END OF LOOP FOR RECEPTORS                                      RAM34930
      RETURN                                                            RAM34940
C                                                                       RAM34950
C***   SECTIONS OF SUBROUTINE PTR.                                      RAM34960
C         SECTION  PT.A -  COMMON AND DIMENSION.                        RAM34970
C         SECTION  PT.B -  INITIALIZE AND START RECEPTOR LOOP.          RAM34980
C         SECTION  PT.C -  START SOURCES LOOP; CALCULATE UPWIND AND     RAM34990
C                           CROSSWIND DISTANCES.                        RAM35000
C         SECTION  PT.D -  EXTRAPOLATE WIND SPEED TO STACK TOP;         RAM35010
C                           CALCULATE PLUME RISE.                       RAM35020
C         SECTION  PT.E -  CALCULATE CONTRIBUTION FROM A SOURCE TO ONE  RAM35030
C                           RECEPTOR.                                   RAM35040
C         SECTION  PT.F -  END SOURCE AND RECEPTOR LOOPS.               RAM35050
C                                                                       RAM35060
      END                                                               RAM35070
C
      SUBROUTINE RCON                                                   RAM35090
C                    SUBROUTINE RCON   (VERSION 80336), PART OF RAM.    RAM35100
C         THIS SUBROUTINE IS REFERRED TO AS H IN THE COMMON STATEMENTS  RAM35110
C                                                                       RAM35120
C->->->->SECTION RCON.A - COMMON.                                       RAM35130
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,RRAM35140
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                      RAM35150
C     DATA IO /6/                                                       IBM35160
C                                                                       RAM35170
C->->->->SECTION RCON.B - EXPLANATIONS AND COMPUTATIONS                 RAM35180
C                        COMMON TO ALL CONDITIONS.                      RAM35190
C                                                                       RAM35200
C  RCON DETERMINES RELATIVE CONCENTRATIONS, CHI/Q, FROM POINT SOURCES.  RAM35210
C         IT CALLS UPON  SYZ  TO OBTAIN STANDARD DEVIATIONS.            RAM35220
C        THE INPUT VARIABLES ARE....                                    RAM35230
C         UPL  WIND SPEED (M/SEC)                                       RAM35240
C         Z    RECEPTOR HEIGHT (M)                                      RAM35250
C         H    EFFECTIVE STACK HEIGHT (M)                               RAM35260
C         HL   MIXING HEIGHT- TOP OF NEUTRAL OR UNSTABLE LAYER(M).      RAM35270
C         X    DISTANCE RECEPTOR IS DOWNWIND OF SOURCE (KM)             RAM35280
C         Y    DISTANCE RECEPTOR IS CROSSWIND FROM SOURCE (KM)          RAM35290
C         KST  STABILITY CLASS                                          RAM35300
C         DELH PLUME RISE(METERS)                                       RAM35310
C        THE OUTPUT VARIABLES ARE....                                   RAM35320
C         SY HORIZONTAL DISPERSION PARAMETER                            RAM35330
C         SZ VERTICAL DISPERSION PARAMETER                              RAM35340
C         RC   RELATIVE CONCENTRATION (SEC/M**3) ,CHI/Q                 RAM35350
C        IO IS OUTPUT UNIT FOR WARNING OUTPUT.                          RAM35360
C        THE FOLLOWING EQUATION IS SOLVED --                            RAM35370
C        RC = (1/(2*PI*UPL*SIGMA Y*SIGMA Z))* (EXP(-0.5*(Y/SIGMA Y)**2))RAM35380
C           (EXP(-0.5*((Z-H)/SIGMA Z)**2) + EXP(-0.5*((Z+H)/SIGMA Z)**2)RAM35390
C             PLUS THE SUM OF THE FOLLOWING 4 TERMS K TIMES (N=1,K) --  RAM35400
C                  FOR NEUTRAL OR UNSTABLE CASES:                       RAM35410
C              TERM 1- EXP(-0.5*((Z-H-2NL)/SIGMA Z)**2)                 RAM35420
C              TERM 2- EXP(-0.5*((Z+H-2NL)/SIGMA Z)**2)                 RAM35430
C              TERM 3- EXP(-0.5*((Z-H+2NL)/SIGMA Z)**2)                 RAM35440
C              TERM 4- EXP(-0.5*((Z+H+2NL)/SIGMA Z)**2)                 RAM35450
C NOTE THAT MIXING HEIGHT- THE TOP OF THE NEUTRAL OR UNSTABLE LAYER-    RAM35460
C HAS A VALUE ONLY FOR STABILITIES 1-4, THAT IS, MIXING HEIGHT,         RAM35470
C THE HEIGHT OF THE NEUTRAL OR UNSTABLE LAYER, DOES NOT EXIST FOR STABLERAM35480
C LAYERS AT THE GROUND SURFACE- STABILITY 5 OR 6.                       RAM35490
C        THE ABOVE EQUATION IS SIMILAR TO EQUATION (5.8) P 36 IN        RAM35500
C         WORKBOOK OF ATMOSPHERIC DISPERSION ESTIMATES WITH THE ADDITIONRAM35510
C         OF THE EXPONENTIAL INVOLVING Y.                               RAM35520
C        IF STABLE, SKIP CONSIDERATION OF MIXING HEIGHT.                RAM35530
      IF (KST.GE.5) GO TO 30                                            RAM35540
C        IF THE SOURCE IS ABOVE THE LID, SET RC = 0., AND RETURN.       RAM35550
      IF (H.GT.HL) GO TO 10                                             RAM35560
      IF (Z-HL) 30,30,20                                                RAM35570
10    IF (Z.LT.HL) GO TO 20                                             RAM35580
      WRITE (IO,260)                                                    RAM35590
20    RC=0.                                                             RAM35600
      RETURN                                                            RAM35610
C        IF X IS LESS THAN 1 METER, SET RC=0. AND RETURN.  THIS AVOIDS  RAM35620
C         PROBLEMS OF INCORRECT VALUES NEAR THE SOURCE.                 RAM35630
30    IF (X.LT.0.001) GO TO 20                                          RAM35640
C        CALL SYZ  TO OBTAIN VALUES FOR SY AND SZ                       RAM35650
      CALL SYZ                                                          RAM35660
C         SY = SIGMA Y, THE STANDARD DEVIATION OF CONCENTRATION IN THE  RAM35670
C          Y-DIRECTION (M)                                              RAM35680
C         SZ = SIGMA Z, THE STANDARD DEVIATION OF CONCENTRATION IN THE  RAM35690
C          Z-DIRECTION (M)                                              RAM35700
C       IF IOPT(3)=1, CONSIDER BUOYANCY INDUCED DISPERSION OF PLUME DUE RAM35710
C         TO TURBULENCE DURING BUOYANT RISE.                            RAM35720
      IF (IOPT(3).EQ.0) GO TO 40                                        RAM35730
      DUM=DELH/3.5                                                      RAM35740
      DUM=DUM*DUM                                                       RAM35750
      SY=SQRT(SY*SY+DUM)                                                RAM35760
      SZ=SQRT(SZ*SZ+DUM)                                                RAM35770
40    C1=1.                                                             RAM35780
      IF (Y.EQ.0.0) GO TO 50                                            RAM35790
      YD=1000.*Y                                                        RAM35800
C        YD IS CROSSWIND DISTANCE IN METERS.                            RAM35810
      DUM=YD/SY                                                         RAM35820
      DUM=0.5*DUM*DUM                                                   RAM35830
      IF (DUM.GE.50.) GO TO 20                                          RAM35840
      C1=EXP(DUM)                                                       RAM35850
50    IF (KST.GT.4) GO TO 60                                            RAM35860
      IF (HL.LT.5000.) GO TO 110                                        RAM35870
C        IF STABLE CONDITION OR UNLIMITED MIXING HEIGHT,                RAM35880
C         USE EQUATION 3.2 IF Z = 0, OR EQ 3.1 FOR NON-ZERO Z.          RAM35890
C         (EQUATION NUMBERS REFER TO WORKBOOK OF ATMOSPHERIC DISPERSION RAM35900
C         ESTIMATES.)                                                   RAM35910
60    C2=2.*SZ*SZ                                                       RAM35920
      IF (Z) 20,70,80                                                   RAM35930
C       NOTE: AN ERRONEOUS NEGATIVE Z WILL RESULT IN ZERO CONCENTRATIONSRAM35940
C                                                                       RAM35950
C->->->->SECTION RCON.C - STABLE OR UNLIMITED MIXING, Z IS ZERO.        RAM35960
C                                                                       RAM35970
70    C3=H*H/C2                                                         RAM35980
      IF (C3.GE.50.) GO TO 20                                           RAM35990
      A2=1./EXP(C3)                                                     RAM36000
C        WADE EQUATION 3.2.                                             RAM36010
      RC=A2/(3.14159*UPL*SY*SZ*C1)                                      RAM36020
      RETURN                                                            RAM36030
C                                                                       RAM36040
C->->->->SECTION RCON.D - STABLE OR UNLIMITED MIXING, Z IS NON-ZERO.    RAM36050
C                                                                       RAM36060
80    A2=0.                                                             RAM36070
      A3=0.                                                             RAM36080
      CA=Z-H                                                            RAM36090
      CB=Z+H                                                            RAM36100
      C3=CA*CA/C2                                                       RAM36110
      C4=CB*CB/C2                                                       RAM36120
      IF (C3.GE.50.) GO TO 90                                           RAM36130
      A2=1./EXP(C3)                                                     RAM36140
90    IF (C4.GE.50.) GO TO 100                                          RAM36150
      A3=1./EXP(C4)                                                     RAM36160
C        WADE EQUATION 3.1.                                             RAM36170
100   RC=(A2+A3)/(6.28318*UPL*SY*SZ*C1)                                 RAM36180
      RETURN                                                            RAM36190
C                                                                       RAM36200
C->->->->SECTION RCON.E - UNSTABLE, ASSURED OF UNIFORM MIXING.          RAM36210
C                                                                       RAM36220
C        IF SIGMA-Z IS GREATER THAN 1.6 TIMES THE MIXING HEIGHT,        RAM36230
C         THE DISTRIBUTION BELOW THE MIXING HEIGHT IS UNIFORM WITH      RAM36240
C         HEIGHT REGARDLESS OF SOURCE HEIGHT OR RECEPTOR HEIGHT BECAUSE RAM36250
C         OF REPEATED EDDY REFLECTIONS FROM THE GROUND AND THE MIXING HTRAM36260
110   IF (SZ/HL.LE.1.6) GO TO 120                                       RAM36270
C        WADE EQUATION 3.5.                                             RAM36280
      RC=1./(2.5066*UPL*SY*HL*C1)                                       RAM36290
      RETURN                                                            RAM36300
C        INITIAL VALUE OF AN SET = 0.                                   RAM36310
C         AN - THE NUMBER OF TIMES THE SUMMATION TERM IS EVALUATED      RAM36320
C               AND ADDED IN.                                           RAM36330
120   AN=0.                                                             RAM36340
      IF (Z) 20,210,130                                                 RAM36350
C                                                                       RAM36360
C->->->->SECTION RCON.F - UNSTABLE, CALCULATE MULTIPLE EDDY             RAM36370
C                        REFLECTIONS, Z IS NON-ZERO.                    RAM36380
C                                                                       RAM36390
C       THE FOLLOWING STATEMENTS  CALCULATE RC, THE RELATIVE CONC.,     RAM36400
C         USING THE EQUATION DISCUSSED ABOVE.  SEVERAL INTERMEDIATE     RAM36410
C         VARIABLES ARE USED TO AVOID REPEATING CALCULATIONS.           RAM36420
C         CHECKS ARE MADE TO BE SURE THAT THE ARGUMENT OF THE           RAM36430
C         EXPONENTIAL FUNCTION IS NEVER GREATER THAN 50 (OR LESS THAN   RAM36440
C         -50).                                                         RAM36450
C        CALCULATE MULTIPLE EDDY REFLECTIONS FOR RECEPTOR HEIGHT Z.     RAM36460
130   A1=1./(6.28318*UPL*SY*SZ*C1)                                      RAM36470
      C2=2.*SZ*SZ                                                       RAM36480
      A2=0.                                                             RAM36490
      A3=0.                                                             RAM36500
      CA=Z-H                                                            RAM36510
      CB=Z+H                                                            RAM36520
      C3=CA*CA/C2                                                       RAM36530
      C4=CB*CB/C2                                                       RAM36540
      IF (C3.GE.50.) GO TO 140                                          RAM36550
      A2=1./EXP(C3)                                                     RAM36560
140   IF (C4.GE.50.) GO TO 150                                          RAM36570
      A3=1./EXP(C4)                                                     RAM36580
150   SUM=0.                                                            RAM36590
      THL=2.*HL                                                         RAM36600
160   AN=AN+1.                                                          RAM36610
      A4=0.                                                             RAM36620
      A5=0.                                                             RAM36630
      A6=0.                                                             RAM36640
      A7=0.                                                             RAM36650
      C5=AN*THL                                                         RAM36660
      CC=CA-C5                                                          RAM36670
      CD=CB-C5                                                          RAM36680
      CE=CA+C5                                                          RAM36690
      CF=CB+C5                                                          RAM36700
      C6=CC*CC/C2                                                       RAM36710
      C7=CD*CD/C2                                                       RAM36720
      C8=CE*CE/C2                                                       RAM36730
      C9=CF*CF/C2                                                       RAM36740
      IF (C6.GE.50.) GO TO 170                                          RAM36750
      A4=1./EXP(C6)                                                     RAM36760
170   IF (C7.GE.50.) GO TO 180                                          RAM36770
      A5=1./EXP(C7)                                                     RAM36780
180   IF (C8.GE.50.) GO TO 190                                          RAM36790
      A6=1./EXP(C8)                                                     RAM36800
190   IF (C9.GE.50.) GO TO 200                                          RAM36810
      A7=1./EXP(C9)                                                     RAM36820
200   T=A4+A5+A6+A7                                                     RAM36830
      SUM=SUM+T                                                         RAM36840
      IF (T.GE.0.01) GO TO 160                                          RAM36850
      RC=A1*(A2+A3+SUM)                                                 RAM36860
      RETURN                                                            RAM36870
C                                                                       RAM36880
C->->->->SECTION RCON.G - UNSTABLE, CALCULATE MULTIPLE EDDY             RAM36890
C                        REFLECTIONS, Z IS ZERO.                        RAM36900
C                                                                       RAM36910
C        CALCULATE MULTIPLE EDDY REFLECTIONS FOR GROUND LEVEL RECEPTOR  RAM36920
C        HEIGHT.                                                        RAM36930
210   A1=1./(6.28318*UPL*SY*SZ*C1)                                      RAM36940
      A2=0.                                                             RAM36950
      C2=2.*SZ*SZ                                                       RAM36960
      C3=H*H/C2                                                         RAM36970
      IF (C3.GE.50.) GO TO 220                                          RAM36980
      A2=2./EXP(C3)                                                     RAM36990
220   SUM=0.                                                            RAM37000
      THL=2.*HL                                                         RAM37010
230   AN=AN+1.                                                          RAM37020
      A4=0.                                                             RAM37030
      A6=0.                                                             RAM37040
      C5=AN*THL                                                         RAM37050
      CC=H-C5                                                           RAM37060
      CE=H+C5                                                           RAM37070
      C6=CC*CC/C2                                                       RAM37080
      C8=CE*CE/C2                                                       RAM37090
      IF (C6.GE.50.) GO TO 240                                          RAM37100
      A4=2./EXP(C6)                                                     RAM37110
240   IF (C8.GE.50.) GO TO 250                                          RAM37120
      A6=2./EXP(C8)                                                     RAM37130
250   T=A4+A6                                                           RAM37140
      SUM=SUM+T                                                         RAM37150
      IF (T.GE.0.01) GO TO 230                                          RAM37160
      RC=A1*(A2+SUM)                                                    RAM37170
      RETURN                                                            RAM37180
C                                                                       RAM37190
C->->->->SECTION RCON.H - FORMAT                                        RAM37200
260   FORMAT (1HO,'BOTH H AND Z ARE ABOVE THE MIXING HEIGHT SO A RELIABLRAM37210
     1E COMPUTATION CAN NOT BE MADE.')                                  RAM37220
C                                                                       RAM37230
C                                                                       RAM37240
C***   SECTIONS OF SUBROUTINE RCON.                                     RAM37250
C         SECTION RCON.A -  COMMON.                                     RAM37260
C         SECTION RCON.B -  EXPLANATIONS AND COMPUTATIONS COMMON TO ALL RAM37270
C                           CONDITIONS.                                 RAM37280
C         SECTION RCON.C -  STABLE OR UNLIMITED MIXING, Z IS ZERO.      RAM37290
C         SECTION RCON.D -  STABLE OR UNLIMITED MIXING, Z IS NON-ZERO.  RAM37300
C         SECTION RCON.E -  UNSTABLE, ASSURED OF UNIFORM MIXING.        RAM37310
C         SECTION RCON.F -  UNSTABLE, CALCULATE MULTIPLE EDDY           RAM37320
C                           REFLECTIONS; Z IS NON-ZERO.                 RAM37330
C         SECTION RCON.G -  UNSTABLE, CALCULATE MULTIPLE EDDY           RAM37340
C                           REFLECTIONS; Z IS ZERO.                     RAM37350
C         SECTION RCON.H -  FORMAT.                                     RAM37360
C                                                                       RAM37370
      END                                                               RAM37380
C
      SUBROUTINE JMH54                                                  RAM37400
C                    SUBROUTINE JMH54  (VERSION 80336), PART OF RAM.    RAM37410
C         THIS SUBROUTINE IS REFERRED TO AS I IN THE COMMON STATEMENTS  RAM37420
C      THE PURPOSE OF THIS ROUTINE IS TO CALCULATE TABLES OF            RAM37430
C      CONCENTRATION NORMALIZED FOR WIND SPEED AND EMISSION RATE        RAM37440
C      FROM AREA SOURCES (CHI*U/Q). SUBROUTINE JMHCZU IS CALLED FOR     RAM37450
C      INTEGRATION OF RELATIVE CONCENTRATION.                           RAM37460
C        INPUT VARIABLES ARE...                                         RAM37470
C         HINT- REPRESENTATIVE HEIGHTS FOR AREA SOURCES                 RAM37480
C         NHTS- NUMBER OF HEIGHT CLASSES                                RAM37490
C         Z- RECEPTOR HEIGHT(M)                                         RAM37500
C         XLIM- DISTANCE LIMIT ON INTEGRATION OF AREA SOURCES(KM)       RAM37510
C         TLOS- PARTIAL COMPUTATION RELATED TO POLLUTANT LOSS           RAM37520
C                                                                       RAM37530
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,RRAM37540
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                      RAM37550
      COMMON /AEGIKM/ IPOL,CONTWO,SINT,COST,U,HANE,PL(6)                RAM37560
      COMMON /AIL/ CIN(3,200),XLIM                                      RAM37570
      COMMON /AIM/ HARE(3)                                              RAM37580
C                                                                       RAM37590
C      CONCENTRATION TABLES ARE GENERATED FOR UP TO 3 HEIGHTS.          RAM37600
      DO 190 IH=1,NHTS                                                  RAM37610
      H=HINT(IH)                                                        RAM37620
      HARE(IH)=H                                                        RAM37630
      IF (FH.EQ.1.) GO TO 10                                            RAM37640
      PHT=FH*H                                                          RAM37650
      UPL=U*(PHT/HANE)**PL(KST)                                         RAM37660
      IF (UPL.LT.1.) UPL=1.                                             RAM37670
      H=((H-PHT)*5.)/UPL+PHT                                            RAM37680
      HARE(IH)=H                                                        RAM37690
      GO TO 20                                                          RAM37700
C      MODIFY WIND SPEED BY POWER LAW PROFILE.                          RAM37710
10    IF (H.LT.1.0) H=1.0                                               RAM37720
      UPL=U*(H/HANE)**PL(KST)                                           RAM37730
      IF (UPL.LT.1.0) UPL=1.0                                           RAM37740
C      ZERO CONCENTRATION ARRAY                                         RAM37750
20    DO 30 J=1,200                                                     RAM37760
30    CIN(IH,J)=0.0                                                     RAM37770
      N=0                                                               RAM37780
      NC=10                                                             RAM37790
      CP=0.0                                                            RAM37800
      CI=0.0                                                            RAM37810
      JD=1                                                              RAM37820
C      DISTANCE IN KM.                                                  RAM37830
      X=0.0                                                             RAM37840
      DELX=0.001                                                        RAM37850
      ID=1                                                              RAM37860
40    CL=CP                                                             RAM37870
      X=X+DELX                                                          RAM37880
C      SUBROUTINE JMHCZ  DETERMINES THE RELATIVE CONCENTRATION AT       RAM37890
C      VARYING DOWNWIND DISTANCES.                                      RAM37900
      CALL JMHCZ                                                        RAM37910
C      CALCULATE TRAVEL TIME IN KM-SEC/M.                               RAM37920
      TT=X/UPL                                                          RAM37930
C      ADJUST RELATIVE CONCENTRATION BY POLLUTANT DECAY RATE.           RAM37940
C      TLOS IN METERS/KM-SEC, SO TT*TLOS IS DIMENSIONLESS.              RAM37950
      CP=RCZ/EXP(TT*TLOS)                                               RAM37960
C      INTEGRATED RELATIVE CONCENTRATION IS DIMENSIONLESS.              RAM37970
C      MULTIPLICATION BY 500. CONVERTS TO METERS AND DIVIDES BY 2.      RAM37980
      CI=500.*DELX*(CL+CP)+CI                                           RAM37990
      GO TO (50,90,120,150,180), JD                                     RAM38000
C      NORMALIZED CONCENTRATIONS ARE STORED IN TABLES FOR VARYING       RAM38010
C      DISTANCES AT VARYING TIME INTERVALS.THE FOLLOWING COMMENTS DETAILRAM38020
C      THE TABLE'S CONSTRUCTION.                                        RAM38030
C      DISTANCE<100M; CALCULATE EVERY 1 M,  STORE EVERY 10 M, 0.01KM.   RAM38040
50    IF (X-0.0993) 60,80,80                                            RAM38050
60    N=N+1                                                             RAM38060
      IF (N.LT.NC) GO TO 40                                             RAM38070
      N=0                                                               RAM38080
70    ID=(100.*X)+0.0008                                                RAM38090
C      STORAGE LOCATIONS 1-9 CONTAIN INTEGRATIONS FOR 10-90 M.          RAM38100
      CIN(IH,ID)=CI                                                     RAM38110
      GO TO 40                                                          RAM38120
C      DISTANCE 100-500M: CHANGE DELX TO 10M; STORE EVERY 10 M, 0.01KM. RAM38130
80    JD=2                                                              RAM38140
      DELX=0.01                                                         RAM38150
      GO TO 70                                                          RAM38160
C      STORAGE LOCATIONS 10-49 CONTAIN INTEGRATIONS FOR 100 M TO 490 M. RAM38170
90    IF (X-0.497) 70,100,100                                           RAM38180
C    DISTANCE 500 -3000M; CHANGE DELX TO 100 M; STORE EVERY 100 M, 0.1KMRAM38190
100   JD=3                                                              RAM38200
      DELX=0.1                                                          RAM38210
110   ID=(10.*X)+45.08                                                  RAM38220
C   STORAGE LOCATIONS 50-74 CONTAIN INTEGRATIONS FOR 500 M TO 2900 M.   RAM38230
      CIN(IH,ID)=CI                                                     RAM38240
      GO TO 40                                                          RAM38250
120   IF (X-2.95) 110,130,130                                           RAM38260
C      DISTANCE 3000-15,000M. ; CHANGE DELX TO 500 M; STORE EVERY 500 M,RAM38270
C       0.5KM.                                                          RAM38280
130   JD=4                                                              RAM38290
      DELX=.5                                                           RAM38300
140   ID=(2.*X)+69.08                                                   RAM38310
C         STORAGE LOCATIONS 75-98 CONTAIN INTEGRATIONS FOR 3000 M TO    RAM38320
C          14.5 KM.                                                     RAM38330
      CIN(IH,ID)=CI                                                     RAM38340
      GO TO 40                                                          RAM38350
150   IF (X-14.95) 140,160,160                                          RAM38360
C         DISTANCE >15,000M.; CHANGE DELX TO 1000M; STORE EVERY 1000 M, RAM38370
C          1KM.                                                         RAM38380
160   JD=5                                                              RAM38390
      DELX=1.                                                           RAM38400
170   ID=X+84.08                                                        RAM38410
C      STORAGE LOCATIONS 99-200 CONTAIN INTEGRATIONS FOR 15 KM TO A     RAM38420
C      MAXIMUM OF 116 KM.                                               RAM38430
      CIN(IH,ID)=CI                                                     RAM38440
      GO TO 40                                                          RAM38450
180   IF (X-XLIM) 170,190,190                                           RAM38460
190   CONTINUE                                                          RAM38470
      RETURN                                                            RAM38480
C                                                                       RAM38490
      END                                                               RAM38500
C
      SUBROUTINE JMHCZ                                                  RAM38520
C                    SUBROUTINE JMHCZ  (VERSION 80336), PART OF RAM.    RAM38530
C         THIS SUBROUTINE IS REFERRED TO AS J IN THE COMMON STATEMENTS  RAM38540
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,RRAM38550
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                      RAM38560
C     DATA IO /6/                                                       IBM38570
C                                                                       RAM38580
C        SUBROUTINE JMHCZ CALCULATES CHI*U/Q, RELATIVE CONCENTRATION    RAM38590
C         NORMALIZED FOR WIND SPEED AND EMISSION RATE, FOR A RECEPTOR   RAM38600
C         DOWNWIND OF A CROSSWIND INFINTE SOURCE (IN UNITS OF: PER METERRAM38610
C        JMHCZ CALLS SUBROUTINE SGZ                                     RAM38620
C        THE INPUT VARIABLES ARE....                                    RAM38630
C         Z    RECEPTOR HEIGHT (M)                                      RAM38640
C         H    EFFECTIVE STACK HEIGHT (M)                               RAM38650
C         HL   MIXING HEIGHT- TOP OF NEUTRAL OR UNSTABLE LAYER(M)       RAM38660
C               (THROUGH COMMON/METCON/)                                RAM38670
C         X    DISTANCE RECEPTOR IS DOWNWIND OF SOURCE (KM)             RAM38680
C         KST  STABILITY CLASS (THROUGH COMMON /METCON/)                RAM38690
C        THE OUTPUT VARIABLES ARE....                                   RAM38700
C        SZ    VERTICAL DISPERSION PARAMTER.                            RAM38710
C        RCZ   RELATIVE CONCENTRATION HAS UNITS OF: PER METER.          RAM38720
C     THE FOLLOWING EQUATION IS SOLVED --                               RAM38730
C        RC = (1/2.5066 *SIGMA Z) * ((EXP(-.05*((Z-H)/SIGMA Z)**2)      RAM38740
C             + (EXP(-0.5*((Z+H)/SIGMA Z)**2))                          RAM38750
C             PLUS THE SUM OF THE FOLLOWING 4 TERMS K TIMES (N=1,K) --  RAM38760
C               FOR NEUTRAL OR UNSTABLE CASES:                          RAM38770
C              TERM 1- EXP(-0.5*((Z-H-2NL)/SIGMA Z)**2)                 RAM38780
C              TERM 2- EXP(-0.5*((Z+H-2NL)/SIGMA Z)**2)                 RAM38790
C              TERM 3- EXP(-0.5*((Z-H+2NL)/SIGMA Z)**2)                 RAM38800
C              TERM 4- EXP(-0.5*((Z+H+2NL)/SIGMA Z)**2)                 RAM38810
C        2.5066 IS THE SQUARE ROOT OF 2 * PI                            RAM38820
C   NOTE THAT MIXING HEIGHT- THE TOP OF THE NEUTRAL OR UNSTABLE LAYER-  RAM38830
C   HAS A VALUE ONLY FOR STABILITIES 1-4, THAT IS, MIXING HEIGHT        RAM38840
C   DOES NOT EXIST FOR STABLE LAYERS AT THE GROUND SURFACE- STABILITY   RAM38850
C   5 OR 6.                                                             RAM38860
C         THE SUBROUTINE  CALCULATES RC, THE RELATIVE CONCENTRATION,    RAM38870
C         USING THE EQUATION DISCUSSED ABOVE.  SEVERAL INTERMEDIATE     RAM38880
C         VARIABLES ARE USED TO AVOID REPEATING CALCULATIONS.           RAM38890
C         CHECKS ARE MADE TO BE SURE THAT THE ARGUMENT OF THE           RAM38900
C         EXPONENTIAL FUNCTION IS NEVER GREATER THAN 50 (OR LESS THAN   RAM38910
C         -50).  IF 'AN' BECOMES GREATER THAN 45, A LINE OF OUTPUT IS   RAM38920
C         PRINTED INFORMING OF THIS.                                    RAM38930
C        IO IS OUTPUT UNIT  FOR OUTPUT                                  RAM38940
C      IF STABLE, SKIP CONSIDERATION OF MIXING HEIGHT.                  RAM38950
      IF (KST.GE.5) GO TO 30                                            RAM38960
C        IF THE SOURCE IS ABOVE THE LID, SET RC = 0., AND RETURN.       RAM38970
      IF (H.GT.HL) GO TO 10                                             RAM38980
      IF (Z-HL) 30,30,20                                                RAM38990
10    IF (Z.LT.HL) GO TO 20                                             RAM39000
      WRITE (IO,240)                                                    RAM39010
20    RCZ=0.                                                            RAM39020
      RETURN                                                            RAM39030
C        IF X IS LESS THAN 1 METER, SET RC=0. AND RETURN.  THIS AVOIDS  RAM39040
C         PROBLEMS OF INCORRECT VALUES NEAR THE SOURCE.                 RAM39050
30    IF (X.LT.0.001) GO TO 20                                          RAM39060
      CALL SIGZ                                                         RAM39070
C         SZ = SIGMA Z, THE STANDARD DEVIATION OF CONCENTRATION IN THE  RAM39080
C         Z-DIRECTION (M)                                               RAM39090
      IF (KST.GT.4) GO TO 40                                            RAM39100
      IF (HL.LT.5000) GO TO 90                                          RAM39110
C        IF STABLE CONDITION OR UNLIMITED MIXING HEIGHT:                RAM39120
40    C2=2.*SZ*SZ                                                       RAM39130
      IF (Z) 20,50,60                                                   RAM39140
C      FOR Z = ZERO:                                                    RAM39150
50    C3=H*H/C2                                                         RAM39160
      IF (C3.GE.50.) GO TO 20                                           RAM39170
      RCZ=2./(2.5066*SZ*EXP(C3))                                        RAM39180
      RETURN                                                            RAM39190
C      FOR NON-ZERO Z:                                                  RAM39200
60    A2=0.                                                             RAM39210
      A3=0.                                                             RAM39220
      CA=Z-H                                                            RAM39230
      CB=Z+H                                                            RAM39240
      C3=CA*CA/C2                                                       RAM39250
      C4=CB*CB/C2                                                       RAM39260
      IF (C3.GE.50.) GO TO 70                                           RAM39270
      A2=1./EXP(C3)                                                     RAM39280
70    IF (C4.GE.50.) GO TO 80                                           RAM39290
      A3=1./EXP(C4)                                                     RAM39300
80    RCZ=(A2+A3)/(2.5066*SZ)                                           RAM39310
      RETURN                                                            RAM39320
C        IF SIGMA-Z IS GREATER THAN 1.6 TIMES THE MIXING HEIGHT,        RAM39330
C         THE DISTRIBUTION BELOW THE MIXING HEIGHT IS UNIFORM WITH      RAM39340
C         HEIGHT REGARDLESS OF SOURCE HEIGHT.                           RAM39350
90    IF (SZ/HL.LE.1.6) GO TO 100                                       RAM39360
      RCZ=1./HL                                                         RAM39370
      RETURN                                                            RAM39380
C        INITIAL VALUE OF AN SET = 0.                                   RAM39390
C         AN   THE NUMBER OF TIMES THE SUMMATION TERM IS EVALUATED      RAM39400
C          AND ADDED IN.                                                RAM39410
100   AN=0.                                                             RAM39420
      IF (Z) 20,190,110                                                 RAM39430
C      NOTE: AN ERRONEOUS NEGATIVE Z WILL RESULT IN ZERO CONCENTRATIONS.RAM39440
C      CALCULATE MULTIPLE EDDY REFLECTIONS FOR ELEVATED RECEPTOR HEIGHT.RAM39450
110   A1=1./(2.5066*SZ)                                                 RAM39460
      C2=2.*SZ*SZ                                                       RAM39470
      A2=0.                                                             RAM39480
      A3=0.                                                             RAM39490
      CA=Z-H                                                            RAM39500
      CB=Z+H                                                            RAM39510
      C3=CA*CA/C2                                                       RAM39520
      C4=CB*CB/C2                                                       RAM39530
      IF (C3.GE.50.) GO TO 120                                          RAM39540
      A2=1./EXP(C3)                                                     RAM39550
120   IF (C4.GE.50.) GO TO 130                                          RAM39560
      A3=1./EXP(C4)                                                     RAM39570
130   SUM=0.                                                            RAM39580
      THL=2.*HL                                                         RAM39590
140   AN=AN+1.                                                          RAM39600
      A4=0.                                                             RAM39610
      A5=0.                                                             RAM39620
      A6=0.                                                             RAM39630
      A7=0.                                                             RAM39640
      C5=AN*THL                                                         RAM39650
      CC=CA-C5                                                          RAM39660
      CD=CB-C5                                                          RAM39670
      CE=CA+C5                                                          RAM39680
      CF=CB+C5                                                          RAM39690
      C6=CC*CC/C2                                                       RAM39700
      C7=CD*CD/C2                                                       RAM39710
      C8=CE*CE/C2                                                       RAM39720
      C9=CF*CF/C2                                                       RAM39730
      IF (C6.GE.50.) GO TO 150                                          RAM39740
      A4=1./EXP(C6)                                                     RAM39750
150   IF (C7.GE.50.) GO TO 160                                          RAM39760
      A5=1./EXP(C7)                                                     RAM39770
160   IF (C8.GE.50.) GO TO 170                                          RAM39780
      A6=1./EXP(C8)                                                     RAM39790
170   IF (C9.GE.50.) GO TO 180                                          RAM39800
      A7=1./EXP(C9)                                                     RAM39810
180   T=A4+A5+A6+A7                                                     RAM39820
      SUM=SUM+T                                                         RAM39830
      IF (T.GE.0.01) GO TO 140                                          RAM39840
      RCZ=A1*(A2+A3+SUM)                                                RAM39850
      RETURN                                                            RAM39860
C      CALCULATE MULTIPLE EDDY REFLECTIONS FOR GROUND LEVEL RECEPTOR HT.RAM39870
190   A1=1./(2.5066*SZ)                                                 RAM39880
      A2=0.                                                             RAM39890
      C2=2.*SZ*SZ                                                       RAM39900
      C3=H*H/C2                                                         RAM39910
      IF (C3.GE.50.) GO TO 200                                          RAM39920
      A2=2./EXP(C3)                                                     RAM39930
200   SUM=0.                                                            RAM39940
      THL=2.*HL                                                         RAM39950
210   AN=AN+1.                                                          RAM39960
      A4=0.                                                             RAM39970
      A6=0.                                                             RAM39980
      C5=AN*THL                                                         RAM39990
      CC=H-C5                                                           RAM40000
      CE=H+C5                                                           RAM40010
      C6=CC*CC/C2                                                       RAM40020
      C8=CE*CE/C2                                                       RAM40030
      IF (C6.GE.50.) GO TO 220                                          RAM40040
      A4=2./EXP(C6)                                                     RAM40050
220   IF (C8.GE.50.) GO TO 230                                          RAM40060
      A6=2./EXP(C8)                                                     RAM40070
230   T=A4+A6                                                           RAM40080
      SUM=SUM+T                                                         RAM40090
      IF (T.GE.0.01) GO TO 210                                          RAM40100
      RCZ=A1*(A2+SUM)                                                   RAM40110
      RETURN                                                            RAM40120
C                                                                       RAM40130
240   FORMAT (1HO,'BOTH H AND Z ARE ABOVE THE MIXING HEIGHT SO A RELIABLRAM40140
     1E COMPUTATION CAN NOT BE MADE.')                                  RAM40150
C                                                                       RAM40160
      END                                                               RAM40170
C
      SUBROUTINE JMHARE                                                 RAM40190
C                    SUBROUTINE JMHARE (VERSION 80336), PART OF RAM.    RAM40200
C        THIS SUBROUTINE IS REFERRED TO AS K IN THE COMMON STATEMENTS   RAM40210
C                                                                       RAM40220
C   THE FUNCTION OF THIS SUBROUTINE IS TO CALCULATE THE CONCENTRATIONS  RAM40230
C   AT EACH RECEPTOR DUE TO AREA SOURCES. THE HANNAH TECHNIQUE          RAM40240
C   IS USED TO EXAMINE THE AREA SOURCES ALONG AN UPWIND LINE FROM       RAM40250
C   THE RECEPTOR. SUBROUTINE JMHPOL IS CALLED TO INTERPOLATE CONC.      RAM40260
C        INPUT VARIABLES ARE ...                                        RAM40270
C        NHTS- THE NUMBER OF AREA SOURCE HEIGHTS.                       RAM40280
C        XLIM- DISTANCE LIMIT ON AREA INTEGRATION                       RAM40290
C        IDATE - YEAR AND JULIAN DAY(IN COMMON/METDAT/)                 RAM40300
C        LH- HOUR                                                       RAM40310
C                                                                       RAM40320
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,RRAM40330
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                      RAM40340
      COMMON /AEFGKM/ NRECEP,RREC(180),SREC(180),IDATE(2),LH,NPT        RAM40350
      COMMON /AEGIKM/ IPOL,CONTWO,SINT,COST,U,HANE,PL(6)                RAM40360
      COMMON /AEK/ ASORC(6,100)                                         RAM40370
      COMMON /AGK/ PARTC(250)                                           RAM40380
      COMMON /AK/ BPH(2),RMIN,SMIN,RMAX,SMAX,NAS,IRSIZE,ISSIZE,IA(25,25)RAM40390
     1,IWD,IASIGS(100),NBP                                              RAM40400
      COMMON /AKL/ IH,NS,KREC                                           RAM40410
      COMMON /AKM/ BPHM(2),ACHI(180),AHCHI(180),ASIGS(180,11),AHSIGS(180RAM40420
     1,11)                                                              RAM40430
      DIMENSION ADELR(4), ADELS(4)                                      RAM40440
      DATA ADELR /0.001,0.001,-0.001,-0.001/                            RAM40450
      DATA ADELS /0.001,-0.001,-0.001,0.001/                            RAM40460
C                                                                       RAM40470
C       CALCULATE   MODIFIED BREAK-POINT HEIGHTS, IF NECESSARY          RAM40480
      DO 10 I=1,NBP                                                     RAM40490
      H=BPH(I)                                                          RAM40500
      BPHM(I)=H                                                         RAM40510
      IF (FH.EQ.1.) GO TO 10                                            RAM40520
      PHT=FH*H                                                          RAM40530
      UPL=U*(PHT/HANE)**PL(KST)                                         RAM40540
      IF (UPL.LT.1.) UPL=1.                                             RAM40550
      BPHM(I)=((H-PHT)*5.)/UPL+PHT                                      RAM40560
10    CONTINUE                                                          RAM40570
C       DELR: SMALL EAST-WEST INCREMENT DEPENDENT ON WIND DIRECTION     RAM40580
C        USED TO STEP INTO NEXT UPWIND AREA SOURCE.                     RAM40590
      DELR=ADELR(IWD)                                                   RAM40600
C       DELS: SMALL NORTH-SOUTH INCREMENT DEPENDENT ON WIND DIRECTION   RAM40610
C        USED TO STEP INTO NEXT UPWIND AREA SOURCE                      RAM40620
      DELS=ADELS(IWD)                                                   RAM40630
C       SUBTRACT  1 SO THAT POINT IN SOUTHWEST CORNER OF AREA SOURCE    RAM40640
C       REGION WILL HAVE IA INDEX OF (1,1).                             RAM40650
      RMINI=RMIN-1.                                                     RAM40660
      SMINI=SMIN-1.                                                     RAM40670
C                                                                       RAM40680
C       LOOP ON RECEPTORS                                               RAM40690
C        UNITS FOR GEOMETRIC CALCULATIONS ARE INTERNAL UNITS.           RAM40700
      DO 290 KREC=1,NRECEP                                              RAM40710
C       ZERO PARTIAL CONCENTRATION ARRAY                                RAM40720
      DO 20 I=1,NAS                                                     RAM40730
20    PARTC(I)=0.0                                                      RAM40740
      XL=0.0                                                            RAM40750
      CONCL=0.0                                                         RAM40760
      IHL=0                                                             RAM40770
C       SEARCH FOR UPWIND AREA SOURCES WHICH CONTRIBUTE TO THE K-TH     RAM40780
C        RECEPTOR, BEGINNING AT THE K-TH RECEPTOR LOCATION.             RAM40790
      RRE=RREC(KREC)                                                    RAM40800
      SRE=SREC(KREC)                                                    RAM40810
C       SUBTRACT MINIMUM AND STEP UPWIND INTO AREA SOURCE,              RAM40820
C        THEN INTEGERIZE TO ACCESS SOURCE NUMBER IN IA ARRAY.           RAM40830
      IR=RRE-RMINI+DELR                                                 RAM40840
      IS=SRE-SMINI+DELS                                                 RAM40850
C         IS RECEPTOR WITHIN DEFINED LIMITS?                            RAM40860
      IF ((RRE.LE.RMIN).OR.(RRE.GE.RMAX)) GO TO 230                     RAM40870
      IF ((SRE.LE.SMIN).OR.(SRE.GE.SMAX)) GO TO 230                     RAM40880
C                                                                       RAM40890
C   RECEPTOR IS WITHIN AREA SOURCE REGION.                              RAM40900
C                                                                       RAM40910
C       DETERMINE SOURCE NUMBER,NS, SOURCE CENTER(RC,SC),               RAM40920
C      HALF OF SOURCE SIDE LENGTH,D, SOURCE STRENGTH,QA, AND            RAM40930
C         SOURCE HEIGHT, HA.                                            RAM40940
30    IF ((IR.LE.0).OR.(IR.GT.IRSIZE)) GO TO 280                        RAM40950
      IF ((IS.LE.0).OR.(IS.GT.ISSIZE)) GO TO 280                        RAM40960
      NS=IA(IR,IS)                                                      RAM40970
C       DO ONLY GEOMETRIC CALCULATIONS IF NS = 0.                       RAM40980
      IF (NS.EQ.0) GO TO 60                                             RAM40990
      D=ASORC(5,NS)                                                     RAM41000
      RC=ASORC(1,NS)+D                                                  RAM41010
      SC=ASORC(2,NS)+D                                                  RAM41020
      QA=ASORC(IPOL,NS)                                                 RAM41030
      HA=ASORC(6,NS)                                                    RAM41040
      IF (QA.LE.0.0) GO TO 70                                           RAM41050
C      USE POWER LAW DEPENDENT ON STABILITY CLASS TO MODIFY WIND SPEED  RAM41060
C        AT EFFECTIVE HEIGHT OF STACK.                                  RAM41070
C        VARY EFFECTIVE HEIGHT(M) ACCORDING TO WIND SPEED               RAM41080
C        HA- EFFECTIVE AREA SOURCE HEIGHT(M)                            RAM41090
C        FH- FRACTION OF HA WHICH IS PHYSICAL HEIGHT                    RAM41100
C        PHT- PHYSICAL STACK HEIGHT(M)                                  RAM41110
C        (HA-PHT) IS PLUME RISE                                         RAM41120
      PHT=FH*HA                                                         RAM41130
      THT=PHT                                                           RAM41140
      IF (PHT.LT.1.) THT=1.                                             RAM41150
      UPL=U*(THT/HANE)**PL(KST)                                         RAM41160
      IF (UPL.LT.1.) UPL=1.                                             RAM41170
      HA=((HA-PHT)*5.)/UPL+PHT                                          RAM41180
C       DETERMINE HEIGHT CLASS                                          RAM41190
      IH=NHTS                                                           RAM41200
      GO TO (70,50,40), NHTS                                            RAM41210
40    IF (HA.LT.BPHM(2)) IH=2                                           RAM41220
50    IF (HA.LT.BPHM(1)) IH=1                                           RAM41230
      GO TO 70                                                          RAM41240
C       SINCE SOURCE NO. IS ZERO, CALCULATE COORDINATES OF SOURCE CENTERRAM41250
C       AND DEPENDING ON WIND DIRECTION BRANCH TO CODE WHICH DETERMINES RAM41260
C       THE NEXT AREA SOURCE IN THE UPWIND DIRECTION.                   RAM41270
60    D=.5                                                              RAM41280
      RC=FLOAT(IR)+RMINI+D                                              RAM41290
      SC=FLOAT(IS)+SMINI+D                                              RAM41300
C       IWD IS 1 FOR THETA LESS THAN 90 DEG., 2 FOR 90-180  DEG, ETC.   RAM41310
70    GO TO (80,90,110,120), IWD                                        RAM41320
C       IWD=1                                                           RAM41330
C       DETERMINE TWO UPWIND BOUNDARIES(NORTH AND EAST).                RAM41340
80    SB=SC+D                                                           RAM41350
      GO TO 100                                                         RAM41360
C       IWD=2                                                           RAM41370
C       DETERMINE TWO UPWIND BOUNDARIES(SOUTH AND EAST).                RAM41380
90    SB=SC-D                                                           RAM41390
100   RB=RC+D                                                           RAM41400
      GO TO 140                                                         RAM41410
C       IWD=3                                                           RAM41420
C       DETERMINE TWO UPWIND BOUNDARIES(SOUTH AND WEST).                RAM41430
110   SB=SC-D                                                           RAM41440
      GO TO 130                                                         RAM41450
C       IWD=4                                                           RAM41460
C       DETERMINE TWO UPWIND BOUNDARIES(NORTH AND WEST).                RAM41470
120   SB=SC+D                                                           RAM41480
130   RB=RC-D                                                           RAM41490
C       FIND LOCUS OF UPWIND RAY AND CLOSEST BORDER                     RAM41500
140   IF (SINT.EQ.0.) GO TO 160                                         RAM41510
C       IF SIN=0. NORTH OR SOUTH BOUNDARY IS APPROPRIATE.               RAM41520
      XD1=(RB-RRE)/SINT                                                 RAM41530
C       XD1 IS DISTANCE(USER UNITS) TO EAST OR WEST BOUNDARY,           RAM41540
C        WHICHEVER IS UPWIND.                                           RAM41550
      IF (COST.EQ.0.) GO TO 170                                         RAM41560
C       IF COS=0. EAST OR WEST BOUNDARY IS APPROPRIATE.                 RAM41570
      XD2=(SB-SRE)/COST                                                 RAM41580
C       XD2 IS DISTANCE(USER UNITS) TO NORTH  OR SOUTH BOUNDARY,        RAM41590
C        WHICHEVER IS UPWIND.                                           RAM41600
      IF (XD1.LT.XD2) GO TO 170                                         RAM41610
150   RDUM=RRE+XD2*SINT+DELR                                            RAM41620
      SDUM=SB+DELS                                                      RAM41630
C       RDUM,SDUM ARE COORDINATES OF INTERSECTION WITH BOUNDARY PLUS    RAM41640
C        SMALL INCREMENTS TO STEP INSIDE NEXT UPWIND SOURCE.            RAM41650
      DIST=XD2                                                          RAM41660
C       DIST IS DISTANCE TO NEAREST BORDER.                             RAM41670
      GO TO 180                                                         RAM41680
160   XD2=(SB-SRE)/COST                                                 RAM41690
      GO TO 150                                                         RAM41700
170   RDUM=RB+DELR                                                      RAM41710
      SDUM=SRE+XD1*COST+DELS                                            RAM41720
      DIST=XD1                                                          RAM41730
180   DIST=DIST*CONTWO                                                  RAM41740
C       DIST IS IN KM.                                                  RAM41750
C       IF SOURCE NO. IS ZERO, PASS ON TO NEXT UPWIND AREA SOURCE       RAM41760
      IF (NS.EQ.0) GO TO 210                                            RAM41770
C       IF EMISSION RATE < 10E-10, POLLUTANT CONTRIBUTION WILL BE       RAM41780
C        INSIGNIFICANT, GO ON TO NEXT UPWIND AREA SOURCE.               RAM41790
      IF (QA.LE.10.0E-10) GO TO 210                                     RAM41800
C      (A SUBSTANTIAL SAVINGS IN COMPUTATION TIME IS EFFECTED IF A LARGERAM41810
C         AREA WITH NO EMISSIONS IS DEFINED WITH A ZERO SOURCE STRENGTH RAM41820
C        AS OPPOSED TO LEAVING THE AREA UNDEFINED,THUS DEFAULTING TO THERAM41830
C        MIN.GRID SQ.SIZE WHEN SEARCHING FOR THE NEXT UPWIND SOURCE.)USERAM41840
C       THIS SOURCE TO RECEPTOR DISTANCE AND HEIGHT CLASS TO GET A VALUERAM41850
C        FOR INTEGRATED XU/Q TO THIS DISTANCE BY INTERPOLATING IN TABLE RAM41860
C        OF PRECALCULATED CHI*U/Q VALUES. SUBROUTINE JMHPOL PERFORMS THERAM41870
C        INTERPOLATION.                                                 RAM41880
      CALL JMHPOL (DIST,CONA)                                           RAM41890
C       XL(KM) IS THE UPWIND DISTANCE TO THE LAST INTERSECTION WITH A   RAM41900
C        BOUNDARY POINT.                                                RAM41910
      IF (XL.LE.0) GO TO 190                                            RAM41920
      IF (IH.NE.IHL) CALL JMHPOL (XL,CONCL)                             RAM41930
190   DIFF=CONA-CONCL                                                   RAM41940
C        THE CHI*U/Q DIFFERENCE IS MULTIPLIED BY EMISS. RATE AND DIVIDEDRAM41950
C        BY WIND SPEED WHICH HAS BEEN MOD.BY THE POWER LAW TO THE PROPERRAM41960
C        HEIGHT.THIS CALCULATED VALUE,PROD,IS THE CONTRIBUTION OF SOURCERAM41970
C        NS TO THE TOTAL POLLUTANT CONCENTRATION AT THE K-TH RECEPTOR.  RAM41980
      PROD=QA*DIFF/UPL                                                  RAM41990
      ACHI(KREC)=ACHI(KREC)+PROD                                        RAM42000
      AHCHI(KREC)=AHCHI(KREC)+PROD                                      RAM42010
      KSIG=IASIGS(NS)                                                   RAM42020
      IF (KSIG.EQ.0) GO TO 200                                          RAM42030
C       IF THE SOURCE IS SIGNIFICANT, STORE PARTIAL CONCENTRATION       RAM42040
      ASIGS(KREC,KSIG)=ASIGS(KREC,KSIG)+PROD                            RAM42050
      AHSIGS(KREC,KSIG)=AHSIGS(KREC,KSIG)+PROD                          RAM42060
      ASIGS(KREC,11)=ASIGS(KREC,11)+PROD                                RAM42070
      AHSIGS(KREC,11)=AHSIGS(KREC,11)+PROD                              RAM42080
200   CONCL=CONA                                                        RAM42090
C       SAVE PARTIAL CONCENTRATION FOR ALL SOURCES                      RAM42100
      PARTC(NS)=PROD                                                    RAM42110
      IHL=IH                                                            RAM42120
      GO TO 220                                                         RAM42130
210   IHL=0                                                             RAM42140
220   XL=DIST                                                           RAM42150
C       IS THIS POINT OUTSIDE SOURCE REGION?                            RAM42160
      IF ((RDUM.LE.RMIN).OR.(RDUM.GE.RMAX)) GO TO 280                   RAM42170
      IF ((SDUM.LE.SMIN).OR.(SDUM.GE.SMAX)) GO TO 280                   RAM42180
C       IR,IS ARE IA INDICES FOR NEXT SOURCE                            RAM42190
      IR=RDUM-RMINI                                                     RAM42200
      IS=SDUM-SMINI                                                     RAM42210
      GO TO 30                                                          RAM42220
C                                                                       RAM42230
C   RECEPTOR IS OUTSIDE AREA SOURCE REGION.                             RAM42240
C                                                                       RAM42250
230   DXMIN=99999.                                                      RAM42260
C       FIND THE INTERSECTION OF THE UPWIND AZIMUTH FROM THE RECEPTOR TORAM42270
C        THE NEAREST BORDER OF THE AREA SOURCE REGION.                  RAM42280
      ICNT=0                                                            RAM42290
      RM=RMIN                                                           RAM42300
C        FIND LOCUS FOR RMIN, THEN RMAX                                 RAM42310
      DO 250 L=1,2                                                      RAM42320
      RMR=RM-RRE                                                        RAM42330
C        IF SINT IS ZERO, THERE IS NO LOCUS WITH THIS BOUNDARY.         RAM42340
      IF (SINT.EQ.0.) GO TO 240                                         RAM42350
C       FIND NORTH COORDINATE OF LOCUS.                                 RAM42360
      S=RMR*COST/SINT+SRE                                               RAM42370
      IF (S.GT.SMAX) GO TO 240                                          RAM42380
      IF (S.LT.SMIN) GO TO 240                                          RAM42390
C       FIND DISTANCE FROM RECEPTOR TO LOCUS.                           RAM42400
      DX=RMR*SINT+(S-SRE)*COST                                          RAM42410
C       IF DISTANCE IS NEGATIVE, THIS IS A DOWNWIND LOCUS, NOT UPWIND.  RAM42420
      IF (DX.LT.0.) GO TO 240                                           RAM42430
C       IS THIS DISTANCE SHORTER THAN A PREVIOUS LOCUS?                 RAM42440
      IF (DX.GE.DXMIN) GO TO 240                                        RAM42450
      RLOC=RM                                                           RAM42460
      SLOC=S                                                            RAM42470
      DXMIN=DX                                                          RAM42480
C       COUNT THE NUMBER OF LOCI FOUND.                                 RAM42490
      ICNT=ICNT+1                                                       RAM42500
240   RM=RMAX                                                           RAM42510
250   CONTINUE                                                          RAM42520
      SM=SMIN                                                           RAM42530
C       FIND LOCUS FOR SMIN, THEN SMAX.                                 RAM42540
      DO 270 L=3,4                                                      RAM42550
      SMS=SM-SRE                                                        RAM42560
C       IF COSINE IS ZERO, THERE IS NO LOCUS WITH THIS BOUNDARY.        RAM42570
      IF (COST.EQ.0.) GO TO 260                                         RAM42580
C       FIND EAST COORDINATE OF LOCUS.                                  RAM42590
      R=SMS*SINT/COST+RRE                                               RAM42600
      IF (R.GT.RMAX) GO TO 260                                          RAM42610
      IF (R.LT.RMIN) GO TO 260                                          RAM42620
C       FIND DISTANCE FROM RECEPTOR TO LOCUS.                           RAM42630
      DX=(R-RRE)*SINT+SMS*COST                                          RAM42640
C       IF DISTANCE IS NEGATIVE, THIS IS A DOWNWIND LOCUS, NOT UPWIND.  RAM42650
      IF (DX.LT.0.) GO TO 260                                           RAM42660
C       IS THIS DISTANCE SHORTER THAN A PREVIOUS LOCUS?                 RAM42670
      IF (DX.GE.DXMIN) GO TO 260                                        RAM42680
      RLOC=R                                                            RAM42690
      SLOC=SM                                                           RAM42700
      DXMIN=DX                                                          RAM42710
      ICNT=ICNT+1                                                       RAM42720
260   SM=SMAX                                                           RAM42730
270   CONTINUE                                                          RAM42740
C       IF ICNT=0 NO LOCI WERE FOUND, THEREFORE NO AREA SOURCE CONTRIB. RAM42750
C        AT THIS RECEPTOR.                                              RAM42760
      IF (ICNT.EQ.0) GO TO 280                                          RAM42770
      DIST=DXMIN                                                        RAM42780
C       FIND THE DISTANCE TO THE NEAREST SOURCE IN KM                   RAM42790
C       FIND CO-ORDINATES TO LOCATE SOURCE                              RAM42800
C       DIST IS IN INTERNAL UNITS.                                      RAM42810
      XL=DIST*CONTWO                                                    RAM42820
C       XL IS IN KM.                                                    RAM42830
C       IR AND IS NOW ARE COORDINATES OF A POINT LYING IN THE NEXT      RAM42840
C       UPWIND AREA SOURCE.                                             RAM42850
      IR=RLOC+DELR-RMINI                                                RAM42860
      IS=SLOC+DELS-SMINI                                                RAM42870
      GO TO 30                                                          RAM42880
C       WRITE PARTIAL CONCENTRATIONS TO DISK                            RAM42890
280   IF (IOPT(40).EQ.0) GO TO 290                                      RAM42900
      WRITE (10) IDATE,LH,KREC,(PARTC(J),J=1,NAS)                       RAM42910
290   CONTINUE                                                          RAM42920
      RETURN                                                            RAM42930
C                                                                       RAM42940
      END                                                               RAM42950
C
      SUBROUTINE JMHPOL (X,CON)                                         RAM42970
C                    SUBROUTINE JMHPOL (VERSION 80336), PART OF RAM.    RAM42980
C        THIS SUBROUTINE IS REFERRED TO AS L IN THE COMMON STATEMENTS   RAM42990
C      INTERPOLATE FROM PRECALCULATED AREA TABLES.                      RAM43000
C      THIS SUBROUTINE INTERPOLATES FROM A TABLE OF INTEGRATED VALUES   RAM43010
C     TO DETERMINE THE CONCENTRATION AT A RECEPTOR FROM AN AREA SOURCE  RAM43020
C        AT A GIVEN DISTANCE AND HEIGHT                                 RAM43030
C       INPUT VARIBALES ARE...                                          RAM43040
C         X - UPWIND DISTANCE IN KM.                                    RAM43050
C         IH - THE HEIGHT INDEX.                                        RAM43060
C         CON  - RELATIVE CON. NORMALIZED FOR WIND SPEED, CHI*U/Q.      RAM43070
C         NS - CURRENT SOURCE NUMBER                                    RAM43080
C         KREC - CURRENT RECEPTOR NUMBER                                RAM43090
C         XLIM - MAXIMUM DISTANCE FOR INTERPOLATION IN AREA TABLES      RAM43100
C                                                                       RAM43110
      COMMON /AIL/ CIN(3,200),XLIM                                      RAM43120
      COMMON /AKL/ IH,NS,KREC                                           RAM43130
      DATA IO /6/                                                       RAM43140
      IF (X.LT.0.01) GO TO 50                                           RAM43150
      IF (X.GE.0.5) GO TO 10                                            RAM43160
C      FOR DISTANCES < 500M, CON. WAS STORED EVERY 10M.                 RAM43170
C      STORAGE LOCATIONS 1-50 CONTAIN INTEGRATED CON.  FOR 10 TO 500M.  RAM43180
      J=100.*X                                                          RAM43190
      D=J                                                               RAM43200
      XL=D/100.                                                         RAM43210
      XU=XL+0.01                                                        RAM43220
      GO TO 40                                                          RAM43230
10    IF (X.GE.3.) GO TO 20                                             RAM43240
C      FOR DISTANCES  FROM 500 TO 3,000KM CON.  WAS STORED EVERY 100M.  RAM43250
C      STORAGE LOCATIONS 50-75 CONTAIN INTEGRATED CON. FOR 0.5 TO 3. KM.RAM43260
      J=IFIX(10.*X)+45                                                  RAM43270
      D=J-45                                                            RAM43280
      XL=D/10.                                                          RAM43290
      XU=XL+0.1                                                         RAM43300
      GO TO 40                                                          RAM43310
20    IF (X.GE.15.) GO TO 30                                            RAM43320
C      FOR DISTANCES 3 TO 15 KM,  CON.  WAS STORED EVERY 500M.          RAM43330
C      STORAGE LOCATIONS 75-99 CONTAIN INTEGRATED CON.  FOR 3 TO 15 KM. RAM43340
      J=IFIX(2.*X)+69                                                   RAM43350
      D=J-69                                                            RAM43360
      XL=D/2.                                                           RAM43370
      XU=XL+0.5                                                         RAM43380
      GO TO 40                                                          RAM43390
C      FOR DISTANCES > 15,000M CON.  WAS STORED EVERY 1000M.            RAM43400
C      STORAGE LOCATIONS 99-200 CONTAIN INTEGRATED CON. FOR 15 TO 116KM.RAM43410
30    IF (X.GT.XLIM) GO TO 60                                           RAM43420
      J=IFIX(X)+84                                                      RAM43430
      XL=J-84                                                           RAM43440
      XU=XL+1.                                                          RAM43450
40    K=J+1                                                             RAM43460
C    RETRIEVE CONCENTRATIONS FOR INTERPOLATION ACCORDING TO HEIGHT      RAM43470
C       CLASS AND DISTANCE OUT.                                         RAM43480
      C1=CIN(IH,J)                                                      RAM43490
      CON=C1+((X-XL)/(XU-XL))*(CIN(IH,K)-C1)                            RAM43500
      RETURN                                                            RAM43510
C      FOR DISTANCES < 100M, CON.  WAS STORED IN CIN EVERY 10 M.        RAM43520
C      STORAGE LOCATION 1 CONTAINS INTEGRATED CON.  FOR 10 M.           RAM43530
50    CON=100.*X*CIN(IH,1)                                              RAM43540
      RETURN                                                            RAM43550
60    WRITE (IO,70) XLIM,NS,KREC                                        RAM43560
C     CALL WAUDIT
      STOP                                                              RAM43570
C                                                                       RAM43580
70    FORMAT (' ***THE INPUT VALUE OF XLIM,',F10.2,', IS SMALLER THAN THRAM43590
     1E CALCULATED DISTANCE FROM AREA SOURCE ',I4,' TO RECEPTOR ',I4,'**RAM43600
     2*'/1X,'PLEASE REDEFINE XLIM')                                     RAM43610
C                                                                       RAM43620
      END                                                               RAM43630
C
      SUBROUTINE OUTPT                                                  RAM43650
C                    SUBROUTINE OUTPT  (VERSION 80336), PART OF RAM.    RAM43660
C          THIS SUBROUTINE IS REFERRED TO AS M IN THE COMMON STATEMENTS RAM43670
C        THIS SUBROUTINE PROVIDES OUTPUT CONCENTRATIONS IN              RAM43680
C        MICROGRAMS PER CUBIC METER FOR EACH HOUR IN TWO WAYS:          RAM43690
C           1) CONTRIBUTIONS FROM SIGNIFICANT SOURCES, AND              RAM43700
C           2) SUMMARIES.                                               RAM43710
C        BEYOND ENTRY POINT OUTAV THE SUBROUTINE PROVIDES               RAM43720
C        CONCENTRATION OUTPUT FOR EACH AVERAGING PERIOD AGAIN           RAM43730
C        IN THE ABOVE MANNER.                                           RAM43740
C                                                                       RAM43750
C->->->->SECTION OUTPT.A - COMMON, DIMENSION, AND DATA.                 RAM43760
C                                                                       RAM43770
      COMMON /AMOST/ DELH,FH,HINT(3),H,HL,IO,IOPT(50),KST,MUOR,NHTS,RC,RRAM43780
     1CZ,SY,SZ,TEMP,TLOS,UPL,X,Y,Z                                      RAM43790
      COMMON /AEFM/ ICODE(180),UNITS,RREU(180),SREU(180)                XXX43800
      COMMON /AEFMC/ ITYPE(180)                                         XXX43805
      COMMON /AEFGKM/ NRECEP,RREC(180),SREC(180),IDATE(2),LH,NPT        RAM43810
      COMMON /AEGIKM/ IPOL,CONTWO,SINT,COST,U,HANE,PL(6)                RAM43820
      COMMON /AEM/ NSIGP,MPS(25),NSIGA,MAS(10)                          RAM43830
      COMMON /AGM/ PSAV(250),HSAV(250),DH(250),DSAV(250),UPH(250),HPR(25RAM43840
     10),FP(250),PCHI(180),PHCHI(180),PSIGS(180,26),PHSIGS(180,26),IPSIGRAM43850
     2S(250),GRANDT(180)                                                RAM43860
      COMMON /AIM/ HARE(3)                                              RAM43870
      COMMON /AKM/ BPHM(2),ACHI(180),AHCHI(180),ASIGS(180,11),AHSIGS(180RAM43880
     1,11)                                                              RAM43890
      COMMON /AM/ LINE1(20),LINE2(20),LINE3(20),QTHETA(24),QU(24),      XXX43900
     1QHL(24),QTEMP(24),IKST(24),NAVG,NB                                XXX43910
      COMMON /AMC/ IPOLU,RNAME(2,180)                                   XXX43915
      DIMENSION IRANK(180)                                              RAM43920
      DIMENSION GRANDS(180)                                             RAM43930
      DIMENSION PNAME(3,250),ANAME(3,100)                               XXX43935
      CHARACTER*4 RNAME,PNAME,ANAME,IPOLU,ITYPE                         XXXIBM
      EQUIVALENCE (PNAME(1,1),RNAME(1,1),ANAME(1,1))                    XXX43936
C                                                                       RAM43940
C->->->->SECTION OUTPT.B - HOURLY CONTRIB. OUTPUT FROM PT. SOURCE       RAM43950
C                                                                       RAM43960
C           SKIP IF THERE ARE NO POINT SOURCES                          RAM43970
      IF (IOPT(5).EQ.0) GO TO 100                                       RAM43980
C                                                                       RAM43990
C->->->->SECTION OUTPT.B(1) DELETE HOURLY PT. SOURCE CONTRIB. OUTPUT?   RAM44000
      IF (IOPT(25).EQ.1) GO TO 100                                      RAM44010
C                                                                       RAM44020
C           PRODUCE POINT SOURCE CONTRIBUTION TITLE                     RAM44030
      WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM44040
      WRITE (IO,410) IPOLU,IDATE,LH                                     RAM44050
C                                                                       RAM44060
C->->->->SECTION OUTPT.B(2) - DELETE MET. DATA FROM HOURLY PT.          RAM44070
C        SOURCE OUTPUT?                                                 RAM44080
C                                                                       RAM44090
      IF (IOPT(26).EQ.1) GO TO 10                                       RAM44100
C                                                                       RAM44110
C           PRODUCE HOURLY MET. DATA                                    RAM44120
      WRITE (IO,530)                                                    RAM44130
      WRITE (IO,540) LH,QTHETA(LH),QU(LH),QHL(LH),QTEMP(LH),IKST(LH)    RAM44140
10    WRITE (IO,520) HANE,PL(KST)                                       RAM44150
C                                                                       RAM44160
C->->->->SECTION OUTPT.B(3) - DELETE FINAL PLUME HT. AND DIST. TO       RAM44170
C        FINAL RISE?                                                    RAM44180
C                                                                       RAM44190
      IF (IOPT(27).EQ.1) GO TO 20                                       RAM44200
C                                                                       RAM44210
C           PRODUCE FINAL PLUME HT. AND DIST. TO FINAL RISE             RAM44220
      WRITE (IO,550) (I,I=1,10)                                         RAM44230
C           HSAV ARE CALCULATED PLUME HEIGHTS FOR THIS HOUR             RAM44240
      WRITE (IO,560) (HSAV(I),I=1,NPT)                                  RAM44250
C        DSAV ARE DISTANCES TO FINAL RISE FOR THIS HOUR.                RAM44260
      WRITE (IO,570) (DSAV(I),I=1,NPT)                                  RAM44270
C                                                                       RAM44280
C->->->->SECTION OUTPT.B(4) - PRINT POINT CONTRIBUTIONS                 RAM44290
C                                                                       RAM44300
20    IF (NSIGP.GT.10) GO TO 40                                         RAM44310
C           PRINT OUT FIRST PAGE AND TOTALS FOR 10 OR < SIGNIF. SOURCES RAM44320
      WRITE (IO,430)                                                    RAM44330
      WRITE (IO,440) (I,I=1,NSIGP)                                      RAM44340
      WRITE (IO,460)                                                    RAM44350
      WRITE (IO,440) (MPS(I),I=1,NSIGP)                                 RAM44360
      WRITE (IO,470)                                                    RAM44370
      DO 30 K=1,NRECEP                                                  RAM44380
      WRITE (IO,480) K,(PHSIGS(K,I),I=1,NSIGP)                          RAM44390
C           PRINT TOTALS                                                RAM44400
      WRITE (IO,490) PHSIGS(K,26),PHCHI(K)                              RAM44410
30    CONTINUE                                                          RAM44420
      GO TO 100                                                         RAM44430
C                                                                       RAM44440
C           PRINT FIRST PAGE FOR MORE THAN 10 SIGNIFICANT SOURCES.      RAM44450
40    WRITE (IO,430)                                                    RAM44460
      WRITE (IO,440) (I,I=1,10)                                         RAM44470
      WRITE (IO,500) (MPS(I),I=1,10)                                    RAM44480
      WRITE (IO,470)                                                    RAM44490
      DO 50 K=1,NRECEP                                                  RAM44500
50    WRITE (IO,480) K,(PHSIGS(K,I),I=1,10)                             RAM44510
      IF (NSIGP.GT.20) GO TO 70                                         RAM44520
C                                                                       RAM44530
C          PRINT SECOND PAGE AND TOTALS FOR 11 TO 20 SIGNIFICANT SOURCESRAM44540
      WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM44550
      WRITE (IO,410) IPOLU,IDATE,LH                                     RAM44560
      WRITE (IO,430)                                                    RAM44570
      WRITE (IO,440) (I,I=11,NSIGP)                                     RAM44580
      WRITE (IO,460)                                                    RAM44590
      WRITE (IO,440) (MPS(I),I=11,NSIGP)                                RAM44600
      WRITE (IO,470)                                                    RAM44610
      DO 60 K=1,NRECEP                                                  RAM44620
      WRITE (IO,480) K,(PHSIGS(K,I),I=11,NSIGP)                         RAM44630
60    WRITE (IO,490) PHSIGS(K,26),PHCHI(K)                              RAM44640
      GO TO 100                                                         RAM44650
C                                                                       RAM44660
C           WRITE SECOND PAGE FOR MORE THAN 20 SIGNIFICANT SOURCES.     RAM44670
70    WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM44680
      WRITE (IO,410) IPOLU,IDATE,LH                                     RAM44690
      WRITE (IO,430)                                                    RAM44700
      WRITE (IO,440) (I,I=11,20)                                        RAM44710
      WRITE (IO,500) (MPS(I),I=11,20)                                   RAM44720
      WRITE (IO,470)                                                    RAM44730
      DO 80 K=1,NRECEP                                                  RAM44740
80    WRITE (IO,480) K,(PHSIGS(K,I),I=11,20)                            RAM44750
      WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM44760
      WRITE (IO,410) IPOLU,IDATE,LH                                     RAM44770
      WRITE (IO,430)                                                    RAM44780
C                                                                       RAM44790
C           WRITE LAST PAGE AND TOTALS FOR MORE THAN 20 SIGNIF. SOURCES.RAM44800
      WRITE (IO,440) (I,I=21,NSIGP)                                     RAM44810
      WRITE (IO,460)                                                    RAM44820
      WRITE (IO,440) (MPS(I),I=21,NSIGP)                                RAM44830
      WRITE (IO,470)                                                    RAM44840
      DO 90 K=1,NRECEP                                                  RAM44850
      WRITE (IO,480) K,(PHSIGS(K,I),I=21,NSIGP)                         RAM44860
90    WRITE (IO,490) PHSIGS(K,26),PHCHI(K)                              RAM44870
C                                                                       RAM44880
C->->->->SECTION OUTPT.C - HOURLY CONTRIB. FROM AREA SOURCE             RAM44890
C                                                                       RAM44900
C           SKIP IF THERE ARE NO AREA SOURCES                           RAM44910
      IF (IOPT(6).EQ.0) GO TO 130                                       RAM44920
C                                                                       RAM44930
C->->->->SECTION OUTPT.C(1) - DELETE HOURLY AREA CONTRIB.?              RAM44940
C                                                                       RAM44950
100   IF (IOPT(28).EQ.1) GO TO 130                                      RAM44960
C                                                                       RAM44970
C           PRODUCE AREA SOURCE CONTRIB. TITLE                          RAM44980
      WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM44990
      WRITE (IO,420) IPOLU,IDATE,LH                                     RAM45000
C                                                                       RAM45010
C->->->->SECTION OUTPT.C(2) - DELETE HOURLY AREA MET. DATA              RAM45020
C                                                                       RAM45030
      IF (IOPT(29).EQ.1) GO TO 110                                      RAM45040
C                                                                       RAM45050
C           PRODUCE HOURLY AREA SOURCE MET. DATA                        RAM45060
      WRITE (IO,530)                                                    RAM45070
      WRITE (IO,540) LH,QTHETA(LH),QU(LH),QHL(LH),QTEMP(LH),IKST(LH)    RAM45080
C                                                                       RAM45090
C->->->->SECTION OUTPT.C(3) - PRINT AREA CONTRIBUTIONS                  RAM45100
C                                                                       RAM45110
110   WRITE (IO,520) HANE,PL(KST)                                       RAM45120
      WRITE (IO,400) HARE,BPHM                                          RAM45130
      WRITE (IO,430)                                                    RAM45140
      WRITE (IO,440) (I,I=1,NSIGA)                                      RAM45150
      WRITE (IO,450)                                                    RAM45160
      WRITE (IO,440) (MAS(I),I=1,NSIGA)                                 RAM45170
      WRITE (IO,470)                                                    RAM45180
      DO 120 K=1,NRECEP                                                 RAM45190
      WRITE (IO,480) K,(AHSIGS(K,I),I=1,NSIGA)                          RAM45200
120   WRITE (IO,490) AHSIGS(K,11),AHCHI(K)                              RAM45210
C                                                                       RAM45220
C->->->->SECTION OUTPT.D - HOURLY SUMMARY TABLE                         RAM45230
C                                                                       RAM45240
C->->->->SECTION OUTPT.D(1) - DELETE HOURLY SUMMARIES?                  RAM45250
C                                                                       RAM45260
130   IF (IOPT(30).EQ.1) RETURN                                         RAM45270
C                                                                       RAM45280
C           PRODUCE HOURLY SUMMARY TITLE                                RAM45290
      WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM45300
      WRITE (IO,510) IPOLU,IDATE,LH                                     RAM45310
C                                                                       RAM45320
C->->->->SECTION OUTPT.D(2) - DELETE HOURLY MET. DATA?                  RAM45330
C                                                                       RAM45340
      IF (IOPT(31).EQ.1) GO TO 140                                      RAM45350
C           PRODUCE HOURLY SUMMARY TABLE MET. DATA                      RAM45360
      WRITE (IO,530)                                                    RAM45370
      WRITE (IO,540) LH,QTHETA(LH),QU(LH),QHL(LH),QTEMP(LH),IKST(LH)    RAM45380
140   WRITE (IO,520) HANE,PL(KST)                                       RAM45390
      IF (IOPT(6).EQ.1) WRITE (IO,400) HARE,BPHM                        RAM45400
      WRITE (IO,580)                                                    RAM45410
C                                                                       RAM45420
C->->->->SECTION OUTPT.D(3) -  RANK CONCENTRATIONS                      RAM45430
C                                                                       RAM45440
      DO 150 K=1,NRECEP                                                 RAM45450
150   GRANDS(K)=GRANDT(K)                                               RAM45460
C                                                                       RAM45470
      DO 170 I=1,NRECEP                                                 RAM45480
      CMAX=-1.0                                                         RAM45490
      DO 160 K=1,NRECEP                                                 RAM45500
      IF (GRANDT(K).LE.CMAX) GO TO 160                                  RAM45510
      CMAX=GRANDT(K)                                                    RAM45520
      LMAX=K                                                            RAM45530
160   CONTINUE                                                          RAM45540
      IRANK(LMAX)=I                                                     RAM45550
      GRANDT(LMAX)=-1.0                                                 RAM45560
170   CONTINUE                                                          RAM45570
C                                                                       RAM45580
C->->->->SECTION OUTPT.D(4) - PRINT SUMMARY TABLE                       RAM45590
C                                                                       RAM45600
      DO 180 K=1,NRECEP                                                 RAM45610
180   WRITE (IO,590) K,ITYPE(K),ICODE(K),(RNAME(J,K),J=1,2),RREU(K),SREURAM45620
     1(K),PHSIGS(K,26),PHCHI(K),AHSIGS(K,11),AHCHI(K),GRANDS(K),IRANK(K)RAM45630
      RETURN                                                            RAM45640
C                                                                       RAM45650
C                                                                       RAM45660
C->->->->SECTION OUTPT.E - ENTRY POINT FOR AVERAGING TIME               RAM45670
C                                                                       RAM45680
C                                                                       RAM45690
      ENTRY OUTAV                                                       RAM45700
C            AT THIS ENTRY POINT, CONCENTRATION OUTPUT                  RAM45710
C        IN MICROGRAMS PER CUBIC METER ARE PRINTED FOR THE              RAM45720
C        AVERAGING PERIOD. CONTRIBUTIONS AND/OR SUMMARY                 RAM45730
C        INFORMATION IS AVAILABLE.                                      RAM45740
C                                                                       RAM45750
C->->->->SECTION OUTPT.E(1) - AVG. CONC. OVER SPEC. TIME PERIOD         RAM45760
C                                                                       RAM45770
C           SKIP IF THERE ARE NO POINT SOURCE CONTRIBUTIONS PRINTED OUT RAM45780
      IF (IOPT(5).EQ.0) GO TO 290                                       RAM45790
C         CALCULATE AVERAGE POINT CONTRIBUTIONS.                        RAM45800
      DO 190 K=1,NRECEP                                                 RAM45810
190   PSIGS(K,26)=PSIGS(K,26)/NAVG                                      RAM45820
      IF (IOPT(33).EQ.1) GO TO 290                                      RAM45830
      DO 210 K=1,NRECEP                                                 RAM45840
      DO 200 I=1,NSIGP                                                  RAM45850
200   PSIGS(K,I)=PSIGS(K,I)/NAVG                                        RAM45860
210   CONTINUE                                                          RAM45870
C                                                                       RAM45880
C->->->->SECTION OUTPT.F - AVG. PERIOD PT. CONTRIB.                     RAM45890
C           SKIP IF THERE ARE NO POINT SOURCES                          RAM45900
C                                                                       RAM45910
C                                                                       RAM45920
C->->->->SECTION OUTPT.F(2) - PRINT AVG. PERIOD PT. SOURCE CONTRIB.     RAM45930
      WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM45940
      WRITE (IO,600) NAVG,IPOLU,IDATE,NB,HANE,PL                        RAM45950
      IF (NSIGP.GT.10) GO TO 230                                        RAM45960
C                                                                       RAM45970
C           PRINT OUT FIRST PAGE AND TOTALS FOR 10 OR < SIGNIF. SOURCES RAM45980
      WRITE (IO,440) (I,I=1,NSIGP)                                      RAM45990
      WRITE (IO,460)                                                    RAM46000
      WRITE (IO,440) (MPS(I),I=1,NSIGP)                                 RAM46010
      WRITE (IO,470)                                                    RAM46020
      DO 220 K=1,NRECEP                                                 RAM46030
      WRITE (IO,480) K,(PSIGS(K,I),I=1,NSIGP)                           RAM46040
C           PRINT TOTALS                                                RAM46050
220   WRITE (IO,490) PSIGS(K,26),PCHI(K)                                RAM46060
      GO TO 290                                                         RAM46070
C                                                                       RAM46080
C           PRINT FIRST PAGE FOR MORE THAN 10 SIGNIF SOURCES            RAM46090
230   WRITE (IO,440) (I,I=1,10)                                         RAM46100
      WRITE (IO,500) (MPS(I),I=1,10)                                    RAM46110
      WRITE (IO,470)                                                    RAM46120
      DO 240 K=1,NRECEP                                                 RAM46130
240   WRITE (IO,480) K,(PSIGS(K,I),I=1,10)                              RAM46140
      IF (NSIGP.GT.20) GO TO 260                                        RAM46150
C                                                                       RAM46160
C           PRINT SECOND PAGE AND TOTALS FOR 11 TO 20 SIGNIF SOURCES    RAM46170
      WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM46180
      WRITE (IO,600) NAVG,IPOLU,IDATE,NB,HANE,PL                        RAM46190
      WRITE (IO,440) (I,I=11,NSIGP)                                     RAM46200
      WRITE (IO,460)                                                    RAM46210
      WRITE (IO,440) (MPS(I),I=11,NSIGP)                                RAM46220
      WRITE (IO,470)                                                    RAM46230
      DO 250 K=1,NRECEP                                                 RAM46240
      WRITE (IO,480) K,(PSIGS(K,I),I=11,NSIGP)                          RAM46250
250   WRITE (IO,490) PSIGS(K,26),PCHI(K)                                RAM46260
      GO TO 290                                                         RAM46270
C                                                                       RAM46280
C           WRITE SECOND PAGE FOR MORE THAN 20 SIGNIF SOURCES           RAM46290
260   WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM46300
      WRITE (IO,600) NAVG,IPOLU,IDATE,NB,HANE,PL                        RAM46310
      WRITE (IO,440) (I,I=11,20)                                        RAM46320
      WRITE (IO,500) (MPS(I),I=11,20)                                   RAM46330
      WRITE (IO,470)                                                    RAM46340
      DO 270 K=1,NRECEP                                                 RAM46350
270   WRITE (IO,480) K,(PSIGS(K,I),I=11,20)                             RAM46360
C                                                                       RAM46370
C           WRITE LAST PAGE AND TOTALS FOR MORE THAN 20 SIGNIF SOURCES  RAM46380
      WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM46390
      WRITE (IO,600) NAVG,IPOLU,IDATE,NB,HANE,PL                        RAM46400
      WRITE (IO,440) (I,I=21,NSIGP)                                     RAM46410
      WRITE (IO,460)                                                    RAM46420
      WRITE (IO,440) (MPS(I),I=21,NSIGP)                                RAM46430
      WRITE (IO,470)                                                    RAM46440
      DO 280 K=1,NRECEP                                                 RAM46450
      WRITE (IO,480) K,(PSIGS(K,I),I=21,NSIGP)                          RAM46460
280   WRITE (IO,490) PSIGS(K,26),PCHI(K)                                RAM46470
C                                                                       RAM46480
C->->->->SECTION OUTPT.G - AVG.PERIOD AREA CONTRIB.                     RAM46490
C                                                                       RAM46500
C->->->->SECTION OUTPT.G(1) - DELETE AVG. PERIOD AREA SOURCE CONTRIB?   RAM46510
290   IF (IOPT(6).EQ.0) GO TO 340                                       RAM46520
C        CALCULATE AVERAGE AREA CONTRIBUTIONS.                          RAM46530
      DO 300 K=1,NRECEP                                                 RAM46540
300   ASIGS(K,11)=ASIGS(K,11)/NAVG                                      RAM46550
      IF (IOPT(34).EQ.1) GO TO 340                                      RAM46560
      DO 320 K=1,NRECEP                                                 RAM46570
      DO 310 I=1,NSIGA                                                  RAM46580
310   ASIGS(K,I)=ASIGS(K,I)/NAVG                                        RAM46590
320   CONTINUE                                                          RAM46600
C                                                                       RAM46610
C->->->->SECTION OUTPT.G(2) - PRINT AVG. PERIOD AREA SOURCE CONTRIB.    RAM46620
C                                                                       RAM46630
      WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM46640
      WRITE (IO,610) NAVG,IPOLU,IDATE,NB,HANE,PL                        RAM46650
      WRITE (IO,440) (I,I=1,NSIGA)                                      RAM46660
      WRITE (IO,450)                                                    RAM46670
      WRITE (IO,440) (MAS(I),I=1,NSIGA)                                 RAM46680
      WRITE (IO,470)                                                    RAM46690
      DO 330 K=1,NRECEP                                                 RAM46700
      WRITE (IO,480) K,(ASIGS(K,I),I=1,NSIGA)                           RAM46710
330   WRITE (IO,490) ASIGS(K,11),ACHI(K)                                RAM46720
C                                                                       RAM46730
C->->->->SECTION OUTPT.H - AVG. PERIOD SUMMARY                          RAM46740
C                                                                       RAM46750
C->->->->SECTION OUTPT.H(1) - DELETE AVG. PERIOD SUMMARY?               RAM46760
C                                                                       RAM46770
340   IF (IOPT(35).EQ.1) RETURN                                         RAM46780
C                                                                       RAM46790
C           PRINT AVG. PERIOD SUMMARY                                   RAM46800
      WRITE (IO,390) LINE1,LINE2,LINE3                                  RAM46810
      WRITE (IO,620) NAVG,IPOLU,IDATE,NB,HANE,PL                        RAM46820
      WRITE (IO,580)                                                    RAM46830
C            RANK CONCENTRATIONS                                        RAM46840
      DO 350 K=1,NRECEP                                                 RAM46850
350   GRANDS(K)=GRANDT(K)                                               RAM46860
      DO 370 I=1,NRECEP                                                 RAM46870
      CMAX=-1.0                                                         RAM46880
      DO 360 K=1,NRECEP                                                 RAM46890
      IF (GRANDT(K).LE.CMAX) GO TO 360                                  RAM46900
      CMAX=GRANDT(K)                                                    RAM46910
      LMAX=K                                                            RAM46920
360   CONTINUE                                                          RAM46930
      IRANK(LMAX)=I                                                     RAM46940
370   GRANDT(LMAX)=-1.0                                                 RAM46950
      DO 380 K=1,NRECEP                                                 RAM46960
380   WRITE (IO,590) K,ITYPE(K),ICODE(K),(RNAME(J,K),J=1,2),RREU(K),SREURAM46970
     1(K),PSIGS(K,26),PCHI(K),ASIGS(K,11),ACHI(K),GRANDS(K),IRANK(K)    RAM46980
C                                                                       RAM46990
      RETURN                                                            RAM47000
C                                                                       RAM47010
C->->->->SECTION OUTPT.J - FORMATS                                      RAM47020
C                                                                       RAM47030
390   FORMAT ('1',20A4/1X,20A4/1X,20A4)                                 RAM47040
400   FORMAT (1H0,T40,'AREA HTS:  ',F8.3,',',F8.3,',',F8.3,';   SEPARATIRAM47050
     1ON HTS:  ',F8.3,',',F8.3)                                         RAM47060
410   FORMAT ('0',T30,A4,' CONTRIBUTION(MICROGRAMS/M**3) FROM SIGNIFICANRAM47070
     1T POINT SOURCES ',5X,I2,'/',I4,' : HOUR ',I2//)                   RAM47080
420   FORMAT ('0',T30,A4,' CONTRIBUTION(MICROGRAMS/M**3) FROM SIGNIFICANRAM47090
     1T AREA SOURCES ',5X,I2,'/',I4,' :  HOUR',I2//)                    RAM47100
430   FORMAT (1H0,T5,'RANK')                                            RAM47110
440   FORMAT ('+',T12,10(I3,7X))                                        RAM47120
450   FORMAT ('+',T113,'TOTAL     TOTAL'/1X,T113,'SIGNIF    ALL AREA'/1XRAM47130
     1,T113,'AREA     SOURCES'/1X,'SOURCE #')                           RAM47140
460   FORMAT ('+',T113,'TOTAL     TOTAL'/1X,T113,'SIGNIF    ALL POINT'/1RAM47150
     1X,T113,'POINT     SOURCES'/1X,'SOURCE #')                         RAM47160
470   FORMAT (1X,'RECEP #')                                             RAM47170
480   FORMAT (1X,I3,2X,6P,10F10.3)                                      RAM47180
490   FORMAT ('+',T109,6P,2F10.3)                                       RAM47190
500   FORMAT (1H0,'SOURCE #',T12,10(I3,7X))                             RAM47200
510   FORMAT ('0',T25,A4,' SUMMARY CONCENTRATION TABLE(MICROGRAMS/M**3) RAM47210
     1',5X,I2,'/',I4,' : HOUR ',I2/1X)                                  RAM47220
520   FORMAT (1H+,T60,'ANEMOM HT: ',F6.2,'     PL: ',F6.2)              RAM47230
530   FORMAT (1X,T2,'HOUR   THETA    SPEED   MIXING   TEMP   STABILITY'/RAM47240
     11X,T9,'(DEG)    (M/S) HEIGHT(M)   (K)     CLASS'/1X)              RAM47250
540   FORMAT (1X,T3,I2,4F9.2,6X,I1)                                     RAM47260
550   FORMAT (1H0,8X,10I11/)                                            RAM47270
560   FORMAT (' FINAL HT (M) ',10F11.2)                                 RAM47280
570   FORMAT (' DIST FIN HT (KM)',10F11.3)                              RAM47290
580   FORMAT (1X,'RECEPTOR NO.              EAST     NORTH ',2X,5('TOTALRAM47300
     1 FROM   '),' CONCENTRATION'/1X,T46,'SIGN','IF POINT  ALL POINT   SRAM47310
     2IGNIF AREA    ALL AREA     ALL SOURCES',5X,'RANK'/1X,T48,4('SOURCERAM47320
     3S',6X)/1X)                                                        RAM47330
590   FORMAT (1X,T3,I3,1X,A1,I3,2X,2A4,F11.3,F12.3,6P,5F13.4,6X,I3)     RAM47340
600   FORMAT ('0',T22,I2,'-HOUR AVERAGE ',A4,' CONTRIBUTION(MICROGRAMS/MRAM47350
     1**3) FROM SIGNIFICANT POINT SOURCES',5X,I2,'/',I3,'  START HOUR: 'RAM47360
     2,I2//1X,T20,'ANEMOM HT: ',F4.0,3X,'PL:  A-',F4.2,2X,'B- ',F4.2,'C-RAM47370
     3 ',F4.2,2X,'D- ',F4.2,2X,'E- ',F4.2,2X,'F- ',F4.2/1X,T5,'RANK')   RAM47380
610   FORMAT ('0',T22,I2,'-HOUR AVERAGE ',A4,' CONTRIBUTION(MICROGRAMS/MRAM47390
     1**3) FROM SIGNIFICANT AREA SOURCES',5X,I2,'/',I3,'  START HOUR: ',RAM47400
     2I2//1X,T20,'ANEMOM HT: ',F4.0,2X,'PL: A-',F4.2,2X,'B- ',F4.2,2X,'CRAM47410
     3- ',F4.2,2X,'D- ',F4.2,2X,'E- ',F4.2,2X,'F- ',F4.2,/1X,T5,'RANK') RAM47420
620   FORMAT ('0',T25,I2,'-HOUR AVERAGE ',A4,' SUMMARY CONCENTRATION TABRAM47430
     1LE(MICROGRAMS/M**3)',5X,I2,'/',I3,'  START HOUR: ',I2//1X,T20,'ANERAM47440
     2MOM HT: ',F4.0,2X,'PL: A- ',F4.2,2X,'B- ',F4.2,2X,'C- ',F4.2,2X,'DRAM47450
     3- ',F4.2,2X,'E- ',F4.2,2X,'F- ',F4.2/1X)                          RAM47460
C                                                                       RAM47470
      END                                                               RAM47480
C
      SUBROUTINE RANK (L)                                               RAM47500
C                    SUBROUTINE RANK   (VERSION 80336), PART OF RAM.    RAM47510
C         THIS SUBROUTINE IS REFERRED TO AS N IN THE COMMON STATEMENTS  RAM47520
C        CALLED BY  RAM  TO ARRANGE CONCENTRATIONS OF VARIOUS AVG       RAM47530
C        TIMES INTO HIGH-FIVE TABLES...THAT IS, ARRAYS STORING          RAM47540
C        THE HIGHEST FIVE CONCENTRATIONS FOR EACH RECEPTOR FOR          RAM47550
C        EACH AVG TIME.                                                 RAM47560
C        VARIABLES OUTPUT:                                              RAM47570
C             HMAXA(J,K,L)  CONCENTRATIONS ACCORDING TO                 RAM47580
C                   J : RANK OF CONC. (1-5)                             RAM47590
C                   K : RECEPTOR NUMBER                                 RAM47600
C                   L : AVG TIME                                        RAM47610
C             NDAY(J,K,L) : ASSOCIATED DAY OF CONC.                     RAM47620
C             IHR(J,K,L) : ENDING HOUR OF CONC.                         RAM47630
      COMMON /AEFGKM/ NRECEP,RREC(180),SREC(180),IDATE(2),LH,NPT        RAM47640
      COMMON /AN/ HMAXA(5,180,5),NDAY(5,180,5),IHR(5,180,5),CONC(180,5),RAM47650
     1JDAY                                                              RAM47660
C                                                                       RAM47670
      IO=6                                                              RAM47680
C        RESET AVERAGING PERIOD FLAG AND SET CALM FLAG, LL.             RAM47690
C        CALMS ACCOUNTED FOR ONLY WHEN DEFAULT OPTION ON.               RAM47700
      LL=0                                                              RAM47710
      IF(L.GT.4)LL=1                                                    RAM47720
      IF(L.EQ.22)L=2                                                    RAM47730
      IF(L.EQ.33)L=3                                                    RAM47740
      IF(L.EQ.44)L=4                                                    RAM47750
      DO 50 K=1,NRECEP                                                  RAM47760
      IF (CONC(K,L).LE.HMAXA(5,K,L)) GO TO 50                           RAM47770
      DO 10 J=1,5                                                       RAM47780
      IF (CONC(K,L).GT.HMAXA(J,K,L)) GO TO 20                           RAM47790
C           CONCENTRATION IS ONE OF THE TOP FIVE                        RAM47800
10    CONTINUE                                                          RAM47810
      WRITE (IO,70)                                                     RAM47820
      GO TO 50                                                          RAM47830
C           THE FOLLOWING DO-LOOP HAS THE EFFECT OF INSERTING A NEW     RAM47840
C           CONCENTRATION ENTRY INTO ITS PROPER POSITION WHILE SHIFTING RAM47850
C           DOWN THE 'OLD' LOWER CONCENTRATIONS THUS ESTABLISHING THE   RAM47860
C           'HIGH-FIVE' CONCENTRATION TABLE.                            RAM47870
20    IF (J.EQ.5) GO TO 40                                              RAM47880
      DO 30 IJ=4,J,-1                                                   RAM47890
      IJP1=IJ+1                                                         RAM47900
      HMAXA(IJP1,K,L)=HMAXA(IJ,K,L)                                     RAM47910
      NDAY(IJP1,K,L)=NDAY(IJ,K,L)                                       RAM47920
30    IHR(IJP1,K,L)=IHR(IJ,K,L)                                         RAM47930
C           INSERT LATEST CONC, DAY AND ENDING HR INTO THE              RAM47940
C              PROPER RANK IN THE HIGH-FIVE TABLE                       RAM47950
40    HMAXA(J,K,L)=CONC(K,L)                                            RAM47960
      NDAY(J,K,L)=JDAY                                                  RAM47970
      IHR(J,K,L)=LH                                                     RAM47980
C        ADD 100 TO HOUR TO SET CALM FLAG FOR MAIN.                     RAM47990
      IF(LL.EQ.1.AND.L.NE.1)IHR(J,K,L)=IHR(J,K,L)+100                   RAM48000
50    CONTINUE                                                          RAM48010
      DO 60 K=1,NRECEP                                                  RAM48020
      CONC(K,L)=0.                                                      RAM48030
60    CONTINUE                                                          RAM48040
      RETURN                                                            RAM48050
C                                                                       RAM48060
70    FORMAT (1X,'   ****ERROR IN FINDING THE MAX CONCENTRATION***')    RAM48070
C                                                                       RAM48080
      END                                                               RAM48090
